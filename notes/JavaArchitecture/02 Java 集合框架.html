<!DOCTYPE html>
<html lang="en-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Java é›†åˆæ¡†æ¶ | Full Stack Developer Tutorial</title>
    <meta name="description" content="from zero to hero">
    <link rel="icon" href="/fullstack-tutorial-site/favicon.ico">
    
    <link rel="preload" href="/fullstack-tutorial-site/assets/css/styles.e23029aa.css" as="style"><link rel="preload" href="/fullstack-tutorial-site/assets/js/app.e23029aa.js" as="script"><link rel="preload" href="/fullstack-tutorial-site/assets/js/1.82e55b14.js" as="script"><link rel="prefetch" href="/fullstack-tutorial-site/assets/css/10.styles.e7bfa7b0.css"><link rel="prefetch" href="/fullstack-tutorial-site/assets/css/7.styles.a8031ade.css"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/10.e7bfa7b0.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/11.42acfd5a.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/12.f0884d8e.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/13.c57f5837.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/14.07fd252d.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/15.9dcc583e.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/16.42bd51ad.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/17.f0e20aa7.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/18.62b756df.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/19.732a8ec2.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/2.57da3069.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/20.1cd96f80.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/21.e3ef896c.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/22.8dd77b6a.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/23.5ae08c37.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/24.5a34ccb1.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/25.7dee6df6.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/26.af9b2812.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/27.6f5b260d.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/28.c5f782da.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/29.799a3dea.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/3.4193afeb.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/30.8bb33866.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/31.a2bf48a5.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/32.2dd32760.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/33.8b1034f7.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/34.8e3964bc.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/35.57d9f500.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/36.49aead0e.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/37.60183b23.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/38.3416c1ac.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/39.cc8bcef9.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/4.020e03fa.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/40.ffb34422.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/41.feec12a7.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/42.4e1803cc.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/43.6a56bbfb.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/44.ef11fafe.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/45.6b3189d2.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/46.cf48bc8c.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/47.bbcdd89a.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/48.9ad3fe5a.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/49.c4eb64f9.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/5.f4777b53.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/50.79d979ac.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/51.bee6678b.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/52.5e069c45.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/53.b4ed7749.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/54.37b05d6c.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/55.9497455f.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/56.7459f398.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/57.a21a8691.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/58.5c0b7c68.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/59.083c760f.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/6.0c32f6b7.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/60.881f6ac9.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/61.ebc72343.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/62.3514484e.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/63.39076018.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/64.20372ac4.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/65.cc25487c.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/66.e130b690.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/67.40d544ec.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/68.371c66ba.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/69.bf625d87.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/7.a8031ade.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/70.53616ef1.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/71.1e855d2c.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/72.ebb7d332.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/73.7b72b76a.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/74.7f93f494.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/8.27947311.js"><link rel="prefetch" href="/fullstack-tutorial-site/assets/js/9.ca56268b.js">
    <link rel="stylesheet" href="/fullstack-tutorial-site/assets/css/styles.e23029aa.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/fullstack-tutorial-site/" class="home-link router-link-active"><!----> <span class="site-name">Full Stack Developer Tutorial</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/fullstack-tutorial-site/notes/" class="nav-link router-link-active">å…¨æ ˆæŒ‡å—</a></div><div class="nav-item"><a href="/fullstack-tutorial-site/notes/archives/" class="nav-link">åœºæ™¯å®æˆ˜</a></div><div class="nav-item"><a href="/fullstack-tutorial-site/vuepress/donate/" class="nav-link">æèµ </a></div><div class="nav-item"><a href="/fullstack-tutorial-site/vuepress/author/" class="nav-link">ä½œè€…</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">é€‰æ‹©/è¯­è¨€</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/fullstack-tutorial-site/notes/JavaArchitecture/02 Java é›†åˆæ¡†æ¶.html" class="nav-link">ç®€ä½“ä¸­æ–‡</a></li><li class="dropdown-item"><!----> <a href="/fullstack-tutorial-site/zh/" class="nav-link">zh-US</a></li></ul></div></div> <a href="https://github.com/frank-lam/fullstack-tutorial" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/fullstack-tutorial-site/notes/" class="nav-link router-link-active">å…¨æ ˆæŒ‡å—</a></div><div class="nav-item"><a href="/fullstack-tutorial-site/notes/archives/" class="nav-link">åœºæ™¯å®æˆ˜</a></div><div class="nav-item"><a href="/fullstack-tutorial-site/vuepress/donate/" class="nav-link">æèµ </a></div><div class="nav-item"><a href="/fullstack-tutorial-site/vuepress/author/" class="nav-link">ä½œè€…</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">é€‰æ‹©/è¯­è¨€</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/fullstack-tutorial-site/notes/JavaArchitecture/02 Java é›†åˆæ¡†æ¶.html" class="nav-link">ç®€ä½“ä¸­æ–‡</a></li><li class="dropdown-item"><!----> <a href="/fullstack-tutorial-site/zh/" class="nav-link">zh-US</a></li></ul></div></div> <a href="https://github.com/frank-lam/fullstack-tutorial" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav> <div class="load-success"><div id="codefund_ad"></div></div> <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading"><span>Get Start</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/fullstack-tutorial-site/notes/" class="sidebar-link">å¿«é€Ÿå¼€å§‹</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading open"><span>Java æŠ€æœ¯æ ˆ</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/fullstack-tutorial-site/notes/JavaArchitecture/01 Java åŸºç¡€.html" class="sidebar-link">Java åŸºç¡€æ¦‚å¿µ</a></li><li><a href="/fullstack-tutorial-site/notes/JavaArchitecture/02 Java é›†åˆæ¡†æ¶.html" class="active sidebar-link">Java é›†åˆæ¡†æ¶</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/fullstack-tutorial-site/notes/JavaArchitecture/02 Java é›†åˆæ¡†æ¶.html#å‰è¨€" class="sidebar-link">å‰è¨€</a></li><li class="sidebar-sub-header"><a href="/fullstack-tutorial-site/notes/JavaArchitecture/02 Java é›†åˆæ¡†æ¶.html#ä¸€ã€æ¦‚è¿°" class="sidebar-link">ä¸€ã€æ¦‚è¿°</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/fullstack-tutorial-site/notes/JavaArchitecture/02 Java é›†åˆæ¡†æ¶.html#é›†åˆæ¡†æ¶å›¾" class="sidebar-link">é›†åˆæ¡†æ¶å›¾</a></li><li class="sidebar-sub-header"><a href="/fullstack-tutorial-site/notes/JavaArchitecture/02 Java é›†åˆæ¡†æ¶.html#collection" class="sidebar-link">Collection</a></li><li class="sidebar-sub-header"><a href="/fullstack-tutorial-site/notes/JavaArchitecture/02 Java é›†åˆæ¡†æ¶.html#map" class="sidebar-link">Map</a></li><li class="sidebar-sub-header"><a href="/fullstack-tutorial-site/notes/JavaArchitecture/02 Java é›†åˆæ¡†æ¶.html#å·¥å…·ç±»" class="sidebar-link">å·¥å…·ç±»</a></li><li class="sidebar-sub-header"><a href="/fullstack-tutorial-site/notes/JavaArchitecture/02 Java é›†åˆæ¡†æ¶.html#é€šç”¨å®ç°" class="sidebar-link">é€šç”¨å®ç°</a></li></ul></li><li class="sidebar-sub-header"><a href="/fullstack-tutorial-site/notes/JavaArchitecture/02 Java é›†åˆæ¡†æ¶.html#äºŒã€æ·±å…¥æºç åˆ†æ" class="sidebar-link">äºŒã€æ·±å…¥æºç åˆ†æ</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/fullstack-tutorial-site/notes/JavaArchitecture/02 Java é›†åˆæ¡†æ¶.html#arraylist" class="sidebar-link">ArrayList</a></li><li class="sidebar-sub-header"><a href="/fullstack-tutorial-site/notes/JavaArchitecture/02 Java é›†åˆæ¡†æ¶.html#vector" class="sidebar-link">Vector</a></li><li class="sidebar-sub-header"><a href="/fullstack-tutorial-site/notes/JavaArchitecture/02 Java é›†åˆæ¡†æ¶.html#linkedlist" class="sidebar-link">LinkedList</a></li><li class="sidebar-sub-header"><a href="/fullstack-tutorial-site/notes/JavaArchitecture/02 Java é›†åˆæ¡†æ¶.html#hashmap" class="sidebar-link">HashMap</a></li><li class="sidebar-sub-header"><a href="/fullstack-tutorial-site/notes/JavaArchitecture/02 Java é›†åˆæ¡†æ¶.html#concurrenthashmap" class="sidebar-link">ConcurrentHashMap</a></li><li class="sidebar-sub-header"><a href="/fullstack-tutorial-site/notes/JavaArchitecture/02 Java é›†åˆæ¡†æ¶.html#hashset" class="sidebar-link">HashSet</a></li><li class="sidebar-sub-header"><a href="/fullstack-tutorial-site/notes/JavaArchitecture/02 Java é›†åˆæ¡†æ¶.html#linkedhashset-and-linkedhashmap" class="sidebar-link">LinkedHashSet and LinkedHashMap</a></li></ul></li><li class="sidebar-sub-header"><a href="/fullstack-tutorial-site/notes/JavaArchitecture/02 Java é›†åˆæ¡†æ¶.html#ä¸‰ã€å®¹å™¨ä¸­çš„è®¾è®¡æ¨¡å¼" class="sidebar-link">ä¸‰ã€å®¹å™¨ä¸­çš„è®¾è®¡æ¨¡å¼</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/fullstack-tutorial-site/notes/JavaArchitecture/02 Java é›†åˆæ¡†æ¶.html#è¿­ä»£å™¨æ¨¡å¼" class="sidebar-link">è¿­ä»£å™¨æ¨¡å¼</a></li><li class="sidebar-sub-header"><a href="/fullstack-tutorial-site/notes/JavaArchitecture/02 Java é›†åˆæ¡†æ¶.html#é€‚é…å™¨æ¨¡å¼" class="sidebar-link">é€‚é…å™¨æ¨¡å¼</a></li></ul></li><li class="sidebar-sub-header"><a href="/fullstack-tutorial-site/notes/JavaArchitecture/02 Java é›†åˆæ¡†æ¶.html#å››ã€é¢è¯•æŒ‡å—" class="sidebar-link">å››ã€é¢è¯•æŒ‡å—</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/fullstack-tutorial-site/notes/JavaArchitecture/02 Java é›†åˆæ¡†æ¶.html#_1-arraylistå’ŒlinkedliståŒºåˆ«" class="sidebar-link">1. ArrayListå’ŒLinkedListåŒºåˆ«</a></li><li class="sidebar-sub-header"><a href="/fullstack-tutorial-site/notes/JavaArchitecture/02 Java é›†åˆæ¡†æ¶.html#_2-hashmapå’ŒhashtableåŒºåˆ«ï¼Œhashmapçš„keyç±»å‹" class="sidebar-link">2. HashMapå’ŒHashTableåŒºåˆ«ï¼ŒHashMapçš„keyç±»å‹</a></li><li class="sidebar-sub-header"><a href="/fullstack-tutorial-site/notes/JavaArchitecture/02 Java é›†åˆæ¡†æ¶.html#_3-hashmapå’Œconcurrenthashmap" class="sidebar-link">3. HashMapå’ŒConcurrentHashMap</a></li><li class="sidebar-sub-header"><a href="/fullstack-tutorial-site/notes/JavaArchitecture/02 Java é›†åˆæ¡†æ¶.html#_4-hashtableçš„åŸç†" class="sidebar-link">4. Hashtableçš„åŸç†</a></li><li class="sidebar-sub-header"><a href="/fullstack-tutorial-site/notes/JavaArchitecture/02 Java é›†åˆæ¡†æ¶.html#_5-hashå†²çªçš„è§£å†³åŠæ³•" class="sidebar-link">5. Hashå†²çªçš„è§£å†³åŠæ³•</a></li><li class="sidebar-sub-header"><a href="/fullstack-tutorial-site/notes/JavaArchitecture/02 Java é›†åˆæ¡†æ¶.html#_6-ä»€ä¹ˆæ˜¯è¿­ä»£å™¨" class="sidebar-link">6. ä»€ä¹ˆæ˜¯è¿­ä»£å™¨</a></li><li class="sidebar-sub-header"><a href="/fullstack-tutorial-site/notes/JavaArchitecture/02 Java é›†åˆæ¡†æ¶.html#_7-æ„é€ ç›¸åŒhashçš„å­—ç¬¦ä¸²è¿›è¡Œæ”»å‡»ï¼Œè¿™ç§æƒ…å†µåº”è¯¥æ€ä¹ˆå¤„ç†ï¼Ÿjdk7å¦‚ä½•å¤„ç†" class="sidebar-link">7. æ„é€ ç›¸åŒhashçš„å­—ç¬¦ä¸²è¿›è¡Œæ”»å‡»ï¼Œè¿™ç§æƒ…å†µåº”è¯¥æ€ä¹ˆå¤„ç†ï¼ŸJDK7å¦‚ä½•å¤„ç†</a></li><li class="sidebar-sub-header"><a href="/fullstack-tutorial-site/notes/JavaArchitecture/02 Java é›†åˆæ¡†æ¶.html#_8-hashmapä¸ºä»€ä¹ˆå¤§å°æ˜¯2çš„å¹‚æ¬¡" class="sidebar-link">8. Hashmapä¸ºä»€ä¹ˆå¤§å°æ˜¯2çš„å¹‚æ¬¡</a></li></ul></li><li class="sidebar-sub-header"><a href="/fullstack-tutorial-site/notes/JavaArchitecture/02 Java é›†åˆæ¡†æ¶.html#æ›´æ–°æ—¥å¿—" class="sidebar-link">æ›´æ–°æ—¥å¿—</a></li></ul></li><li><a href="/fullstack-tutorial-site/notes/JavaArchitecture/03 Java å¹¶å‘ç¼–ç¨‹.html" class="sidebar-link">Java å¹¶å‘ç¼–ç¨‹</a></li><li><a href="/fullstack-tutorial-site/notes/JavaArchitecture/04 Java IO.html" class="sidebar-link">Java I/O</a></li><li><a href="/fullstack-tutorial-site/notes/JavaArchitecture/05 Java è™šæ‹Ÿæœº.html" class="sidebar-link">Java è™šæ‹Ÿæœº</a></li><li><a href="/fullstack-tutorial-site/notes/JavaArchitecture/07 Java Web.html" class="sidebar-link">Java Web</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>æ•°æ®åº“</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/fullstack-tutorial-site/notes/MySQL.html" class="sidebar-link">å‰è¨€</a></li><li><a href="/fullstack-tutorial-site/notes/SQL.html" class="sidebar-link">å‰è¨€</a></li><li><a href="/fullstack-tutorial-site/notes/Redis.html" class="sidebar-link">å‰è¨€</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="java-é›†åˆæ¡†æ¶"><a href="#java-é›†åˆæ¡†æ¶" aria-hidden="true" class="header-anchor">#</a> Java é›†åˆæ¡†æ¶</h1> <h2 id="å‰è¨€"><a href="#å‰è¨€" aria-hidden="true" class="header-anchor">#</a> å‰è¨€</h2> <p>Javaé›†åˆæ¡†æ¶ (Java Collections Framework, JCF) ä¹Ÿç§°å®¹å™¨ï¼Œè¿™é‡Œå¯ä»¥ç±»æ¯” C++ ä¸­çš„ STLï¼Œåœ¨å¸‚é¢ä¸Šä¼¼ä¹è¿˜æ²¡èƒ½æ‰¾åˆ°ä¸€æœ¬è¯¦ç»†ä»‹ç»çš„ä¹¦ç±ã€‚åœ¨è¿™é‡Œä¸»è¦å¯¹å¦‚ä¸‹éƒ¨åˆ†è¿›è¡Œæºç åˆ†æï¼ŒåŠåœ¨é¢è¯•ä¸­å¸¸è§çš„é—®é¢˜ã€‚</p> <p>ä¾‹å¦‚ï¼Œåœ¨é˜¿é‡Œé¢è¯•å¸¸é—®åˆ°çš„ HashMap å’Œ ConcurrentHashMap åŸç†ç­‰ç­‰ã€‚æ·±å…¥æºç åˆ†ææ˜¯é¢è¯•ä¸­å¿…å¤‡çš„æŠ€èƒ½ï¼Œé€šè¿‡æœ¬æ–‡çš„é˜…è¯»ä¼šå¯¹é›†åˆæ¡†æ¶æœ‰æ›´æ·±ä¸€æ­¥çš„äº†è§£ã€‚</p> <p>æœ¬æ–‡å‚è€ƒï¼š</p> <ul><li><a href="https://github.com/CarpenterLee/JCFInternals" target="_blank" rel="noopener noreferrer">CarpenterLee/JCFInternals: æ·±å…¥ç†è§£Javaé›†åˆæ¡†æ¶<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/crossoverJie/Java-Interview" target="_blank" rel="noopener noreferrer">crossoverJie/Java-Interview: ğŸ‘¨â€ğŸ“ Java related : basic, concurrent, algorithm<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/CyC2018/Interview-Notebook/blob/master/notes/Java%20%E5%AE%B9%E5%99%A8.md" target="_blank" rel="noopener noreferrer">Interview-Notebook/Java å®¹å™¨.md at master Â· CyC2018/Interview-Notebook<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h2 id="ä¸€ã€æ¦‚è¿°"><a href="#ä¸€ã€æ¦‚è¿°" aria-hidden="true" class="header-anchor">#</a> ä¸€ã€æ¦‚è¿°</h2> <p>Javaé›†åˆæ¡†æ¶æä¾›äº†æ•°æ®æŒæœ‰å¯¹è±¡çš„æ–¹å¼ï¼Œæä¾›äº†å¯¹æ•°æ®é›†åˆçš„æ“ä½œã€‚Java é›†åˆæ¡†æ¶ä½äº <code>java.util</code> åŒ…ä¸‹ï¼Œä¸»è¦æœ‰ä¸‰ä¸ªå¤§ç±»ï¼š<strong>Collection(æ¥å£)</strong>ã€<strong>Map(æ¥å£)</strong>ã€<strong>é›†åˆå·¥å…·ç±»</strong>ã€‚</p> <h3 id="é›†åˆæ¡†æ¶å›¾"><a href="#é›†åˆæ¡†æ¶å›¾" aria-hidden="true" class="header-anchor">#</a> é›†åˆæ¡†æ¶å›¾</h3> <div align="center"><img src="assets/1535785576589.png" width></div> <h3 id="collection"><a href="#collection" aria-hidden="true" class="header-anchor">#</a> Collection</h3> <ul><li><code>ArrayList</code>ï¼š<strong>çº¿ç¨‹ä¸åŒæ­¥</strong>ã€‚é»˜è®¤åˆå§‹å®¹é‡ä¸º 10ï¼Œå½“æ•°ç»„å¤§å°ä¸è¶³æ—¶å®¹é‡æ‰©å¤§ä¸º 1.5 å€ã€‚ä¸ºè¿½æ±‚æ•ˆç‡ï¼ŒArrayList æ²¡æœ‰å®ç°åŒæ­¥ï¼ˆsynchronizedï¼‰ï¼Œå¦‚æœéœ€è¦å¤šä¸ªçº¿ç¨‹å¹¶å‘è®¿é—®ï¼Œç”¨æˆ·å¯ä»¥æ‰‹åŠ¨åŒæ­¥ï¼Œä¹Ÿå¯ä½¿ç”¨ Vector æ›¿ä»£ã€‚</li> <li><code>LinkedList</code>ï¼š<strong>çº¿ç¨‹ä¸åŒæ­¥</strong>ã€‚<strong>åŒå‘é“¾æ¥å®ç°</strong>ã€‚LinkedList åŒæ—¶å®ç°äº† List æ¥å£å’Œ Deque æ¥å£ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒæ—¢å¯ä»¥çœ‹ä½œä¸€ä¸ªé¡ºåºå®¹å™¨ï¼Œåˆå¯ä»¥çœ‹ä½œä¸€ä¸ªé˜Ÿåˆ—ï¼ˆQueueï¼‰ï¼ŒåŒæ—¶åˆå¯ä»¥çœ‹ä½œä¸€ä¸ªæ ˆï¼ˆStackï¼‰ã€‚è¿™æ ·çœ‹æ¥ï¼ŒLinkedList ç®€ç›´å°±æ˜¯ä¸ªå…¨èƒ½å† å†›ã€‚å½“ä½ éœ€è¦ä½¿ç”¨æ ˆæˆ–è€…é˜Ÿåˆ—æ—¶ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ LinkedListï¼Œä¸€æ–¹é¢æ˜¯å› ä¸º Java å®˜æ–¹å·²ç»å£°æ˜ä¸å»ºè®®ä½¿ç”¨ Stack ç±»ï¼Œæ›´é—æ†¾çš„æ˜¯ï¼ŒJava é‡Œæ ¹æœ¬æ²¡æœ‰ä¸€ä¸ªå«åš Queue çš„ç±»ï¼ˆå®ƒæ˜¯ä¸ªæ¥å£åå­—ï¼‰ã€‚å…³äºæ ˆæˆ–é˜Ÿåˆ—ï¼Œç°åœ¨çš„é¦–é€‰æ˜¯ ArrayDequeï¼Œå®ƒæœ‰ç€æ¯” LinkedListï¼ˆå½“ä½œæ ˆæˆ–é˜Ÿåˆ—ä½¿ç”¨æ—¶ï¼‰æœ‰ç€æ›´å¥½çš„æ€§èƒ½ã€‚</li> <li><code>Stack and Queue</code>ï¼šJava é‡Œæœ‰ä¸€ä¸ªå«åš Stack çš„ç±»ï¼Œå´æ²¡æœ‰å«åš Queue çš„ç±»ï¼ˆå®ƒæ˜¯ä¸ªæ¥å£åå­—ï¼‰ã€‚å½“éœ€è¦ä½¿ç”¨æ ˆæ—¶ï¼ŒJava å·²ä¸æ¨èä½¿ç”¨ Stackï¼Œè€Œæ˜¯æ¨èä½¿ç”¨æ›´é«˜æ•ˆçš„ ArrayDequeï¼›æ—¢ç„¶ Queue åªæ˜¯ä¸€ä¸ªæ¥å£ï¼Œå½“éœ€è¦ä½¿ç”¨é˜Ÿåˆ—æ—¶ä¹Ÿå°±é¦–é€‰ ArrayDeque äº†ï¼ˆæ¬¡é€‰æ˜¯ LinkedList ï¼‰ã€‚</li> <li><code>Vector</code>ï¼š<strong>çº¿ç¨‹åŒæ­¥</strong>ã€‚é»˜è®¤åˆå§‹å®¹é‡ä¸º 10ï¼Œå½“æ•°ç»„å¤§å°ä¸è¶³æ—¶å®¹é‡æ‰©å¤§ä¸º 2 å€ã€‚å®ƒçš„åŒæ­¥æ˜¯é€šè¿‡ <code>Iterator</code> æ–¹æ³•åŠ  <code>synchronized</code> å®ç°çš„ã€‚</li> <li><code>Stack</code>ï¼š<strong>çº¿ç¨‹åŒæ­¥</strong>ã€‚ç»§æ‰¿è‡ª Vectorï¼Œæ·»åŠ äº†å‡ ä¸ªæ–¹æ³•æ¥å®Œæˆæ ˆçš„åŠŸèƒ½ã€‚ç°åœ¨å·²ç»ä¸æ¨èä½¿ç”¨ Stackï¼Œåœ¨æ ˆå’Œé˜Ÿåˆ—ä¸­æœ‰é™ä½¿ç”¨ ArrayDequeï¼Œå…¶æ¬¡æ˜¯ LinkedListã€‚</li> <li><code>TreeSet</code>ï¼š<strong>çº¿ç¨‹ä¸åŒæ­¥</strong>ï¼Œå†…éƒ¨ä½¿ç”¨ <code>NavigableMap</code> æ“ä½œã€‚é»˜è®¤å…ƒç´  â€œè‡ªç„¶é¡ºåºâ€ æ’åˆ—ï¼Œå¯ä»¥é€šè¿‡ <code>Comparator</code> æ”¹å˜æ’åºã€‚TreeSet é‡Œé¢æœ‰ä¸€ä¸ª TreeMapï¼ˆé€‚é…å™¨æ¨¡å¼ï¼‰</li> <li><code>HashSet</code>ï¼š<strong>çº¿ç¨‹ä¸åŒæ­¥</strong>ï¼Œå†…éƒ¨ä½¿ç”¨ HashMap è¿›è¡Œæ•°æ®å­˜å‚¨ï¼Œæä¾›çš„æ–¹æ³•åŸºæœ¬éƒ½æ˜¯è°ƒç”¨ HashMap çš„æ–¹æ³•ï¼Œæ‰€ä»¥ä¸¤è€…æœ¬è´¨æ˜¯ä¸€æ ·çš„ã€‚é›†åˆå…ƒç´ å¯ä»¥ä¸º NULLã€‚</li> <li><code>Set</code>ï¼šSet æ˜¯ä¸€ç§ä¸åŒ…å«é‡å¤å…ƒç´ çš„ Collectionï¼ŒSet æœ€å¤šåªæœ‰ä¸€ä¸ª null å…ƒç´ ã€‚Set é›†åˆé€šå¸¸å¯ä»¥é€šè¿‡ Map é›†åˆé€šè¿‡é€‚é…å™¨æ¨¡å¼å¾—åˆ°ã€‚</li> <li><code>PriorityQueue</code>ï¼šJava ä¸­ PriorityQueue å®ç°äº† Queue æ¥å£ï¼Œä¸å…è®¸æ”¾å…¥ null å…ƒç´ ï¼›å…¶é€šè¿‡å †å®ç°ï¼Œå…·ä½“è¯´æ˜¯é€šè¿‡å®Œå…¨äºŒå‰æ ‘ï¼ˆcomplete binary treeï¼‰å®ç°çš„<strong>å°é¡¶å †</strong>ï¼ˆä»»æ„ä¸€ä¸ªéå¶å­èŠ‚ç‚¹çš„æƒå€¼ï¼Œéƒ½ä¸å¤§äºå…¶å·¦å³å­èŠ‚ç‚¹çš„æƒå€¼ï¼‰ï¼Œä¹Ÿå°±æ„å‘³ç€å¯ä»¥é€šè¿‡æ•°ç»„æ¥ä½œä¸º PriorityQueue çš„åº•å±‚å®ç°ã€‚
<ul><li><strong>ä¼˜å…ˆé˜Ÿåˆ—çš„ä½œç”¨æ˜¯èƒ½ä¿è¯æ¯æ¬¡å–å‡ºçš„å…ƒç´ éƒ½æ˜¯é˜Ÿåˆ—ä¸­æƒå€¼æœ€å°çš„</strong>ï¼ˆJava çš„ä¼˜å…ˆé˜Ÿåˆ—æ¯æ¬¡å–æœ€å°å…ƒç´ ï¼ŒC++ çš„ä¼˜å…ˆé˜Ÿåˆ—æ¯æ¬¡å–æœ€å¤§å…ƒç´ ï¼‰ã€‚è¿™é‡Œç‰µæ¶‰åˆ°äº†å¤§å°å…³ç³»ï¼Œ<strong>å…ƒç´ å¤§å°çš„è¯„åˆ¤å¯ä»¥é€šè¿‡å…ƒç´ æœ¬èº«çš„è‡ªç„¶é¡ºåºï¼ˆnatural orderingï¼‰ï¼Œä¹Ÿå¯ä»¥é€šè¿‡æ„é€ æ—¶ä¼ å…¥çš„æ¯”è¾ƒå™¨</strong>ï¼ˆ<em>Comparator</em>ï¼Œç±»ä¼¼äº C++ çš„ä»¿å‡½æ•°ï¼‰ã€‚</li></ul></li> <li><code>NavigableSet</code>ï¼šæ·»åŠ äº†æœç´¢åŠŸèƒ½ï¼Œå¯ä»¥å¯¹ç»™å®šå…ƒç´ è¿›è¡Œæœç´¢ï¼šå°äºã€å°äºç­‰äºã€å¤§äºã€å¤§äºç­‰äºï¼Œæ”¾å›ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„æœ€æ¥è¿‘ç»™å®šå…ƒç´ çš„ keyã€‚</li> <li><code>EnumSet</code>ï¼šçº¿ç¨‹ä¸åŒæ­¥ã€‚å†…éƒ¨ä½¿ç”¨ Enum æ•°ç»„å®ç°ï¼Œé€Ÿåº¦æ¯” <code>HashSet</code> å¿«ã€‚<strong>åªèƒ½å­˜å‚¨åœ¨æ„é€ å‡½æ•°ä¼ å…¥çš„æšä¸¾ç±»çš„æšä¸¾å€¼</strong>ã€‚</li></ul> <p>æ³¨é‡Šï¼šæ›´å¤šè®¾è®¡æ¨¡å¼ï¼Œè¯·è½¬å‘ <a href="/fullstack-tutorial-site/notes/JavaArchitecture/06 è®¾è®¡æ¨¡å¼.html">Java è®¾è®¡æ¨¡å¼</a></p> <h3 id="map"><a href="#map" aria-hidden="true" class="header-anchor">#</a> Map</h3> <ul><li><code>TreeMap</code>ï¼šçº¿ç¨‹ä¸åŒæ­¥ï¼ŒåŸºäº <strong>çº¢é»‘æ ‘</strong> ï¼ˆRed-Black treeï¼‰çš„ NavigableMap å®ç°ï¼Œèƒ½å¤ŸæŠŠå®ƒä¿å­˜çš„è®°å½•æ ¹æ®é”®æ’åºï¼Œé»˜è®¤æ˜¯æŒ‰é”®å€¼çš„å‡åºæ’åºï¼Œä¹Ÿå¯ä»¥æŒ‡å®šæ’åºçš„æ¯”è¾ƒå™¨ï¼Œå½“ç”¨ Iterator éå† TreeMap æ—¶ï¼Œå¾—åˆ°çš„è®°å½•æ˜¯æ’è¿‡åºçš„ã€‚
<ul><li><strong>TreeMap åº•å±‚é€šè¿‡çº¢é»‘æ ‘ï¼ˆRed-Black treeï¼‰å®ç°</strong>ï¼Œä¹Ÿå°±æ„å‘³ç€ <code>containsKey()</code>, <code>get()</code>, <code>put()</code>, <code>remove()</code> éƒ½æœ‰ç€ <code>log(n)</code> çš„æ—¶é—´å¤æ‚åº¦ã€‚å…¶å…·ä½“ç®—æ³•å®ç°å‚ç…§äº†ã€Šç®—æ³•å¯¼è®ºã€‹ã€‚</li></ul></li> <li><code>HashTable</code>ï¼š<strong>çº¿ç¨‹å®‰å…¨</strong>ï¼ŒHashMap çš„è¿­ä»£å™¨ (Iterator) æ˜¯ <code>fail-fast</code> è¿­ä»£å™¨ã€‚<strong>HashTable ä¸èƒ½å­˜å‚¨ NULL çš„ key å’Œ valueã€‚</strong></li> <li><code>HashMap</code>ï¼šçº¿ç¨‹ä¸åŒæ­¥ã€‚æ ¹æ® <code>key</code> çš„ <code>hashcode</code> è¿›è¡Œå­˜å‚¨ï¼Œå†…éƒ¨ä½¿ç”¨é™æ€å†…éƒ¨ç±» <code>Node</code> çš„æ•°ç»„è¿›è¡Œå­˜å‚¨ï¼Œé»˜è®¤åˆå§‹å¤§å°ä¸º 16ï¼Œæ¯æ¬¡æ‰©å¤§ä¸€å€ã€‚å½“å‘ç”Ÿ Hash å†²çªæ—¶ï¼Œé‡‡ç”¨æ‹‰é“¾æ³•ï¼ˆé“¾è¡¨ï¼‰ã€‚JDK 1.8ä¸­ï¼š<strong>å½“å•ä¸ªæ¡¶ä¸­å…ƒç´ ä¸ªæ•°å¤§äºç­‰äº8æ—¶ï¼Œé“¾è¡¨å®ç°æ”¹ä¸ºçº¢é»‘æ ‘å®ç°ï¼›å½“å…ƒç´ ä¸ªæ•°å°äº6æ—¶ï¼Œå˜å›é“¾è¡¨å®ç°ã€‚ç”±æ­¤æ¥é˜²æ­¢hashCodeæ”»å‡»ã€‚</strong> <ul><li>JavaÂ HashMap é‡‡ç”¨çš„æ˜¯å†²çªé“¾è¡¨æ–¹å¼ã€‚</li> <li>HashMap æ˜¯ Hashtable çš„è½»é‡çº§å®ç°ï¼Œå¯ä»¥æ¥å—ä¸º null çš„é”®å€¼ (key) å’Œå€¼ (value)ï¼Œè€Œ Hashtable ä¸å…è®¸ã€‚</li></ul></li> <li><code>LinkedHashMap</code>ï¼š<strong>ä¿å­˜äº†è®°å½•çš„æ’å…¥é¡ºåº</strong>ï¼Œåœ¨ç”¨ Iterator éå† LinkedHashMap æ—¶ï¼Œå…ˆå¾—åˆ°çš„è®°å½•è‚¯å®šæ˜¯å…ˆæ’å…¥çš„ã€‚ä¹Ÿå¯ä»¥åœ¨æ„é€ æ—¶ç”¨å¸¦å‚æ•°ï¼ŒæŒ‰ç…§åº”ç”¨æ¬¡æ•°æ’åºã€‚åœ¨éå†çš„æ—¶å€™ä¼šæ¯” HashMap æ…¢ï¼Œä¸è¿‡æœ‰ç§æƒ…å†µä¾‹å¤–ï¼Œå½“ HashMap å®¹é‡å¾ˆå¤§ï¼Œå®é™…æ•°æ®è¾ƒå°‘æ—¶ï¼Œéå†èµ·æ¥å¯èƒ½ä¼šæ¯” LinkedHashMap æ…¢ï¼Œå› ä¸º LinkedHashMap çš„éå†é€Ÿåº¦åªå’Œå®é™…æ•°æ®æœ‰å…³ï¼Œå’Œå®¹é‡æ— å…³ï¼Œè€Œ HashMap çš„éå†é€Ÿåº¦å’Œä»–çš„å®¹é‡æœ‰å…³ã€‚</li> <li><code>WeakHashMap</code>ï¼šä»åå­—å¯ä»¥çœ‹å‡ºå®ƒæ˜¯æŸç§Â Mapã€‚å®ƒçš„ç‰¹æ®Šä¹‹å¤„åœ¨äºÂ WeakHashMapÂ é‡Œçš„ entry å¯èƒ½ä¼šè¢« GC è‡ªåŠ¨åˆ é™¤ï¼Œå³ä½¿ç¨‹åºå‘˜æ²¡æœ‰è°ƒç”¨ <code>remove()</code> æˆ–è€… <code>clear()</code> æ–¹æ³•ã€‚ WeakHashMap çš„å­˜å‚¨ç»“æ„ç±»ä¼¼äºHashMap
<ul><li>æ—¢ç„¶æœ‰Â WeekHashMapï¼Œæ˜¯å¦æœ‰Â WeekHashSetÂ å‘¢ï¼Ÿç­”æ¡ˆæ˜¯æ²¡æœ‰ï¼ä¸è¿‡ JavaÂ Collections å·¥å…·ç±»ç»™å‡ºäº†è§£å†³æ–¹æ¡ˆï¼Œ<code>Collections.newSetFromMap(Map&lt;E,Boolean&gt; map)</code> æ–¹æ³•å¯ä»¥å°†ä»»ä½•Â MapåŒ…è£…æˆä¸€ä¸ªSetã€‚</li></ul></li></ul> <h3 id="å·¥å…·ç±»"><a href="#å·¥å…·ç±»" aria-hidden="true" class="header-anchor">#</a> å·¥å…·ç±»</h3> <ul><li><p><code>Collections</code>ã€<code>Arrays</code>ï¼šé›†åˆç±»çš„ä¸€ä¸ªå·¥å…·ç±»å¸®åŠ©ç±»ï¼Œå…¶ä¸­æä¾›äº†ä¸€ç³»åˆ—é™æ€æ–¹æ³•ï¼Œç”¨äºå¯¹é›†åˆä¸­å…ƒç´ è¿›è¡Œæ’åºã€æœç´¢ä»¥åŠçº¿ç¨‹å®‰å…¨ç­‰å„ç§æ“ä½œã€‚</p></li> <li><p><code>Comparable</code>ã€<code>Comparator</code>ï¼šä¸€èˆ¬æ˜¯ç”¨äºå¯¹è±¡çš„æ¯”è¾ƒæ¥å®ç°æ’åºï¼Œä¸¤è€…ç•¥æœ‰åŒºåˆ«ã€‚</p> <blockquote><ul><li>ç±»è®¾è®¡è€…æ²¡æœ‰è€ƒè™‘åˆ°æ¯”è¾ƒé—®é¢˜è€Œæ²¡æœ‰å®ç° Comparable æ¥å£ã€‚è¿™æ˜¯æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ä½¿ç”¨ Comparatorï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ˜¯ä¸éœ€è¦æ”¹å˜å¯¹è±¡çš„ã€‚</li> <li>ä¸€ä¸ªé›†åˆä¸­ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦æœ‰å¤šé‡çš„æ’åºæ ‡å‡†ï¼Œè¿™æ—¶å€™å¦‚æœä½¿ç”¨ Comparable å°±æœ‰äº›æ‰è¥Ÿè§è‚˜äº†ï¼Œå¯ä»¥è‡ªå·±ç»§æ‰¿ Comparator æä¾›å¤šç§æ ‡å‡†çš„æ¯”è¾ƒå™¨è¿›è¡Œæ’åºã€‚</li></ul></blockquote></li></ul> <p><strong>è¯´æ˜</strong>ï¼šçº¿ç¨‹ä¸åŒæ­¥çš„æ—¶å€™å¯ä»¥é€šè¿‡ï¼ŒCollections.synchronizedList() æ–¹æ³•æ¥åŒ…è£…ä¸€ä¸ªçº¿ç¨‹åŒæ­¥æ–¹æ³•</p> <h3 id="é€šç”¨å®ç°"><a href="#é€šç”¨å®ç°" aria-hidden="true" class="header-anchor">#</a> é€šç”¨å®ç°</h3> <table align="center"><tr><td colspan="2" rowspan="2" align="center" border="0"></td><th colspan="5" align="center">Implementations</th></tr><tr><th>Hash Table</th><th>Resizable Array</th><th>Balanced Tree</th><th>Linked List</th><th>Hash Table + Linked List</th></tr><tr><th rowspan="4">Interfaces</th><th>Set</th><td><tt>HashSet</tt></td><td></td><td><tt>TreeSet</tt></td><td></td><td><tt>LinkedHashSet</tt></td></tr><tr><th>List</th><td></td><td><tt>ArrayList</tt></td><td></td><td><tt>LinkedList</tt></td><td></td></tr><tr><th>Deque</th><td></td><td><tt>ArrayDeque</tt></td><td></td><td><tt>LinkedList</tt></td><td></td></tr><tr><th>Map</th><td><tt>HashMap</tt></td><td></td><td><tt>TreeMap</tt></td><td></td><td><tt>LinkedHashMap</tt></td></tr></table> <p><strong>å‚è€ƒèµ„æ–™ï¼š</strong></p> <ul><li><a href="https://github.com/CarpenterLee/JCFInternals" target="_blank" rel="noopener noreferrer">CarpenterLee/JCFInternals:æ·±å…¥ç†è§£Javaé›†åˆæ¡†æ¶<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://juejin.im/post/5af86ac8f265da0ba063410e" target="_blank" rel="noopener noreferrer">JavaåŸºç¡€-é›†åˆæ¡†æ¶ - æ˜é‡‘<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h2 id="äºŒã€æ·±å…¥æºç åˆ†æ"><a href="#äºŒã€æ·±å…¥æºç åˆ†æ" aria-hidden="true" class="header-anchor">#</a> äºŒã€æ·±å…¥æºç åˆ†æ</h2> <p>æºç åˆ†æåŸºäº JDK 1.8 / JDK 1.7ï¼Œåœ¨ IDEA ä¸­ double shift è°ƒå‡º Search EveryWhereï¼ŒæŸ¥æ‰¾æºç æ–‡ä»¶ï¼Œæ‰¾åˆ°ä¹‹åå°±å¯ä»¥é˜…è¯»æºç ã€‚</p> <h3 id="arraylist"><a href="#arraylist" aria-hidden="true" class="header-anchor">#</a> ArrayList</h3> <h4 id="_1-æ¦‚è§ˆ"><a href="#_1-æ¦‚è§ˆ" aria-hidden="true" class="header-anchor">#</a> 1. æ¦‚è§ˆ</h4> <p>å®ç°äº† RandomAccess æ¥å£ï¼Œå› æ­¤æ”¯æŒéšæœºè®¿é—®ï¼Œè¿™æ˜¯ç†æ‰€å½“ç„¶çš„ï¼Œå› ä¸º ArrayList æ˜¯åŸºäºæ•°ç»„å®ç°çš„ã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ArrayList</span><span class="token generics function"><span class="token punctuation">&lt;</span>E<span class="token punctuation">&gt;</span></span> <span class="token keyword">extends</span> <span class="token class-name">AbstractList</span><span class="token generics function"><span class="token punctuation">&lt;</span>E<span class="token punctuation">&gt;</span></span>
        <span class="token keyword">implements</span> <span class="token class-name">List</span><span class="token generics function"><span class="token punctuation">&lt;</span>E<span class="token punctuation">&gt;</span></span><span class="token punctuation">,</span> RandomAccess<span class="token punctuation">,</span> Cloneable<span class="token punctuation">,</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>Serializable
</code></pre></div><p>æ•°ç»„çš„é»˜è®¤å¤§å°ä¸º 10ã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> DEFAULT_CAPACITY <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
</code></pre></div><div align="center"><img src="/fullstack-tutorial-site/assets/img/ArrayList_base.3b9c8735.png" width="600"></div> <h4 id="_2-åºåˆ—åŒ–"><a href="#_2-åºåˆ—åŒ–" aria-hidden="true" class="header-anchor">#</a> 2. åºåˆ—åŒ–</h4> <p>åŸºäºæ•°ç»„å®ç°ï¼Œä¿å­˜å…ƒç´ çš„æ•°ç»„ä½¿ç”¨ transient ä¿®é¥°ï¼Œè¯¥å…³é”®å­—å£°æ˜æ•°ç»„é»˜è®¤ä¸ä¼šè¢«åºåˆ—åŒ–ã€‚ArrayList å…·æœ‰åŠ¨æ€æ‰©å®¹ç‰¹æ€§ï¼Œå› æ­¤ä¿å­˜å…ƒç´ çš„æ•°ç»„ä¸ä¸€å®šéƒ½ä¼šè¢«ä½¿ç”¨ï¼Œé‚£ä¹ˆå°±æ²¡å¿…è¦å…¨éƒ¨è¿›è¡Œåºåˆ—åŒ–ã€‚ArrayList é‡å†™äº† writeObject() å’Œ readObject() æ¥æ§åˆ¶åªåºåˆ—åŒ–æ•°ç»„ä¸­æœ‰å…ƒç´ å¡«å……é‚£éƒ¨åˆ†å†…å®¹ã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">transient</span> Object<span class="token punctuation">[</span><span class="token punctuation">]</span> elementData<span class="token punctuation">;</span> <span class="token comment">// non-private to simplify nested class access</span>
</code></pre></div><h4 id="_3-æ‰©å®¹"><a href="#_3-æ‰©å®¹" aria-hidden="true" class="header-anchor">#</a> 3. æ‰©å®¹</h4> <p>æ·»åŠ å…ƒç´ æ—¶ä½¿ç”¨ ensureCapacityInternal() æ–¹æ³•æ¥ä¿è¯å®¹é‡è¶³å¤Ÿï¼Œå¦‚æœä¸å¤Ÿæ—¶ï¼Œéœ€è¦ä½¿ç”¨ grow() æ–¹æ³•è¿›è¡Œæ‰©å®¹ï¼Œæ–°å®¹é‡çš„å¤§å°ä¸º <code>oldCapacity + (oldCapacity &gt;&gt; 1)</code>ï¼Œä¹Ÿå°±æ˜¯æ—§å®¹é‡çš„ 1.5 å€ã€‚</p> <p>æ‰©å®¹æ“ä½œéœ€è¦è°ƒç”¨ <code>Arrays.copyOf()</code> æŠŠåŸæ•°ç»„æ•´ä¸ªå¤åˆ¶åˆ°æ–°æ•°ç»„ä¸­ï¼Œè¿™ä¸ªæ“ä½œä»£ä»·å¾ˆé«˜ï¼Œå› æ­¤æœ€å¥½åœ¨åˆ›å»º ArrayList å¯¹è±¡æ—¶å°±æŒ‡å®šå¤§æ¦‚çš„å®¹é‡å¤§å°ï¼Œå‡å°‘æ‰©å®¹æ“ä½œçš„æ¬¡æ•°ã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// JDK 1.8</span>
    
<span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">add</span><span class="token punctuation">(</span>E e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">ensureCapacityInternal</span><span class="token punctuation">(</span>size <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// Increments modCount!!</span>
    elementData<span class="token punctuation">[</span>size<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> e<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// åˆ¤æ–­æ•°ç»„æ˜¯å¦è¶Šç•Œ</span>
<span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">ensureCapacityInternal</span><span class="token punctuation">(</span><span class="token keyword">int</span> minCapacity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>elementData <span class="token operator">==</span> DEFAULTCAPACITY_EMPTY_ELEMENTDATA<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        minCapacity <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>DEFAULT_CAPACITY<span class="token punctuation">,</span> minCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">ensureExplicitCapacity</span><span class="token punctuation">(</span>minCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">ensureExplicitCapacity</span><span class="token punctuation">(</span><span class="token keyword">int</span> minCapacity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    modCount<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token comment">// overflow-conscious code</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>minCapacity <span class="token operator">-</span> elementData<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token function">grow</span><span class="token punctuation">(</span>minCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// æ‰©å®¹</span>
<span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">grow</span><span class="token punctuation">(</span><span class="token keyword">int</span> minCapacity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// overflow-conscious code</span>
    <span class="token keyword">int</span> oldCapacity <span class="token operator">=</span> elementData<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
    <span class="token keyword">int</span> newCapacity <span class="token operator">=</span> oldCapacity <span class="token operator">+</span> <span class="token punctuation">(</span>oldCapacity <span class="token operator">&gt;&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1.5å€</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>newCapacity <span class="token operator">-</span> minCapacity <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
        newCapacity <span class="token operator">=</span> minCapacity<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>newCapacity <span class="token operator">-</span> MAX_ARRAY_SIZE <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
        newCapacity <span class="token operator">=</span> <span class="token function">hugeCapacity</span><span class="token punctuation">(</span>minCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// minCapacity is usually close to size, so this is a win:</span>
    elementData <span class="token operator">=</span> Arrays<span class="token punctuation">.</span><span class="token function">copyOf</span><span class="token punctuation">(</span>elementData<span class="token punctuation">,</span> newCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">hugeCapacity</span><span class="token punctuation">(</span><span class="token keyword">int</span> minCapacity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>minCapacity <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">// overflow</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">OutOfMemoryError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>minCapacity <span class="token operator">&gt;</span> MAX_ARRAY_SIZE<span class="token punctuation">)</span> <span class="token operator">?</span> Integer<span class="token punctuation">.</span>MAX_VALUE <span class="token operator">:</span> MAX_ARRAY_SIZE<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_4-åˆ é™¤å…ƒç´ "><a href="#_4-åˆ é™¤å…ƒç´ " aria-hidden="true" class="header-anchor">#</a> 4. åˆ é™¤å…ƒç´ </h4> <p>éœ€è¦è°ƒç”¨ System.arraycopy() å°† index+1 åé¢çš„å…ƒç´ éƒ½å¤åˆ¶åˆ° index ä½ç½®ä¸Šã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> E <span class="token function">remove</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">rangeCheck</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
    modCount<span class="token operator">++</span><span class="token punctuation">;</span>
    E oldValue <span class="token operator">=</span> <span class="token function">elementData</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> numMoved <span class="token operator">=</span> size <span class="token operator">-</span> index <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>numMoved <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
        System<span class="token punctuation">.</span><span class="token function">arraycopy</span><span class="token punctuation">(</span>elementData<span class="token punctuation">,</span> index<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> elementData<span class="token punctuation">,</span> index<span class="token punctuation">,</span> numMoved<span class="token punctuation">)</span><span class="token punctuation">;</span>
    elementData<span class="token punctuation">[</span><span class="token operator">--</span>size<span class="token punctuation">]</span> <span class="token operator">=</span> null<span class="token punctuation">;</span> <span class="token comment">// clear to let GC do its work</span>
    <span class="token keyword">return</span> oldValue<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_5-fail-fast"><a href="#_5-fail-fast" aria-hidden="true" class="header-anchor">#</a> 5. Fail-Fast</h4> <p><strong>å¼€å§‹ä¹‹å‰æˆ‘ä»¬æƒ³è®²è®²ï¼Œä»€ä¹ˆæ˜¯ fail-fast æœºåˆ¶?</strong></p> <p>fail-fast æœºåˆ¶åœ¨éå†ä¸€ä¸ªé›†åˆæ—¶ï¼Œå½“é›†åˆç»“æ„è¢«ä¿®æ”¹ï¼Œä¼šæŠ›å‡º Concurrent Modification Exceptionã€‚</p> <p>fail-fast ä¼šåœ¨ä»¥ä¸‹ä¸¤ç§æƒ…å†µä¸‹æŠ›å‡º Concurrent Modification Exception</p> <p>ï¼ˆ1ï¼‰å•çº¿ç¨‹ç¯å¢ƒ</p> <ul><li><p>é›†åˆè¢«åˆ›å»ºåï¼Œåœ¨éå†å®ƒçš„è¿‡ç¨‹ä¸­ä¿®æ”¹äº†ç»“æ„ã€‚</p></li> <li><p>æ³¨æ„ remove() æ–¹æ³•ä¼šè®© expectModcount å’Œ modcount ç›¸ç­‰ï¼Œæ‰€ä»¥æ˜¯ä¸ä¼šæŠ›å‡ºè¿™ä¸ªå¼‚å¸¸ã€‚</p></li></ul> <p>ï¼ˆ2ï¼‰å¤šçº¿ç¨‹ç¯å¢ƒ</p> <ul><li>å½“ä¸€ä¸ªçº¿ç¨‹åœ¨éå†è¿™ä¸ªé›†åˆï¼Œè€Œå¦ä¸€ä¸ªçº¿ç¨‹å¯¹è¿™ä¸ªé›†åˆçš„ç»“æ„è¿›è¡Œäº†ä¿®æ”¹ã€‚</li></ul> <p>modCount ç”¨æ¥è®°å½• ArrayList ç»“æ„å‘ç”Ÿå˜åŒ–çš„æ¬¡æ•°ã€‚ç»“æ„å‘ç”Ÿå˜åŒ–æ˜¯æŒ‡<strong>æ·»åŠ </strong>æˆ–è€…<strong>åˆ é™¤</strong>è‡³å°‘ä¸€ä¸ªå…ƒç´ çš„æ‰€æœ‰æ“ä½œï¼Œæˆ–è€…æ˜¯è°ƒæ•´å†…éƒ¨æ•°ç»„çš„å¤§å°ï¼Œä»…ä»…åªæ˜¯è®¾ç½®å…ƒç´ çš„å€¼ä¸ç®—ç»“æ„å‘ç”Ÿå˜åŒ–ã€‚</p> <p>åœ¨è¿›è¡Œåºåˆ—åŒ–æˆ–è€…è¿­ä»£ç­‰æ“ä½œæ—¶ï¼Œéœ€è¦æ¯”è¾ƒæ“ä½œå‰å modCount æ˜¯å¦æ”¹å˜ï¼Œå¦‚æœæ”¹å˜äº†éœ€è¦æŠ›å‡º Concurrent Modification Exceptionã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">writeObject</span><span class="token punctuation">(</span>java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>ObjectOutputStream s<span class="token punctuation">)</span> <span class="token keyword">throws</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>IOException<span class="token punctuation">{</span>
    <span class="token comment">// Write out element count, and any hidden stuff</span>
    <span class="token keyword">int</span> expectedModCount <span class="token operator">=</span> modCount<span class="token punctuation">;</span>
    s<span class="token punctuation">.</span><span class="token function">defaultWriteObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Write out size as capacity for behavioural compatibility with clone()</span>
    s<span class="token punctuation">.</span><span class="token function">writeInt</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Write out all elements in the proper order.</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        s<span class="token punctuation">.</span><span class="token function">writeObject</span><span class="token punctuation">(</span>elementData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>modCount <span class="token operator">!=</span> expectedModCount<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ConcurrentModificationException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="vector"><a href="#vector" aria-hidden="true" class="header-anchor">#</a> Vector</h3> <h4 id="_1-åŒæ­¥"><a href="#_1-åŒæ­¥" aria-hidden="true" class="header-anchor">#</a> 1. åŒæ­¥</h4> <p>å®ƒçš„å®ç°ä¸ ArrayList ç±»ä¼¼ï¼Œä½†æ˜¯ä½¿ç”¨äº† synchronized è¿›è¡ŒåŒæ­¥ã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token keyword">boolean</span> <span class="token function">add</span><span class="token punctuation">(</span>E e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    modCount<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token function">ensureCapacityHelper</span><span class="token punctuation">(</span>elementCount <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    elementData<span class="token punctuation">[</span>elementCount<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> e<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">synchronized</span> E <span class="token function">get</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">&gt;=</span> elementCount<span class="token punctuation">)</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ArrayIndexOutOfBoundsException</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token function">elementData</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_2-arraylist-ä¸-vector"><a href="#_2-arraylist-ä¸-vector" aria-hidden="true" class="header-anchor">#</a> 2. ArrayList ä¸ Vector</h4> <ul><li>Vector æ˜¯åŒæ­¥çš„ï¼Œå› æ­¤å¼€é”€å°±æ¯” ArrayList è¦å¤§ï¼Œè®¿é—®é€Ÿåº¦æ›´æ…¢ã€‚æœ€å¥½ä½¿ç”¨ ArrayList è€Œä¸æ˜¯ Vectorï¼Œå› ä¸ºåŒæ­¥æ“ä½œå®Œå…¨å¯ä»¥ç”±ç¨‹åºå‘˜è‡ªå·±æ¥æ§åˆ¶ï¼›</li> <li>Vector æ¯æ¬¡æ‰©å®¹è¯·æ±‚å…¶å¤§å°çš„ 2 å€ç©ºé—´ï¼Œè€Œ ArrayList æ˜¯ 1.5 å€ã€‚</li></ul> <h4 id="_3-vector-æ›¿ä»£æ–¹æ¡ˆ"><a href="#_3-vector-æ›¿ä»£æ–¹æ¡ˆ" aria-hidden="true" class="header-anchor">#</a> 3. Vector æ›¿ä»£æ–¹æ¡ˆ</h4> <h5 id="synchronizedlist"><a href="#synchronizedlist" aria-hidden="true" class="header-anchor">#</a> synchronizedList</h5> <p>ä¸ºäº†è·å¾—çº¿ç¨‹å®‰å…¨çš„ ArrayListï¼Œå¯ä»¥ä½¿ç”¨  <code>Collections.synchronizedList();</code>  å¾—åˆ°ä¸€ä¸ªçº¿ç¨‹å®‰å…¨çš„  ArrayListã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code>List<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
List<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">&gt;</span></span> synList <span class="token operator">=</span> Collections<span class="token punctuation">.</span><span class="token function">synchronizedList</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h5 id="copyonwritearraylist"><a href="#copyonwritearraylist" aria-hidden="true" class="header-anchor">#</a> CopyOnWriteArrayList</h5> <div align="center"><img src="/fullstack-tutorial-site/assets/img/cow.37ae13d4.png" width></div><br> <p>ä¹Ÿå¯ä»¥ä½¿ç”¨ concurrent å¹¶å‘åŒ…ä¸‹çš„ CopyOnWriteArrayList ç±»ã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code>List<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CopyOnWriteArrayList</span><span class="token operator">&lt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>CopyOnWrite å®¹å™¨å³å†™æ—¶å¤åˆ¶çš„å®¹å™¨ã€‚é€šä¿—çš„ç†è§£æ˜¯<strong>å½“æˆ‘ä»¬å¾€ä¸€ä¸ªå®¹å™¨æ·»åŠ å…ƒç´ çš„æ—¶å€™ï¼Œä¸ç›´æ¥å¾€å½“å‰å®¹å™¨æ·»åŠ ï¼Œè€Œæ˜¯å…ˆå°†å½“å‰å®¹å™¨è¿›è¡Œ Copyï¼Œå¤åˆ¶å‡ºä¸€ä¸ªæ–°çš„å®¹å™¨ï¼Œç„¶åæ–°çš„å®¹å™¨é‡Œæ·»åŠ å…ƒç´ ï¼Œæ·»åŠ å®Œå…ƒç´ ä¹‹åï¼Œå†å°†åŸå®¹å™¨çš„å¼•ç”¨æŒ‡å‘æ–°çš„å®¹å™¨</strong>ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯æˆ‘ä»¬å¯ä»¥å¯¹ CopyOnWrite å®¹å™¨è¿›è¡Œå¹¶å‘çš„è¯»ï¼Œè€Œä¸éœ€è¦åŠ é”ï¼Œå› ä¸ºå½“å‰å®¹å™¨ä¸ä¼šæ·»åŠ ä»»ä½•å…ƒç´ ã€‚æ‰€ä»¥ CopyOnWrite å®¹å™¨ä¹Ÿæ˜¯ä¸€ç§<strong>è¯»å†™åˆ†ç¦»</strong>çš„æ€æƒ³ï¼Œè¯»å’Œå†™ä¸åŒçš„å®¹å™¨ã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">add</span><span class="token punctuation">(</span>T e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">final</span> ReentrantLock lock <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>lock<span class="token punctuation">;</span>
    lock<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        Object<span class="token punctuation">[</span><span class="token punctuation">]</span> elements <span class="token operator">=</span> <span class="token function">getArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> len <span class="token operator">=</span> elements<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
        <span class="token comment">// å¤åˆ¶å‡ºæ–°æ•°ç»„</span>
        Object<span class="token punctuation">[</span><span class="token punctuation">]</span> newElements <span class="token operator">=</span> Arrays<span class="token punctuation">.</span><span class="token function">copyOf</span><span class="token punctuation">(</span>elements<span class="token punctuation">,</span> len <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// æŠŠæ–°å…ƒç´ æ·»åŠ åˆ°æ–°æ•°ç»„é‡Œ</span>
        newElements<span class="token punctuation">[</span>len<span class="token punctuation">]</span> <span class="token operator">=</span> e<span class="token punctuation">;</span>
        <span class="token comment">// æŠŠåŸæ•°ç»„å¼•ç”¨æŒ‡å‘æ–°æ•°ç»„</span>
        <span class="token function">setArray</span><span class="token punctuation">(</span>newElements<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
        lock<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">final</span> <span class="token keyword">void</span> <span class="token function">setArray</span><span class="token punctuation">(</span>Object<span class="token punctuation">[</span><span class="token punctuation">]</span> a<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    array <span class="token operator">=</span> a<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>è¯»çš„æ—¶å€™ä¸éœ€è¦åŠ é”ï¼Œå¦‚æœè¯»çš„æ—¶å€™æœ‰å¤šä¸ªçº¿ç¨‹æ­£åœ¨å‘ ArrayList æ·»åŠ æ•°æ®ï¼Œè¯»è¿˜æ˜¯ä¼šè¯»åˆ°æ—§çš„æ•°æ®ï¼Œå› ä¸ºå†™çš„æ—¶å€™ä¸ä¼šé”ä½æ—§çš„ ArrayListã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> E <span class="token function">get</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token function">getArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> index<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>CopyOnWriteçš„ç¼ºç‚¹</strong></p> <ul><li>CopyOnWrite å®¹å™¨æœ‰å¾ˆå¤šä¼˜ç‚¹ï¼Œä½†æ˜¯åŒæ—¶ä¹Ÿå­˜åœ¨ä¸¤ä¸ªé—®é¢˜ï¼Œå³å†…å­˜å ç”¨é—®é¢˜å’Œæ•°æ®ä¸€è‡´æ€§é—®é¢˜ã€‚æ‰€ä»¥åœ¨å¼€å‘çš„æ—¶å€™éœ€è¦æ³¨æ„ä¸€ä¸‹ã€‚</li></ul> <p><strong>å†…å­˜å ç”¨é—®é¢˜</strong>ã€‚</p> <ul><li><p>å› ä¸º CopyOnWrite çš„å†™æ—¶å¤åˆ¶æœºåˆ¶ï¼Œæ‰€ä»¥åœ¨è¿›è¡Œå†™æ“ä½œçš„æ—¶å€™ï¼Œå†…å­˜é‡Œä¼šåŒæ—¶é©»æ‰ä¸¤ä¸ªå¯¹è±¡çš„å†…å­˜ï¼Œæ—§çš„å¯¹è±¡å’Œæ–°å†™å…¥çš„å¯¹è±¡ï¼ˆæ³¨æ„ï¼šåœ¨å¤åˆ¶çš„æ—¶å€™åªæ˜¯å¤åˆ¶å®¹å™¨é‡Œçš„å¼•ç”¨ï¼Œåªæ˜¯åœ¨å†™çš„æ—¶å€™ä¼šåˆ›å»ºæ–°å¯¹è±¡æ·»åŠ åˆ°æ–°å®¹å™¨é‡Œï¼Œè€Œæ—§å®¹å™¨çš„å¯¹è±¡è¿˜åœ¨ä½¿ç”¨ï¼Œæ‰€ä»¥æœ‰ä¸¤ä»½å¯¹è±¡å†…å­˜ï¼‰ã€‚å¦‚æœè¿™äº›å¯¹è±¡å ç”¨çš„å†…å­˜æ¯”è¾ƒå¤§ï¼Œæ¯”å¦‚è¯´ 200M å·¦å³ï¼Œé‚£ä¹ˆå†å†™å…¥ 100M æ•°æ®è¿›å»ï¼Œå†…å­˜å°±ä¼šå ç”¨ 300Mï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™å¾ˆæœ‰å¯èƒ½é€ æˆé¢‘ç¹çš„ Yong GC å’Œ Full GCã€‚ä¹‹å‰æˆ‘ä»¬ç³»ç»Ÿä¸­ä½¿ç”¨äº†ä¸€ä¸ªæœåŠ¡ç”±äºæ¯æ™šä½¿ç”¨ CopyOnWrite æœºåˆ¶æ›´æ–°å¤§å¯¹è±¡ï¼Œé€ æˆäº†æ¯æ™š 15 ç§’çš„ Full GCï¼Œåº”ç”¨å“åº”æ—¶é—´ä¹Ÿéšä¹‹å˜é•¿ã€‚</p></li> <li><p>é’ˆå¯¹å†…å­˜å ç”¨é—®é¢˜ï¼Œå¯ä»¥é€šè¿‡å‹ç¼©å®¹å™¨ä¸­çš„å…ƒç´ çš„æ–¹æ³•æ¥å‡å°‘å¤§å¯¹è±¡çš„å†…å­˜æ¶ˆè€—ï¼Œæ¯”å¦‚ï¼Œå¦‚æœå…ƒç´ å…¨æ˜¯ 10 è¿›åˆ¶çš„æ•°å­—ï¼Œå¯ä»¥è€ƒè™‘æŠŠå®ƒå‹ç¼©æˆ 36 è¿›åˆ¶æˆ– 64 è¿›åˆ¶ã€‚æˆ–è€…ä¸ä½¿ç”¨ CopyOnWrite å®¹å™¨ï¼Œè€Œä½¿ç”¨å…¶ä»–çš„å¹¶å‘å®¹å™¨ï¼Œå¦‚  ConcurrentHashMap ã€‚</p></li></ul> <p><strong>æ•°æ®ä¸€è‡´æ€§é—®é¢˜</strong>ã€‚</p> <ul><li><p>CopyOnWrite å®¹å™¨åªèƒ½ä¿è¯æ•°æ®çš„æœ€ç»ˆä¸€è‡´æ€§ï¼Œä¸èƒ½ä¿è¯æ•°æ®çš„å®æ—¶ä¸€è‡´æ€§ã€‚æ‰€ä»¥å¦‚æœä½ å¸Œæœ›å†™å…¥çš„çš„æ•°æ®ï¼Œé©¬ä¸Šèƒ½è¯»åˆ°ï¼Œè¯·ä¸è¦ä½¿ç”¨ CopyOnWrite å®¹å™¨ã€‚</p></li> <li><p>å…³äº C++ çš„ STL ä¸­ï¼Œæ›¾ç»ä¹Ÿæœ‰è¿‡ Copy-On-Write çš„ç©æ³•ï¼Œå‚è§é™ˆçš“çš„ã€Š<a href="http://blog.csdn.net/haoel/article/details/24058" target="_blank" rel="noopener noreferrer">C++ STL Stringç±»ä¸­çš„Copy-On-Write<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ã€‹ï¼Œåæ¥ï¼Œå› ä¸ºæœ‰å¾ˆå¤šçº¿ç¨‹å®‰å…¨ä¸Šçš„äº‹ï¼Œå°±è¢«å»æ‰äº†ã€‚</p></li></ul> <p>å‚è€ƒèµ„æ–™ï¼š</p> <ul><li><a href="http://ifeve.com/java-copy-on-write/" target="_blank" rel="noopener noreferrer">èŠèŠå¹¶å‘-Javaä¸­çš„Copy-On-Writeå®¹å™¨ | å¹¶å‘ç¼–ç¨‹ç½‘ â€“ ifeve.com<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h3 id="linkedlist"><a href="#linkedlist" aria-hidden="true" class="header-anchor">#</a> LinkedList</h3> <div align="center"><img src="/fullstack-tutorial-site/assets/img/LinkedList_base.6ba4ca4b.png" width="600"></div> <h4 id="_1-æ¦‚è§ˆ-2"><a href="#_1-æ¦‚è§ˆ-2" aria-hidden="true" class="header-anchor">#</a> 1. æ¦‚è§ˆ</h4> <p><strong>LinkedList åº•å±‚æ˜¯åŸºäºåŒå‘é“¾è¡¨å®ç°çš„</strong>ï¼Œä¹Ÿæ˜¯å®ç°äº† List æ¥å£ï¼Œæ‰€ä»¥ä¹Ÿæ‹¥æœ‰ List çš„ä¸€äº›ç‰¹ç‚¹ (JDK1.7/8 ä¹‹åå–æ¶ˆäº†å¾ªç¯ï¼Œä¿®æ”¹ä¸ºåŒå‘é“¾è¡¨) ã€‚</p> <p>LinkedList åŒæ—¶å®ç°äº† List æ¥å£å’Œ Deque æ¥å£ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒæ—¢å¯ä»¥çœ‹ä½œä¸€ä¸ªé¡ºåºå®¹å™¨ï¼Œåˆå¯ä»¥çœ‹ä½œä¸€ä¸ªé˜Ÿåˆ—ï¼ˆQueueï¼‰ï¼ŒåŒæ—¶åˆå¯ä»¥çœ‹ä½œä¸€ä¸ªæ ˆï¼ˆStackï¼‰ã€‚è¿™æ ·çœ‹æ¥ï¼Œ LinkedList ç®€ç›´å°±æ˜¯ä¸ªå…¨èƒ½å† å†›ã€‚å½“ä½ éœ€è¦ä½¿ç”¨æ ˆæˆ–è€…é˜Ÿåˆ—æ—¶ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ LinkedList ï¼Œä¸€æ–¹é¢æ˜¯å› ä¸º Java å®˜æ–¹å·²ç»å£°æ˜ä¸å»ºè®®ä½¿ç”¨ Stack ç±»ï¼Œæ›´é—æ†¾çš„æ˜¯ï¼ŒJavaé‡Œæ ¹æœ¬æ²¡æœ‰ä¸€ä¸ªå«åš Queue çš„ç±»ï¼ˆå®ƒæ˜¯ä¸ªæ¥å£åå­—ï¼‰ã€‚</p> <p>å…³äºæ ˆæˆ–é˜Ÿåˆ—ï¼Œç°åœ¨çš„é¦–é€‰æ˜¯ ArrayDequeï¼Œå®ƒæœ‰ç€æ¯” LinkedList ï¼ˆå½“ä½œæ ˆæˆ–é˜Ÿåˆ—ä½¿ç”¨æ—¶ï¼‰æœ‰ç€æ›´å¥½çš„æ€§èƒ½ã€‚</p> <p>åŸºäºåŒå‘é“¾è¡¨å®ç°ï¼Œå†…éƒ¨ä½¿ç”¨ Node æ¥å­˜å‚¨é“¾è¡¨èŠ‚ç‚¹ä¿¡æ¯ã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Node</span><span class="token generics function"><span class="token punctuation">&lt;</span>E<span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    E item<span class="token punctuation">;</span>
    Node<span class="token generics function"><span class="token punctuation">&lt;</span>E<span class="token punctuation">&gt;</span></span> next<span class="token punctuation">;</span>
    Node<span class="token generics function"><span class="token punctuation">&lt;</span>E<span class="token punctuation">&gt;</span></span> prev<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æ¯ä¸ªé“¾è¡¨å­˜å‚¨äº† Head å’Œ Tail æŒ‡é’ˆï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">transient</span> Node<span class="token generics function"><span class="token punctuation">&lt;</span>E<span class="token punctuation">&gt;</span></span> first<span class="token punctuation">;</span>
<span class="token keyword">transient</span> Node<span class="token generics function"><span class="token punctuation">&lt;</span>E<span class="token punctuation">&gt;</span></span> last<span class="token punctuation">;</span>
</code></pre></div><p>LinkedList çš„å®ç°æ–¹å¼å†³å®šäº†æ‰€æœ‰è·Ÿä¸‹æ ‡ç›¸å…³çš„æ“ä½œéƒ½æ˜¯çº¿æ€§æ—¶é—´ï¼Œè€Œåœ¨é¦–æ®µæˆ–è€…æœ«å°¾åˆ é™¤å…ƒç´ åªéœ€è¦å¸¸æ•°æ—¶é—´ã€‚ä¸ºè¿½æ±‚æ•ˆç‡<em>LinkedList</em>æ²¡æœ‰å®ç°åŒæ­¥ï¼ˆsynchronizedï¼‰ï¼Œå¦‚æœéœ€è¦å¤šä¸ªçº¿ç¨‹å¹¶å‘è®¿é—®ï¼Œå¯ä»¥å…ˆé‡‡ç”¨ <code>Collections.synchronizedList()</code> æ–¹æ³•å¯¹å…¶è¿›è¡ŒåŒ…è£…ã€‚</p> <h4 id="_2-add"><a href="#_2-add" aria-hidden="true" class="header-anchor">#</a> 2. add()</h4> <div align="center"><img src="/fullstack-tutorial-site/assets/img/LinkedList_add.ad49ee18.png" width="600"></div> <p>add() æ–¹æ³•æœ‰ä¸¤ä¸ªç‰ˆæœ¬ï¼Œä¸€ä¸ªæ˜¯ <code>add(E e)</code>ï¼Œè¯¥æ–¹æ³•åœ¨ LinkedList çš„æœ«å°¾æ’å…¥å…ƒç´ ï¼Œå› ä¸ºæœ‰ last æŒ‡å‘é“¾è¡¨æœ«å°¾ï¼Œåœ¨æœ«å°¾æ’å…¥å…ƒç´ çš„èŠ±è´¹æ˜¯å¸¸æ•°æ—¶é—´ã€‚åªéœ€è¦ç®€å•ä¿®æ”¹å‡ ä¸ªç›¸å…³å¼•ç”¨å³å¯ï¼›å¦ä¸€ä¸ªæ˜¯ <code>add(int index, E element)</code>ï¼Œè¯¥æ–¹æ³•æ˜¯åœ¨æŒ‡å®šä¸‹è¡¨å¤„æ’å…¥å…ƒç´ ï¼Œéœ€è¦å…ˆé€šè¿‡çº¿æ€§æŸ¥æ‰¾æ‰¾åˆ°å…·ä½“ä½ç½®ï¼Œç„¶åä¿®æ”¹ç›¸å…³å¼•ç”¨å®Œæˆæ’å…¥æ“ä½œã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// JDK 1.8</span>
<span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">add</span><span class="token punctuation">(</span>E e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">linkLast</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
* Links e as last element.
*/</span>
<span class="token keyword">void</span> <span class="token function">linkLast</span><span class="token punctuation">(</span>E e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">final</span> Node<span class="token generics function"><span class="token punctuation">&lt;</span>E<span class="token punctuation">&gt;</span></span> l <span class="token operator">=</span> last<span class="token punctuation">;</span>
    <span class="token keyword">final</span> Node<span class="token generics function"><span class="token punctuation">&lt;</span>E<span class="token punctuation">&gt;</span></span> newNode <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token operator">&lt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>l<span class="token punctuation">,</span> e<span class="token punctuation">,</span> null<span class="token punctuation">)</span><span class="token punctuation">;</span>
    last <span class="token operator">=</span> newNode<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>l <span class="token operator">==</span> null<span class="token punctuation">)</span>
        first <span class="token operator">=</span> newNode<span class="token punctuation">;</span>
    <span class="token keyword">else</span>
        l<span class="token punctuation">.</span>next <span class="token operator">=</span> newNode<span class="token punctuation">;</span>
    size<span class="token operator">++</span><span class="token punctuation">;</span>
    modCount<span class="token operator">++</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><p><code>add(int index, E element)</code> çš„é€»è¾‘ç¨æ˜¾å¤æ‚ï¼Œå¯ä»¥åˆ†æˆä¸¤éƒ¨åˆ†</p> <ol><li><p>å…ˆæ ¹æ® index æ‰¾åˆ°è¦æ’å…¥çš„ä½ç½®ï¼›</p></li> <li><p>ä¿®æ”¹å¼•ç”¨ï¼Œå®Œæˆæ’å…¥æ“ä½œã€‚</p></li></ol> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">,</span> E element<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">checkPositionIndex</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">==</span> size<span class="token punctuation">)</span>
        <span class="token function">linkLast</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span>
        <span class="token function">linkBefore</span><span class="token punctuation">(</span>element<span class="token punctuation">,</span> <span class="token function">node</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">checkPositionIndex</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isPositionIndex</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IndexOutOfBoundsException</span><span class="token punctuation">(</span><span class="token function">outOfBoundsMsg</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ä¸Šé¢ä»£ç ä¸­çš„ <code>node(int index)</code> å‡½æ•°æœ‰ä¸€ç‚¹å°å°çš„ trickï¼Œå› ä¸ºé“¾è¡¨åŒå‘çš„ï¼Œå¯ä»¥ä»å¼€å§‹å¾€åæ‰¾ï¼Œä¹Ÿå¯ä»¥ä»ç»“å°¾å¾€å‰æ‰¾ï¼Œå…·ä½“æœé‚£ä¸ªæ–¹å‘æ‰¾å–å†³äºæ¡ä»¶ <code>index &lt; (size &gt;&gt; 1)</code>ï¼Œä¹Ÿå³æ˜¯ index æ˜¯é è¿‘å‰ç«¯è¿˜æ˜¯åç«¯ã€‚</p> <h4 id="_3-remove"><a href="#_3-remove" aria-hidden="true" class="header-anchor">#</a> 3. remove()</h4> <p>remove() æ–¹æ³•ä¹Ÿæœ‰ä¸¤ä¸ªç‰ˆæœ¬ï¼Œä¸€ä¸ªæ˜¯åˆ é™¤è·ŸæŒ‡å®šå…ƒç´ ç›¸ç­‰çš„ç¬¬ä¸€ä¸ªå…ƒç´  <code>remove(Object o)</code>ï¼Œå¦ä¸€ä¸ªæ˜¯åˆ é™¤æŒ‡å®šä¸‹æ ‡å¤„çš„å…ƒç´  <code>remove(int index)</code>ã€‚</p> <div align="center"><img src="/fullstack-tutorial-site/assets/img/LinkedList_remove.fa1fb1de.png" width="600"></div> <p>ä¸¤ä¸ªåˆ é™¤æ“ä½œéƒ½è¦ï¼š</p> <ol><li>å…ˆæ‰¾åˆ°è¦åˆ é™¤å…ƒç´ çš„å¼•ç”¨ï¼›</li> <li>ä¿®æ”¹ç›¸å…³å¼•ç”¨ï¼Œå®Œæˆåˆ é™¤æ“ä½œã€‚</li></ol> <p>åœ¨å¯»æ‰¾è¢«åˆ å…ƒç´ å¼•ç”¨çš„æ—¶å€™ <code>remove(Object o)</code> è°ƒç”¨çš„æ˜¯å…ƒç´ çš„ equals æ–¹æ³•ï¼Œè€Œ <code>remove(int index)</code> ä½¿ç”¨çš„æ˜¯ä¸‹æ ‡è®¡æ•°ï¼Œä¸¤ç§æ–¹å¼éƒ½æ˜¯çº¿æ€§æ—¶é—´å¤æ‚åº¦ã€‚åœ¨æ­¥éª¤ 2 ä¸­ï¼Œä¸¤ä¸ª <code>revome()</code> æ–¹æ³•éƒ½æ˜¯é€šè¿‡ <code>unlink(Node&lt;E&gt; x)</code> æ–¹æ³•å®Œæˆçš„ã€‚è¿™é‡Œéœ€è¦è€ƒè™‘åˆ é™¤å…ƒç´ æ˜¯ç¬¬ä¸€ä¸ªæˆ–è€…æœ€åä¸€ä¸ªæ—¶çš„è¾¹ç•Œæƒ…å†µã€‚</p> <h4 id="_4-get"><a href="#_4-get" aria-hidden="true" class="header-anchor">#</a> 4. get()</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> E <span class="token function">get</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">checkElementIndex</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token function">node</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">.</span>item<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
    
Node<span class="token generics function"><span class="token punctuation">&lt;</span>E<span class="token punctuation">&gt;</span></span> <span class="token function">node</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// assert isElementIndex(index);</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">&lt;</span> <span class="token punctuation">(</span>size <span class="token operator">&gt;&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        Node<span class="token generics function"><span class="token punctuation">&lt;</span>E<span class="token punctuation">&gt;</span></span> x <span class="token operator">=</span> first<span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> index<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
            x <span class="token operator">=</span> x<span class="token punctuation">.</span>next<span class="token punctuation">;</span>
        <span class="token keyword">return</span> x<span class="token punctuation">;</span>
	<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        Node<span class="token generics function"><span class="token punctuation">&lt;</span>E<span class="token punctuation">&gt;</span></span> x <span class="token operator">=</span> last<span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> size <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&gt;</span> index<span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span>
            x <span class="token operator">=</span> x<span class="token punctuation">.</span>prev<span class="token punctuation">;</span>
        <span class="token keyword">return</span> x<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ç”±æ­¤å¯ä»¥çœ‹å‡ºæ˜¯ä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾æ¥çœ‹ <code>index</code> ç¦» size ä¸­é—´è·ç¦»æ¥åˆ¤æ–­æ˜¯ä»å¤´ç»“ç‚¹æ­£åºæŸ¥è¿˜æ˜¯ä»å°¾èŠ‚ç‚¹å€’åºæŸ¥ã€‚</p> <ul><li>node() ä¼šä»¥ <code>O(n/2)</code> çš„æ€§èƒ½å»è·å–ä¸€ä¸ªç»“ç‚¹
<ul><li>å¦‚æœç´¢å¼•å€¼å¤§äºé“¾è¡¨å¤§å°çš„ä¸€åŠï¼Œé‚£ä¹ˆå°†ä»å°¾ç»“ç‚¹å¼€å§‹éå†</li></ul></li></ul> <p>è¿™æ ·çš„æ•ˆç‡æ˜¯éå¸¸ä½çš„ï¼Œç‰¹åˆ«æ˜¯å½“ index è¶Šæ¥è¿‘ size çš„ä¸­é—´å€¼æ—¶ã€‚</p> <h4 id="_5-æ€»ç»“"><a href="#_5-æ€»ç»“" aria-hidden="true" class="header-anchor">#</a> 5. æ€»ç»“</h4> <ul><li>LinkedList æ’å…¥ï¼Œåˆ é™¤éƒ½æ˜¯ç§»åŠ¨æŒ‡é’ˆæ•ˆç‡å¾ˆé«˜ã€‚</li> <li>æŸ¥æ‰¾éœ€è¦è¿›è¡Œéå†æŸ¥è¯¢ï¼Œæ•ˆç‡è¾ƒä½ã€‚</li></ul> <h4 id="_6-arraylist-ä¸-linkedlist"><a href="#_6-arraylist-ä¸-linkedlist" aria-hidden="true" class="header-anchor">#</a> 6. ArrayList ä¸ LinkedList</h4> <ul><li>ArrayList åŸºäºåŠ¨æ€æ•°ç»„å®ç°ï¼ŒLinkedList åŸºäºåŒå‘é“¾è¡¨å®ç°ï¼›</li> <li>ArrayList æ”¯æŒéšæœºè®¿é—®ï¼ŒLinkedList ä¸æ”¯æŒï¼›</li> <li>LinkedList åœ¨ä»»æ„ä½ç½®æ·»åŠ åˆ é™¤å…ƒç´ æ›´å¿«ã€‚</li></ul> <h3 id="hashmap"><a href="#hashmap" aria-hidden="true" class="header-anchor">#</a> HashMap</h3> <p>æˆ‘ä»¬è¿™ç¯‡æ–‡ç« å°±æ¥è¯•ç€åˆ†æä¸‹ HashMap çš„æºç ï¼Œç”±äº HashMap åº•å±‚æ¶‰åŠåˆ°å¤ªå¤šæ–¹é¢ï¼Œä¸€ç¯‡æ–‡ç« æ€»æ˜¯ä¸èƒ½é¢é¢ä¿±åˆ°ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¸¦ç€é¢è¯•å®˜å¸¸é—®çš„å‡ ä¸ªé—®é¢˜å»çœ‹æºç ï¼š</p> <ol><li>äº†è§£åº•å±‚å¦‚ä½•å­˜å‚¨æ•°æ®çš„</li> <li>HashMap çš„å‡ ä¸ªä¸»è¦æ–¹æ³•</li> <li>HashMap æ˜¯å¦‚ä½•ç¡®å®šå…ƒç´ å­˜å‚¨ä½ç½®çš„ä»¥åŠå¦‚ä½•å¤„ç†å“ˆå¸Œå†²çªçš„</li> <li>HashMap æ‰©å®¹æœºåˆ¶æ˜¯æ€æ ·çš„</li> <li>JDK 1.8 åœ¨æ‰©å®¹å’Œè§£å†³å“ˆå¸Œå†²çªä¸Šå¯¹ HashMap æºç åšäº†å“ªäº›æ”¹åŠ¨ï¼Ÿæœ‰ä»€ä¹ˆå¥½å¤„?</li></ol> <p>HashMap çš„å†…éƒ¨åŠŸèƒ½å®ç°å¾ˆå¤šï¼Œæœ¬æ–‡ä¸»è¦ä»æ ¹æ® key è·å–å“ˆå¸Œæ¡¶æ•°ç»„ç´¢å¼•ä½ç½®ã€put æ–¹æ³•çš„è¯¦ç»†æ‰§è¡Œã€æ‰©å®¹è¿‡ç¨‹ä¸‰ä¸ªå…·æœ‰ä»£è¡¨æ€§çš„ç‚¹æ·±å…¥å±•å¼€è®²è§£ã€‚</p> <h4 id="_1-å­˜å‚¨ç»“æ„"><a href="#_1-å­˜å‚¨ç»“æ„" aria-hidden="true" class="header-anchor">#</a> 1. å­˜å‚¨ç»“æ„</h4> <h5 id="jdk1-7-çš„å­˜å‚¨ç»“æ„"><a href="#jdk1-7-çš„å­˜å‚¨ç»“æ„" aria-hidden="true" class="header-anchor">#</a> JDK1.7 çš„å­˜å‚¨ç»“æ„</h5> <p>åœ¨ 1.7 ä¹‹å‰ JDK é‡‡ç”¨ã€Œæ‹‰é“¾æ³•ã€æ¥å­˜å‚¨æ•°æ®ï¼Œå³æ•°ç»„å’Œé“¾è¡¨ç»“åˆçš„æ–¹å¼ï¼š</p> <div align="center"><img src="/fullstack-tutorial-site/assets/img/hashmap-link.94bcf21d.jpg" width="550"></div> <p>ã€Œæ‹‰é“¾æ³•ã€ç”¨ä¸“ä¸šç‚¹çš„åè¯æ¥è¯´å«åš<strong>é“¾åœ°å€æ³•</strong>ã€‚ç®€å•æ¥è¯´ï¼Œå°±æ˜¯æ•°ç»„åŠ é“¾è¡¨çš„ç»“åˆã€‚åœ¨æ¯ä¸ªæ•°ç»„å…ƒç´ ä¸Šå­˜å‚¨çš„éƒ½æ˜¯ä¸€ä¸ªé“¾è¡¨ã€‚</p> <p>æˆ‘ä»¬ä¹‹å‰è¯´åˆ°ä¸åŒçš„ key å¯èƒ½ç»è¿‡ hash è¿ç®—å¯èƒ½ä¼šå¾—åˆ°ç›¸åŒçš„åœ°å€ï¼Œä½†æ˜¯ä¸€ä¸ªæ•°ç»„å•ä½ä¸Šåªèƒ½å­˜æ”¾ä¸€ä¸ªå…ƒç´ ï¼Œé‡‡ç”¨é“¾åœ°å€æ³•ä»¥åï¼Œå¦‚æœé‡åˆ°ç›¸åŒçš„ hash å€¼çš„ key çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥å°†å®ƒæ”¾åˆ°ä½œä¸ºæ•°ç»„å…ƒç´ çš„é“¾è¡¨ä¸Šã€‚å¾…æˆ‘ä»¬å»å–å…ƒç´ çš„æ—¶å€™é€šè¿‡ hash è¿ç®—çš„ç»“æœæ‰¾åˆ°è¿™ä¸ªé“¾è¡¨ï¼Œå†åœ¨é“¾è¡¨ä¸­æ‰¾åˆ°ä¸ key ç›¸åŒçš„èŠ‚ç‚¹ï¼Œå°±èƒ½æ‰¾åˆ° key ç›¸åº”çš„å€¼äº†ã€‚</p> <p>JDK1.7 ä¸­æ–°æ·»åŠ è¿›æ¥çš„å…ƒç´ æ€»æ˜¯æ”¾åœ¨æ•°ç»„ç›¸åº”çš„è§’æ ‡ä½ç½®ï¼Œè€ŒåŸæ¥å¤„äºè¯¥è§’æ ‡çš„ä½ç½®çš„èŠ‚ç‚¹ä½œä¸º next èŠ‚ç‚¹æ”¾åˆ°æ–°èŠ‚ç‚¹çš„åè¾¹ã€‚ç¨åé€šè¿‡æºç åˆ†ææˆ‘ä»¬ä¹Ÿèƒ½çœ‹åˆ°è¿™ä¸€ç‚¹ã€‚</p> <h5 id="jdk1-8-çš„å­˜å‚¨ç»“æ„"><a href="#jdk1-8-çš„å­˜å‚¨ç»“æ„" aria-hidden="true" class="header-anchor">#</a> JDK1.8 çš„å­˜å‚¨ç»“æ„</h5> <p>å¯¹äº JDK1.8 ä¹‹åçš„ <code>HashMap</code> åº•å±‚åœ¨è§£å†³å“ˆå¸Œå†²çªçš„æ—¶å€™ï¼Œå°±ä¸å•å•æ˜¯ä½¿ç”¨æ•°ç»„åŠ ä¸Šå•é“¾è¡¨çš„ç»„åˆäº†ï¼Œå› ä¸ºå½“å¤„ç†å¦‚æœ hash å€¼å†²çªè¾ƒå¤šçš„æƒ…å†µä¸‹ï¼Œé“¾è¡¨çš„é•¿åº¦å°±ä¼šè¶Šæ¥è¶Šé•¿ï¼Œæ­¤æ—¶é€šè¿‡å•é“¾è¡¨æ¥å¯»æ‰¾å¯¹åº” Key å¯¹åº”çš„ Value çš„æ—¶å€™å°±ä¼šä½¿å¾—æ—¶é—´å¤æ‚åº¦è¾¾åˆ° O(n)ï¼Œå› æ­¤åœ¨ JDK1.8 ä¹‹åï¼Œåœ¨é“¾è¡¨æ–°å¢èŠ‚ç‚¹å¯¼è‡´é“¾è¡¨é•¿åº¦è¶…è¿‡ <code>TREEIFY_THRESHOLD = 8</code>  çš„æ—¶å€™ï¼Œå°±ä¼šåœ¨æ·»åŠ å…ƒç´ çš„åŒæ—¶å°†åŸæ¥çš„å•é“¾è¡¨è½¬åŒ–ä¸ºçº¢é»‘æ ‘ã€‚</p> <p>å¯¹æ•°æ®ç»“æ„å¾ˆåœ¨è¡Œçš„è¯»è€…åº”è¯¥ï¼ŒçŸ¥é“çº¢é»‘æ ‘æ˜¯ä¸€ç§æ˜“äºå¢åˆ æ”¹æŸ¥çš„äºŒå‰æ ‘ï¼Œä»–å¯¹ä¸æ•°æ®çš„æŸ¥è¯¢çš„æ—¶é—´å¤æ‚åº¦æ˜¯ <code>O(logn)</code> çº§åˆ«ï¼Œæ‰€ä»¥åˆ©ç”¨çº¢é»‘æ ‘çš„ç‰¹ç‚¹å°±å¯ä»¥æ›´é«˜æ•ˆçš„å¯¹ <code>HashMap</code> ä¸­çš„å…ƒç´ è¿›è¡Œæ“ä½œã€‚</p> <div align="center"><img src="/fullstack-tutorial-site/assets/img/hashmap-rb-link.472742e0.jpg" width="550"></div><br> <p>ä»ç»“æ„å®ç°æ¥è®²ï¼ŒHashMap æ˜¯æ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘ï¼ˆJDK1.8å¢åŠ äº†çº¢é»‘æ ‘éƒ¨åˆ†ï¼‰å®ç°çš„ï¼Œå¦‚ä¸‹å¦‚æ‰€ç¤ºã€‚</p> <div align="center"><img src="/fullstack-tutorial-site/assets/img/hashMap-datastruct.8db4a3bd.png" width="400"></div> <p><strong>è¿™é‡Œéœ€è¦è®²æ˜ç™½ä¸¤ä¸ªé—®é¢˜ï¼šæ•°æ®åº•å±‚å…·ä½“å­˜å‚¨çš„æ˜¯ä»€ä¹ˆï¼Ÿè¿™æ ·çš„å­˜å‚¨æ–¹å¼æœ‰ä»€ä¹ˆä¼˜ç‚¹å‘¢ï¼Ÿ</strong></p> <p>ï¼ˆ1ï¼‰ä»æºç å¯çŸ¥ï¼ŒHashMap ç±»ä¸­æœ‰ä¸€ä¸ªéå¸¸é‡è¦çš„å­—æ®µï¼Œå°±æ˜¯ Node[] tableï¼Œå³å“ˆå¸Œæ¡¶æ•°ç»„ï¼Œæ˜æ˜¾å®ƒæ˜¯ä¸€ä¸ª Node çš„æ•°ç»„ã€‚æˆ‘ä»¬æ¥çœ‹ Nodeï¼ˆ JDK1.8 ä¸­ï¼‰ æ˜¯ä½•ç‰©ã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Node</span><span class="token generics function"><span class="token punctuation">&lt;</span>K<span class="token punctuation">,</span>V<span class="token punctuation">&gt;</span></span> <span class="token keyword">implements</span> <span class="token class-name">Map<span class="token punctuation">.</span>Entry</span><span class="token generics function"><span class="token punctuation">&lt;</span>K<span class="token punctuation">,</span>V<span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token keyword">final</span> <span class="token keyword">int</span> hash<span class="token punctuation">;</span>    <span class="token comment">//ç”¨æ¥å®šä½æ•°ç»„ç´¢å¼•ä½ç½®</span>
    <span class="token keyword">final</span> K key<span class="token punctuation">;</span>
    V value<span class="token punctuation">;</span>
    Node<span class="token generics function"><span class="token punctuation">&lt;</span>K<span class="token punctuation">,</span>V<span class="token punctuation">&gt;</span></span> next<span class="token punctuation">;</span>   <span class="token comment">//é“¾è¡¨çš„ä¸‹ä¸€ä¸ªnode</span>

    <span class="token function">Node</span><span class="token punctuation">(</span><span class="token keyword">int</span> hash<span class="token punctuation">,</span> K key<span class="token punctuation">,</span> V value<span class="token punctuation">,</span> Node<span class="token generics function"><span class="token punctuation">&lt;</span>K<span class="token punctuation">,</span>V<span class="token punctuation">&gt;</span></span> next<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">final</span> K <span class="token function">getKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">final</span> V <span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">final</span> String <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">final</span> V <span class="token function">setValue</span><span class="token punctuation">(</span>V newValue<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">boolean</span> <span class="token function">equals</span><span class="token punctuation">(</span>Object o<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Node æ˜¯ HashMap çš„ä¸€ä¸ªå†…éƒ¨ç±»ï¼Œå®ç°äº† Map.Entry æ¥å£ï¼Œæœ¬è´¨æ˜¯å°±æ˜¯ä¸€ä¸ªæ˜ å°„ï¼ˆé”®å€¼å¯¹ï¼‰ã€‚ä¸Šå›¾ä¸­çš„æ¯ä¸ªé»‘è‰²åœ†ç‚¹å°±æ˜¯ä¸€ä¸ªNodeå¯¹è±¡ã€‚</p> <p>ï¼ˆ2ï¼‰HashMap å°±æ˜¯ä½¿ç”¨å“ˆå¸Œè¡¨æ¥å­˜å‚¨çš„ã€‚å“ˆå¸Œè¡¨ä¸ºè§£å†³å†²çªï¼Œå¯ä»¥é‡‡ç”¨<strong>å¼€æ”¾åœ°å€æ³•</strong>å’Œ<strong>é“¾åœ°å€æ³•</strong>ç­‰æ¥è§£å†³é—®é¢˜ï¼Œ Java ä¸­ HashMap é‡‡ç”¨äº†é“¾åœ°å€æ³•ã€‚é“¾åœ°å€æ³•ï¼Œç®€å•æ¥è¯´ï¼Œå°±æ˜¯æ•°ç»„åŠ é“¾è¡¨çš„ç»“åˆã€‚åœ¨æ¯ä¸ªæ•°ç»„å…ƒç´ ä¸Šéƒ½ä¸€ä¸ªé“¾è¡¨ç»“æ„ï¼Œå½“æ•°æ®è¢« Hash åï¼Œå¾—åˆ°æ•°ç»„ä¸‹æ ‡ï¼ŒæŠŠæ•°æ®æ”¾åœ¨å¯¹åº”ä¸‹æ ‡å…ƒç´ çš„é“¾è¡¨ä¸Šã€‚ä¾‹å¦‚ç¨‹åºæ‰§è¡Œä¸‹é¢ä»£ç ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code>map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;ç¾å›¢&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;å°ç¾&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>ç³»ç»Ÿå°†è°ƒç”¨ &quot;ç¾å›¢&quot; è¿™ä¸ª key çš„ hashCode() æ–¹æ³•å¾—åˆ°å…¶ hashCode å€¼ï¼ˆè¯¥æ–¹æ³•é€‚ç”¨äºæ¯ä¸ª Java å¯¹è±¡ï¼‰ï¼Œç„¶åå†é€šè¿‡ Hash ç®—æ³•çš„åä¸¤æ­¥è¿ç®—ï¼ˆé«˜ä½è¿ç®—å’Œå–æ¨¡è¿ç®—ï¼Œä¸‹æ–‡æœ‰ä»‹ç»ï¼‰æ¥å®šä½è¯¥é”®å€¼å¯¹çš„å­˜å‚¨ä½ç½®ï¼Œæœ‰æ—¶ä¸¤ä¸ª key ä¼šå®šä½åˆ°ç›¸åŒçš„ä½ç½®ï¼Œè¡¨ç¤ºå‘ç”Ÿäº† Hash ç¢°æ’ã€‚å½“ç„¶ Hash ç®—æ³•è®¡ç®—ç»“æœè¶Šåˆ†æ•£å‡åŒ€ï¼ŒHash ç¢°æ’çš„æ¦‚ç‡å°±è¶Šå°ï¼Œmap çš„å­˜å–æ•ˆç‡å°±ä¼šè¶Šé«˜ã€‚</p> <p>å¦‚æœå“ˆå¸Œæ¡¶æ•°ç»„å¾ˆå¤§ï¼Œå³ä½¿è¾ƒå·®çš„ Hash ç®—æ³•ä¹Ÿä¼šæ¯”è¾ƒåˆ†æ•£ï¼Œå¦‚æœå“ˆå¸Œæ¡¶æ•°ç»„æ•°ç»„å¾ˆå°ï¼Œå³ä½¿å¥½çš„ Hash ç®—æ³•ä¹Ÿä¼šå‡ºç°è¾ƒå¤šç¢°æ’ï¼Œæ‰€ä»¥å°±éœ€è¦åœ¨ç©ºé—´æˆæœ¬å’Œæ—¶é—´æˆæœ¬ä¹‹é—´æƒè¡¡ï¼Œå…¶å®å°±æ˜¯åœ¨æ ¹æ®å®é™…æƒ…å†µç¡®å®šå“ˆå¸Œæ¡¶æ•°ç»„çš„å¤§å°ï¼Œå¹¶åœ¨æ­¤åŸºç¡€ä¸Šè®¾è®¡å¥½çš„ hash ç®—æ³•å‡å°‘ Hash ç¢°æ’ã€‚</p> <p><strong>é‚£ä¹ˆé€šè¿‡ä»€ä¹ˆæ–¹å¼æ¥æ§åˆ¶ map ä½¿å¾— Hash ç¢°æ’çš„æ¦‚ç‡åˆå°ï¼Œå“ˆå¸Œæ¡¶æ•°ç»„ï¼ˆNode[] tableï¼‰å ç”¨ç©ºé—´åˆå°‘å‘¢ï¼Ÿ</strong></p> <p>ç­”æ¡ˆå°±æ˜¯å¥½çš„ Hash ç®—æ³•å’Œæ‰©å®¹æœºåˆ¶ã€‚</p> <p>åœ¨ç†è§£ Hash å’Œæ‰©å®¹æµç¨‹ä¹‹å‰ï¼Œæˆ‘ä»¬å¾—å…ˆäº†è§£ä¸‹ HashMap çš„å‡ ä¸ªå­—æ®µã€‚ä» HashMap çš„é»˜è®¤æ„é€ å‡½æ•°æºç å¯çŸ¥ï¼Œæ„é€ å‡½æ•°å°±æ˜¯å¯¹ä¸‹é¢å‡ ä¸ªå­—æ®µè¿›è¡Œåˆå§‹åŒ–ï¼Œæºç å¦‚ä¸‹ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">int</span> threshold<span class="token punctuation">;</span>             <span class="token comment">// æ‰€èƒ½å®¹çº³çš„key-valueå¯¹æé™ </span>
<span class="token keyword">final</span> <span class="token keyword">float</span> loadFactor<span class="token punctuation">;</span>    <span class="token comment">// è´Ÿè½½å› å­</span>
<span class="token keyword">int</span> modCount<span class="token punctuation">;</span>  
<span class="token keyword">int</span> size<span class="token punctuation">;</span>
</code></pre></div><p>é¦–å…ˆï¼Œ<strong>Node[] tableçš„åˆå§‹åŒ–é•¿åº¦ length (é»˜è®¤å€¼æ˜¯16)</strong>ï¼Œ<strong>Load factor ä¸ºè´Ÿè½½å› å­(é»˜è®¤å€¼æ˜¯0.75)</strong>ï¼Œthreshold æ˜¯ HashMap æ‰€èƒ½å®¹çº³çš„æœ€å¤§æ•°æ®é‡çš„ Node (é”®å€¼å¯¹)ä¸ªæ•°ã€‚<strong>threshold = length * Load factor</strong>ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨æ•°ç»„å®šä¹‰å¥½é•¿åº¦ä¹‹åï¼Œè´Ÿè½½å› å­è¶Šå¤§ï¼Œæ‰€èƒ½å®¹çº³çš„é”®å€¼å¯¹ä¸ªæ•°è¶Šå¤šã€‚</p> <p>ç»“åˆè´Ÿè½½å› å­çš„å®šä¹‰å…¬å¼å¯çŸ¥ï¼Œthreshold å°±æ˜¯åœ¨æ­¤ Load factor å’Œ length (æ•°ç»„é•¿åº¦)å¯¹åº”ä¸‹å…è®¸çš„æœ€å¤§å…ƒç´ æ•°ç›®ï¼Œè¶…è¿‡è¿™ä¸ªæ•°ç›®å°±é‡æ–° resize(æ‰©å®¹)ï¼Œæ‰©å®¹åçš„ HashMap å®¹é‡æ˜¯ä¹‹å‰å®¹é‡çš„ä¸¤å€ã€‚é»˜è®¤çš„è´Ÿè½½å› å­ 0.75 æ˜¯å¯¹ç©ºé—´å’Œæ—¶é—´æ•ˆç‡çš„ä¸€ä¸ªå¹³è¡¡é€‰æ‹©ï¼Œå»ºè®®å¤§å®¶ä¸è¦ä¿®æ”¹ï¼Œé™¤éåœ¨æ—¶é—´å’Œç©ºé—´æ¯”è¾ƒç‰¹æ®Šçš„æƒ…å†µä¸‹ï¼Œå¦‚æœå†…å­˜ç©ºé—´å¾ˆå¤šè€Œåˆå¯¹æ—¶é—´æ•ˆç‡è¦æ±‚å¾ˆé«˜ï¼Œå¯ä»¥é™ä½è´Ÿè½½å› å­ Load factor çš„å€¼ï¼›ç›¸åï¼Œå¦‚æœå†…å­˜ç©ºé—´ç´§å¼ è€Œå¯¹æ—¶é—´æ•ˆç‡è¦æ±‚ä¸é«˜ï¼Œå¯ä»¥å¢åŠ è´Ÿè½½å› å­ loadFactor çš„å€¼ï¼Œè¿™ä¸ªå€¼å¯ä»¥å¤§äº1ã€‚</p> <p>size è¿™ä¸ªå­—æ®µå…¶å®å¾ˆå¥½ç†è§£ï¼Œå°±æ˜¯ HashMap ä¸­å®é™…å­˜åœ¨çš„é”®å€¼å¯¹æ•°é‡ã€‚æ³¨æ„å’Œ table çš„é•¿åº¦ lengthã€å®¹çº³æœ€å¤§é”®å€¼å¯¹æ•°é‡ threshold çš„åŒºåˆ«ã€‚è€Œ modCount å­—æ®µä¸»è¦ç”¨æ¥è®°å½• HashMap å†…éƒ¨ç»“æ„å‘ç”Ÿå˜åŒ–çš„æ¬¡æ•°ï¼Œä¸»è¦ç”¨äºè¿­ä»£çš„å¿«é€Ÿå¤±è´¥ã€‚å¼ºè°ƒä¸€ç‚¹ï¼Œå†…éƒ¨ç»“æ„å‘ç”Ÿå˜åŒ–æŒ‡çš„æ˜¯ç»“æ„å‘ç”Ÿå˜åŒ–ï¼Œä¾‹å¦‚ put æ–°é”®å€¼å¯¹ï¼Œä½†æ˜¯æŸä¸ª key å¯¹åº”çš„ value å€¼è¢«è¦†ç›–ä¸å±äºç»“æ„å˜åŒ–ã€‚</p> <p>åœ¨ HashMap ä¸­ï¼Œå“ˆå¸Œæ¡¶æ•°ç»„ table çš„é•¿åº¦ length å¤§å°å¿…é¡»ä¸º 2<sup>n</sup>ï¼ˆä¸€å®šæ˜¯åˆæ•°ï¼‰ï¼Œè¿™æ˜¯ä¸€ç§éå¸¸è§„çš„è®¾è®¡ï¼Œå¸¸è§„çš„è®¾è®¡æ˜¯æŠŠæ¡¶çš„å¤§å°è®¾è®¡ä¸ºç´ æ•°ã€‚ç›¸å¯¹æ¥è¯´ç´ æ•°å¯¼è‡´å†²çªçš„æ¦‚ç‡è¦å°äºåˆæ•°ï¼Œå…·ä½“è¯æ˜å¯ä»¥å‚è€ƒ <a href="https://blog.csdn.net/liuqiyao_01/article/details/14475159" target="_blank" rel="noopener noreferrer">ä¸ºä»€ä¹ˆä¸€èˆ¬hashtableçš„æ¡¶æ•°ä¼šå–ä¸€ä¸ªç´ æ•°ï¼Ÿ<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> ï¼Œ<strong>Hashtable åˆå§‹åŒ–æ¡¶å¤§å°ä¸º 11ï¼Œå°±æ˜¯æ¡¶å¤§å°è®¾è®¡ä¸ºç´ æ•°çš„åº”ç”¨ï¼ˆHashtable æ‰©å®¹åä¸èƒ½ä¿è¯è¿˜æ˜¯ç´ æ•°ï¼‰</strong>ã€‚HashMap é‡‡ç”¨è¿™ç§éå¸¸è§„è®¾è®¡ï¼Œ<strong>ä¸»è¦æ˜¯ä¸ºäº†åœ¨å–æ¨¡å’Œæ‰©å®¹æ—¶åšä¼˜åŒ–ï¼ŒåŒæ—¶ä¸ºäº†å‡å°‘å†²çªï¼ŒHashMap å®šä½å“ˆå¸Œæ¡¶ç´¢å¼•ä½ç½®æ—¶ï¼Œä¹ŸåŠ å…¥äº†é«˜ä½å‚ä¸è¿ç®—çš„è¿‡ç¨‹</strong>ã€‚</p> <p>è¿™é‡Œå­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå³ä½¿è´Ÿè½½å› å­å’Œ Hash ç®—æ³•è®¾è®¡çš„å†åˆç†ï¼Œä¹Ÿå…ä¸äº†ä¼šå‡ºç°æ‹‰é“¾è¿‡é•¿çš„æƒ…å†µï¼Œä¸€æ—¦å‡ºç°æ‹‰é“¾è¿‡é•¿ï¼Œåˆ™ä¼šä¸¥é‡å½±å“ HashMap çš„æ€§èƒ½ã€‚äºæ˜¯ï¼Œåœ¨ JDK1.8 ç‰ˆæœ¬ä¸­ï¼Œå¯¹æ•°æ®ç»“æ„åšäº†è¿›ä¸€æ­¥çš„ä¼˜åŒ–ï¼Œå¼•å…¥äº†çº¢é»‘æ ‘ã€‚è€Œå½“é“¾è¡¨é•¿åº¦å¤ªé•¿ï¼ˆé»˜è®¤è¶…è¿‡8ï¼‰æ—¶ï¼Œé“¾è¡¨å°±è½¬æ¢ä¸ºçº¢é»‘æ ‘ï¼Œåˆ©ç”¨çº¢é»‘æ ‘å¿«é€Ÿå¢åˆ æ”¹æŸ¥çš„ç‰¹ç‚¹æé«˜ HashMap çš„æ€§èƒ½ï¼Œå…¶ä¸­ä¼šç”¨åˆ°çº¢é»‘æ ‘çš„æ’å…¥ã€åˆ é™¤ã€æŸ¥æ‰¾ç­‰ç®—æ³•ã€‚æœ¬æ–‡ä¸å†å¯¹çº¢é»‘æ ‘å±•å¼€è®¨è®ºï¼Œæƒ³äº†è§£æ›´å¤šçº¢é»‘æ ‘æ•°æ®ç»“æ„çš„å·¥ä½œåŸç†å¯ä»¥å‚è€ƒï¼š<a href="https://blog.csdn.net/v_july_v/article/details/6105630" target="_blank" rel="noopener noreferrer">æ•™ä½ åˆæ­¥äº†è§£çº¢é»‘æ ‘<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ã€‚</p> <h4 id="_2-é‡è¦å‚æ•°"><a href="#_2-é‡è¦å‚æ•°" aria-hidden="true" class="header-anchor">#</a> 2. é‡è¦å‚æ•°</h4> <table><thead><tr><th>å‚æ•°</th> <th>è¯´æ˜</th></tr></thead> <tbody><tr><td>buckets</td> <td>åœ¨ HashMap çš„æ³¨é‡Šé‡Œä½¿ç”¨å“ˆå¸Œæ¡¶æ¥å½¢è±¡çš„è¡¨ç¤ºæ•°ç»„ä¸­æ¯ä¸ªåœ°å€ä½ç½®ã€‚æ³¨æ„è¿™é‡Œå¹¶ä¸æ˜¯æ•°ç»„æœ¬èº«ï¼Œæ•°ç»„æ˜¯è£…å“ˆå¸Œæ¡¶çš„ï¼Œä»–å¯ä»¥è¢«ç§°ä¸º<strong>å“ˆå¸Œè¡¨</strong>ã€‚</td></tr> <tr><td>capacity</td> <td>table çš„å®¹é‡å¤§å°ï¼Œé»˜è®¤ä¸º 16ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ capacity å¿…é¡»ä¿è¯ä¸º 2 çš„ n æ¬¡æ–¹ã€‚</td></tr> <tr><td>size</td> <td>table çš„å®é™…ä½¿ç”¨é‡ã€‚</td></tr> <tr><td>threshold</td> <td>size çš„ä¸´ç•Œå€¼ï¼Œsize å¿…é¡»å°äº thresholdï¼Œå¦‚æœå¤§äºç­‰äºï¼Œå°±å¿…é¡»è¿›è¡Œæ‰©å®¹æ“ä½œã€‚</td></tr> <tr><td>loadFactor</td> <td>è£…è½½å› å­ï¼Œtable èƒ½å¤Ÿä½¿ç”¨çš„æ¯”ä¾‹ï¼Œthreshold = capacity * loadFactorã€‚</td></tr> <tr><td>TREEIFY_THRESHOLD</td> <td>æ ‘åŒ–é˜€å€¼ï¼Œå“ˆå¸Œæ¡¶ä¸­çš„èŠ‚ç‚¹ä¸ªæ•°å¤§äºè¯¥å€¼ï¼ˆé»˜è®¤ä¸º8ï¼‰çš„æ—¶å€™å°†ä¼šè¢«è½¬ä¸ºçº¢é»‘æ ‘è¡Œå­˜å‚¨ç»“æ„ã€‚</td></tr> <tr><td>UNTREEIFY_THRESHOLD</td> <td>éæ ‘åŒ–é˜€å€¼ï¼Œå°äºè¯¥å€¼ï¼ˆé»˜è®¤ä¸º 6ï¼‰çš„æ—¶å€™å°†å†æ¬¡æ”¹ä¸ºå•é“¾è¡¨çš„æ ¼å¼å­˜å‚¨</td></tr></tbody></table> <h4 id="_3-ç¡®å®šå“ˆå¸Œæ¡¶æ•°ç»„ç´¢å¼•ä½ç½®"><a href="#_3-ç¡®å®šå“ˆå¸Œæ¡¶æ•°ç»„ç´¢å¼•ä½ç½®" aria-hidden="true" class="header-anchor">#</a> 3. ç¡®å®šå“ˆå¸Œæ¡¶æ•°ç»„ç´¢å¼•ä½ç½®</h4> <p>å¾ˆå¤šæ“ä½œéƒ½éœ€è¦å…ˆç¡®å®šä¸€ä¸ªé”®å€¼å¯¹æ‰€åœ¨çš„æ¡¶ä¸‹æ ‡ã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">int</span> hash <span class="token operator">=</span> <span class="token function">hash</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token function">indexFor</span><span class="token punctuation">(</span>hash<span class="token punctuation">,</span> table<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>ï¼ˆä¸€ï¼‰è®¡ç®— hash å€¼</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token function">hash</span><span class="token punctuation">(</span>Object k<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> h <span class="token operator">=</span> hashSeed<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">!=</span> h <span class="token operator">&amp;&amp;</span> k <span class="token keyword">instanceof</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> sun<span class="token punctuation">.</span>misc<span class="token punctuation">.</span>Hashing<span class="token punctuation">.</span><span class="token function">stringHash32</span><span class="token punctuation">(</span><span class="token punctuation">(</span>String<span class="token punctuation">)</span> k<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    h <span class="token operator">^=</span> k<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// This function ensures that hashCodes that differ only by</span>
    <span class="token comment">// constant multiples at each bit position have a bounded</span>
    <span class="token comment">// number of collisions (approximately 8 at default load factor).</span>
    h <span class="token operator">^=</span> <span class="token punctuation">(</span>h <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>h <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> h <span class="token operator">^</span> <span class="token punctuation">(</span>h <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">7</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>h <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> Objects<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">^</span> Objects<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ï¼ˆäºŒï¼‰å–æ¨¡</p> <p>ä»¤ x = 1&lt;&lt;4ï¼Œå³ x ä¸º 2 çš„ 4 æ¬¡æ–¹ï¼Œå®ƒå…·æœ‰ä»¥ä¸‹æ€§è´¨ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>x   : 00010000
x-1 : 00001111
</code></pre></div><p>ä»¤ä¸€ä¸ªæ•° y ä¸ x-1 åšä¸è¿ç®—ï¼Œå¯ä»¥å»é™¤ y ä½çº§è¡¨ç¤ºçš„ç¬¬ 4 ä½ä»¥ä¸Šæ•°ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>y       : 10110010
x-1     : 00001111
y&amp;(x-1) : 00000010
</code></pre></div><p>è¿™ä¸ªæ€§è´¨å’Œ y å¯¹ x å–æ¨¡æ•ˆæœæ˜¯ä¸€æ ·çš„ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>y   : 10110010
x   : 00010000
y%x : 00000010
</code></pre></div><p>æˆ‘ä»¬çŸ¥é“ï¼Œä½è¿ç®—çš„ä»£ä»·æ¯”æ±‚æ¨¡è¿ç®—å°çš„å¤šï¼Œå› æ­¤åœ¨è¿›è¡Œè¿™ç§è®¡ç®—æ—¶ç”¨ä½è¿ç®—çš„è¯èƒ½å¸¦æ¥æ›´é«˜çš„æ€§èƒ½ã€‚</p> <p>ç¡®å®šæ¡¶ä¸‹æ ‡çš„æœ€åä¸€æ­¥æ˜¯å°† key çš„ hash å€¼å¯¹æ¡¶ä¸ªæ•°å–æ¨¡ï¼šhash%capacityï¼Œå¦‚æœèƒ½ä¿è¯ capacity ä¸º 2 çš„ n æ¬¡æ–¹ï¼Œé‚£ä¹ˆå°±å¯ä»¥å°†è¿™ä¸ªæ“ä½œè½¬æ¢ä¸ºä½è¿ç®—ã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">indexFor</span><span class="token punctuation">(</span><span class="token keyword">int</span> h<span class="token punctuation">,</span> <span class="token keyword">int</span> length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> h <span class="token operator">&amp;</span> <span class="token punctuation">(</span>length<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_4-åˆ†æhashmapçš„putæ–¹æ³•"><a href="#_4-åˆ†æhashmapçš„putæ–¹æ³•" aria-hidden="true" class="header-anchor">#</a> 4. åˆ†æHashMapçš„putæ–¹æ³•</h4> <p>HashMap çš„ put æ–¹æ³•æ‰§è¡Œè¿‡ç¨‹å¯ä»¥é€šè¿‡ä¸‹å›¾æ¥ç†è§£ï¼Œè‡ªå·±æœ‰å…´è¶£å¯ä»¥å»å¯¹æ¯”æºç æ›´æ¸…æ¥šåœ°ç ”ç©¶å­¦ä¹ ã€‚</p> <div align="center"><img src="/fullstack-tutorial-site/assets/img/hashmap-put.58e67eae.png" width></div><br> <p>â‘ .åˆ¤æ–­é”®å€¼å¯¹æ•°ç»„ table[i] æ˜¯å¦ä¸ºç©ºæˆ–ä¸º nullï¼Œå¦åˆ™æ‰§è¡Œ resize() è¿›è¡Œæ‰©å®¹ï¼›</p> <p>â‘¡.æ ¹æ®é”®å€¼ key è®¡ç®— hash å€¼å¾—åˆ°æ’å…¥çš„æ•°ç»„ç´¢å¼•iï¼Œå¦‚æœ table[i]==nullï¼Œç›´æ¥æ–°å»ºèŠ‚ç‚¹æ·»åŠ ï¼Œè½¬å‘ â‘¥ï¼Œå¦‚æœtable[i] ä¸ä¸ºç©ºï¼Œè½¬å‘ â‘¢ï¼›</p> <p>â‘¢.åˆ¤æ–­ table[i] çš„é¦–ä¸ªå…ƒç´ æ˜¯å¦å’Œ key ä¸€æ ·ï¼Œå¦‚æœç›¸åŒç›´æ¥è¦†ç›– valueï¼Œå¦åˆ™è½¬å‘ â‘£ï¼Œè¿™é‡Œçš„ç›¸åŒæŒ‡çš„æ˜¯ hashCode ä»¥åŠ equalsï¼›</p> <p>â‘£.åˆ¤æ–­table[i] æ˜¯å¦ä¸º treeNodeï¼Œå³ table[i] æ˜¯å¦æ˜¯çº¢é»‘æ ‘ï¼Œå¦‚æœæ˜¯çº¢é»‘æ ‘ï¼Œåˆ™ç›´æ¥åœ¨æ ‘ä¸­æ’å…¥é”®å€¼å¯¹ï¼Œå¦åˆ™è½¬å‘ â‘¤ï¼›</p> <p>â‘¤.éå† table[i]ï¼Œåˆ¤æ–­é“¾è¡¨é•¿åº¦æ˜¯å¦å¤§äº 8ï¼Œå¤§äº 8 çš„è¯æŠŠé“¾è¡¨è½¬æ¢ä¸ºçº¢é»‘æ ‘ï¼Œåœ¨çº¢é»‘æ ‘ä¸­æ‰§è¡Œæ’å…¥æ“ä½œï¼Œå¦åˆ™è¿›è¡Œé“¾è¡¨çš„æ’å…¥æ“ä½œï¼›éå†è¿‡ç¨‹ä¸­è‹¥å‘ç° key å·²ç»å­˜åœ¨ç›´æ¥è¦†ç›– value å³å¯ï¼›</p> <p>â‘¥.æ’å…¥æˆåŠŸåï¼Œåˆ¤æ–­å®é™…å­˜åœ¨çš„é”®å€¼å¯¹æ•°é‡ size æ˜¯å¦è¶…å¤šäº†æœ€å¤§å®¹é‡ thresholdï¼Œå¦‚æœè¶…è¿‡ï¼Œè¿›è¡Œæ‰©å®¹ã€‚</p> <p>JDK1.8 HashMap çš„ put æ–¹æ³•æºç å¦‚ä¸‹:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> V <span class="token function">put</span><span class="token punctuation">(</span>K key<span class="token punctuation">,</span> V value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// å¯¹keyçš„hashCode()åšhash</span>
    <span class="token keyword">return</span> <span class="token function">putVal</span><span class="token punctuation">(</span><span class="token function">hash</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">final</span> V <span class="token function">putVal</span><span class="token punctuation">(</span><span class="token keyword">int</span> hash<span class="token punctuation">,</span> K key<span class="token punctuation">,</span> V value<span class="token punctuation">,</span> <span class="token keyword">boolean</span> onlyIfAbsent<span class="token punctuation">,</span>
               <span class="token keyword">boolean</span> evict<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Node<span class="token generics function"><span class="token punctuation">&lt;</span>K<span class="token punctuation">,</span>V<span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> tab<span class="token punctuation">;</span> Node<span class="token generics function"><span class="token punctuation">&lt;</span>K<span class="token punctuation">,</span>V<span class="token punctuation">&gt;</span></span> p<span class="token punctuation">;</span> <span class="token keyword">int</span> n<span class="token punctuation">,</span> i<span class="token punctuation">;</span>
    <span class="token comment">// æ­¥éª¤â‘ ï¼štabä¸ºç©ºåˆ™åˆ›å»º</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>tab <span class="token operator">=</span> table<span class="token punctuation">)</span> <span class="token operator">==</span> null <span class="token operator">||</span> <span class="token punctuation">(</span>n <span class="token operator">=</span> tab<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
        n <span class="token operator">=</span> <span class="token punctuation">(</span>tab <span class="token operator">=</span> <span class="token function">resize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>
    <span class="token comment">// æ­¥éª¤â‘¡ï¼šè®¡ç®—indexï¼Œå¹¶å¯¹nullåšå¤„ç† </span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>p <span class="token operator">=</span> tab<span class="token punctuation">[</span>i <span class="token operator">=</span> <span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> hash<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> null<span class="token punctuation">)</span> 
        tab<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">newNode</span><span class="token punctuation">(</span>hash<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> null<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token punctuation">{</span>
        Node<span class="token generics function"><span class="token punctuation">&lt;</span>K<span class="token punctuation">,</span>V<span class="token punctuation">&gt;</span></span> e<span class="token punctuation">;</span> K k<span class="token punctuation">;</span>
        <span class="token comment">// æ­¥éª¤â‘¢ï¼šèŠ‚ç‚¹keyå­˜åœ¨ï¼Œç›´æ¥è¦†ç›–value</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>p<span class="token punctuation">.</span>hash <span class="token operator">==</span> hash <span class="token operator">&amp;&amp;</span>
            <span class="token punctuation">(</span><span class="token punctuation">(</span>k <span class="token operator">=</span> p<span class="token punctuation">.</span>key<span class="token punctuation">)</span> <span class="token operator">==</span> key <span class="token operator">||</span> <span class="token punctuation">(</span>key <span class="token operator">!=</span> null <span class="token operator">&amp;&amp;</span> key<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            e <span class="token operator">=</span> p<span class="token punctuation">;</span>
        <span class="token comment">// æ­¥éª¤â‘£ï¼šåˆ¤æ–­è¯¥é“¾ä¸ºçº¢é»‘æ ‘</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>p <span class="token keyword">instanceof</span> <span class="token class-name">TreeNode</span><span class="token punctuation">)</span>
            e <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>TreeNode<span class="token generics function"><span class="token punctuation">&lt;</span>K<span class="token punctuation">,</span>V<span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span>p<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">putTreeVal</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> tab<span class="token punctuation">,</span> hash<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// æ­¥éª¤â‘¤ï¼šè¯¥é“¾ä¸ºé“¾è¡¨</span>
        <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> binCount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token punctuation">;</span> <span class="token operator">++</span>binCount<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>e <span class="token operator">=</span> p<span class="token punctuation">.</span>next<span class="token punctuation">)</span> <span class="token operator">==</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    p<span class="token punctuation">.</span>next <span class="token operator">=</span> <span class="token function">newNode</span><span class="token punctuation">(</span>hash<span class="token punctuation">,</span> key<span class="token punctuation">,</span>value<span class="token punctuation">,</span>null<span class="token punctuation">)</span><span class="token punctuation">;</span>
                     <span class="token comment">//é“¾è¡¨é•¿åº¦å¤§äº8è½¬æ¢ä¸ºçº¢é»‘æ ‘è¿›è¡Œå¤„ç†</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>binCount <span class="token operator">&gt;=</span> TREEIFY_THRESHOLD <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">// -1 for 1st  </span>
                        <span class="token function">treeifyBin</span><span class="token punctuation">(</span>tab<span class="token punctuation">,</span> hash<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                 <span class="token comment">// keyå·²ç»å­˜åœ¨ç›´æ¥è¦†ç›–value</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>hash <span class="token operator">==</span> hash <span class="token operator">&amp;&amp;</span>
                    <span class="token punctuation">(</span><span class="token punctuation">(</span>k <span class="token operator">=</span> e<span class="token punctuation">.</span>key<span class="token punctuation">)</span> <span class="token operator">==</span> key <span class="token operator">||</span> <span class="token punctuation">(</span>key <span class="token operator">!=</span> null <span class="token operator">&amp;&amp;</span> key<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
                           <span class="token keyword">break</span><span class="token punctuation">;</span>
                p <span class="token operator">=</span> e<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        
        <span class="token keyword">if</span> <span class="token punctuation">(</span>e <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// existing mapping for key</span>
            V oldValue <span class="token operator">=</span> e<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>onlyIfAbsent <span class="token operator">||</span> oldValue <span class="token operator">==</span> null<span class="token punctuation">)</span>
                e<span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">;</span>
            <span class="token function">afterNodeAccess</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> oldValue<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token operator">++</span>modCount<span class="token punctuation">;</span>
    <span class="token comment">// æ­¥éª¤â‘¥ï¼šè¶…è¿‡æœ€å¤§å®¹é‡ å°±æ‰©å®¹</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">++</span>size <span class="token operator">&gt;</span> threshold<span class="token punctuation">)</span>
        <span class="token function">resize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">afterNodeInsertion</span><span class="token punctuation">(</span>evict<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> null<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_5-æ‰©å®¹æœºåˆ¶"><a href="#_5-æ‰©å®¹æœºåˆ¶" aria-hidden="true" class="header-anchor">#</a> 5. æ‰©å®¹æœºåˆ¶</h4> <p>æ‰©å®¹ (resize) å°±æ˜¯é‡æ–°è®¡ç®—å®¹é‡ï¼Œå‘ HashMap å¯¹è±¡é‡Œä¸åœçš„æ·»åŠ å…ƒç´ ï¼Œè€Œ HashMap å¯¹è±¡å†…éƒ¨çš„æ•°ç»„æ— æ³•è£…è½½æ›´å¤šçš„å…ƒç´ æ—¶ï¼Œå¯¹è±¡å°±éœ€è¦æ‰©å¤§æ•°ç»„çš„é•¿åº¦ï¼Œä»¥ä¾¿èƒ½è£…å…¥æ›´å¤šçš„å…ƒç´ ã€‚å½“ç„¶ Java é‡Œçš„æ•°ç»„æ˜¯æ— æ³•è‡ªåŠ¨æ‰©å®¹çš„ï¼Œæ–¹æ³•æ˜¯ä½¿ç”¨ä¸€ä¸ªæ–°çš„æ•°ç»„ä»£æ›¿å·²æœ‰çš„å®¹é‡å°çš„æ•°ç»„ï¼Œå°±åƒæˆ‘ä»¬ç”¨ä¸€ä¸ªå°æ¡¶è£…æ°´ï¼Œå¦‚æœæƒ³è£…æ›´å¤šçš„æ°´ï¼Œå°±å¾—æ¢å¤§æ°´æ¡¶ã€‚</p> <p>æˆ‘ä»¬åˆ†æä¸‹ resize çš„æºç ï¼Œé‰´äº JDK1.8 èå…¥äº†çº¢é»‘æ ‘ï¼Œè¾ƒå¤æ‚ï¼Œä¸ºäº†ä¾¿äºç†è§£æˆ‘ä»¬ä»ç„¶ä½¿ç”¨ JDK1.7 çš„ä»£ç ï¼Œå¥½ç†è§£ä¸€äº›ï¼Œæœ¬è´¨ä¸ŠåŒºåˆ«ä¸å¤§ï¼Œå…·ä½“åŒºåˆ«åæ–‡å†è¯´ã€‚</p> <div class="language-JAVA extra-class"><pre class="language-java"><code><span class="token keyword">void</span> <span class="token function">resize</span><span class="token punctuation">(</span><span class="token keyword">int</span> newCapacity<span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token comment">//ä¼ å…¥æ–°çš„å®¹é‡</span>
    Entry<span class="token punctuation">[</span><span class="token punctuation">]</span> oldTable <span class="token operator">=</span> table<span class="token punctuation">;</span>    <span class="token comment">//å¼•ç”¨æ‰©å®¹å‰çš„Entryæ•°ç»„</span>
    <span class="token keyword">int</span> oldCapacity <span class="token operator">=</span> oldTable<span class="token punctuation">.</span>length<span class="token punctuation">;</span>         
    <span class="token keyword">if</span> <span class="token punctuation">(</span>oldCapacity <span class="token operator">==</span> MAXIMUM_CAPACITY<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">//æ‰©å®¹å‰çš„æ•°ç»„å¤§å°å¦‚æœå·²ç»è¾¾åˆ°æœ€å¤§(2^30)äº†</span>
        threshold <span class="token operator">=</span> Integer<span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">;</span> <span class="token comment">//ä¿®æ”¹é˜ˆå€¼ä¸ºintçš„æœ€å¤§å€¼(2^31-1)ï¼Œè¿™æ ·ä»¥åå°±ä¸ä¼šæ‰©å®¹äº†</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
 
    Entry<span class="token punctuation">[</span><span class="token punctuation">]</span> newTable <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Entry</span><span class="token punctuation">[</span>newCapacity<span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">//åˆå§‹åŒ–ä¸€ä¸ªæ–°çš„Entryæ•°ç»„</span>
    <span class="token function">transfer</span><span class="token punctuation">(</span>newTable<span class="token punctuation">)</span><span class="token punctuation">;</span>                         <span class="token comment">//ï¼ï¼å°†æ•°æ®è½¬ç§»åˆ°æ–°çš„Entryæ•°ç»„é‡Œ</span>
    table <span class="token operator">=</span> newTable<span class="token punctuation">;</span>                           <span class="token comment">//HashMapçš„tableå±æ€§å¼•ç”¨æ–°çš„Entryæ•°ç»„</span>
    threshold <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>newCapacity <span class="token operator">*</span> loadFactor<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ä¿®æ”¹é˜ˆå€¼</span>
<span class="token punctuation">}</span>
</code></pre></div><p>è¿™é‡Œå°±æ˜¯ä½¿ç”¨ä¸€ä¸ªå®¹é‡æ›´å¤§çš„æ•°ç»„æ¥ä»£æ›¿å·²æœ‰çš„å®¹é‡å°çš„æ•°ç»„ï¼Œtransfer() æ–¹æ³•å°†åŸæœ‰ Entry æ•°ç»„çš„å…ƒç´ æ‹·è´åˆ°æ–°çš„ Entry æ•°ç»„é‡Œã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">void</span> <span class="token function">transfer</span><span class="token punctuation">(</span>Entry<span class="token punctuation">[</span><span class="token punctuation">]</span> newTable<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Entry<span class="token punctuation">[</span><span class="token punctuation">]</span> src <span class="token operator">=</span> table<span class="token punctuation">;</span>                   <span class="token comment">//srcå¼•ç”¨äº†æ—§çš„Entryæ•°ç»„</span>
    <span class="token keyword">int</span> newCapacity <span class="token operator">=</span> newTable<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> src<span class="token punctuation">.</span>length<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//éå†æ—§çš„Entryæ•°ç»„</span>
        Entry<span class="token generics function"><span class="token punctuation">&lt;</span>K<span class="token punctuation">,</span>V<span class="token punctuation">&gt;</span></span> e <span class="token operator">=</span> src<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>             <span class="token comment">//å–å¾—æ—§Entryæ•°ç»„çš„æ¯ä¸ªå…ƒç´ </span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>e <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            src<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> null<span class="token punctuation">;</span><span class="token comment">//é‡Šæ”¾æ—§Entryæ•°ç»„çš„å¯¹è±¡å¼•ç”¨ï¼ˆforå¾ªç¯åï¼Œæ—§çš„Entryæ•°ç»„ä¸å†å¼•ç”¨ä»»ä½•å¯¹è±¡ï¼‰</span>
            <span class="token keyword">do</span> <span class="token punctuation">{</span>
                Entry<span class="token generics function"><span class="token punctuation">&lt;</span>K<span class="token punctuation">,</span>V<span class="token punctuation">&gt;</span></span> next <span class="token operator">=</span> e<span class="token punctuation">.</span>next<span class="token punctuation">;</span>
                <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token function">indexFor</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>hash<span class="token punctuation">,</span> newCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//ï¼ï¼é‡æ–°è®¡ç®—æ¯ä¸ªå…ƒç´ åœ¨æ•°ç»„ä¸­çš„ä½ç½®</span>
                e<span class="token punctuation">.</span>next <span class="token operator">=</span> newTable<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//æ ‡è®°[1]</span>
                newTable<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> e<span class="token punctuation">;</span>      <span class="token comment">//å°†å…ƒç´ æ”¾åœ¨æ•°ç»„ä¸Š</span>
                e <span class="token operator">=</span> next<span class="token punctuation">;</span>             <span class="token comment">//è®¿é—®ä¸‹ä¸€ä¸ªEntryé“¾ä¸Šçš„å…ƒç´ </span>
            <span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span>e <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>newTable[i] çš„å¼•ç”¨èµ‹ç»™äº† e.nextï¼Œä¹Ÿå°±æ˜¯ä½¿ç”¨äº†å•é“¾è¡¨çš„å¤´æ’å…¥æ–¹å¼ï¼ŒåŒä¸€ä½ç½®ä¸Šæ–°å…ƒç´ æ€»ä¼šè¢«æ”¾åœ¨é“¾è¡¨çš„å¤´éƒ¨ä½ç½®ï¼›è¿™æ ·å…ˆæ”¾åœ¨ä¸€ä¸ªç´¢å¼•ä¸Šçš„å…ƒç´ ç»ˆä¼šè¢«æ”¾åˆ° Entry é“¾çš„å°¾éƒ¨(å¦‚æœå‘ç”Ÿäº† hash å†²çªçš„è¯ï¼‰ï¼Œè¿™ä¸€ç‚¹å’Œ Jdk1.8 æœ‰åŒºåˆ«ï¼Œä¸‹æ–‡è¯¦è§£ã€‚åœ¨æ—§æ•°ç»„ä¸­åŒä¸€æ¡ Entry é“¾ä¸Šçš„å…ƒç´ ï¼Œé€šè¿‡é‡æ–°è®¡ç®—ç´¢å¼•ä½ç½®åï¼Œæœ‰å¯èƒ½è¢«æ”¾åˆ°äº†æ–°æ•°ç»„çš„ä¸åŒä½ç½®ä¸Šã€‚</p> <p>ä¸‹é¢ä¸¾ä¸ªä¾‹å­è¯´æ˜ä¸‹æ‰©å®¹è¿‡ç¨‹ã€‚å‡è®¾äº†æˆ‘ä»¬çš„ hash ç®—æ³•å°±æ˜¯ç®€å•çš„ç”¨ key mod ä¸€ä¸‹è¡¨çš„å¤§å°ï¼ˆä¹Ÿå°±æ˜¯æ•°ç»„çš„é•¿åº¦ï¼‰ã€‚å…¶ä¸­çš„å“ˆå¸Œæ¡¶æ•°ç»„ table çš„ size=2ï¼Œ æ‰€ä»¥ key = 3ã€7ã€5ï¼Œput é¡ºåºä¾æ¬¡ä¸º 5ã€7ã€3ã€‚åœ¨ mod 2 ä»¥åéƒ½å†²çªåœ¨ table[1] è¿™é‡Œäº†ã€‚è¿™é‡Œå‡è®¾è´Ÿè½½å› å­ loadFactor=1ï¼Œå³å½“é”®å€¼å¯¹çš„å®é™…å¤§å° size å¤§äº table çš„å®é™…å¤§å°æ—¶è¿›è¡Œæ‰©å®¹ã€‚æ¥ä¸‹æ¥çš„ä¸‰ä¸ªæ­¥éª¤æ˜¯å“ˆå¸Œæ¡¶æ•°ç»„ resize æˆ 4ï¼Œç„¶åæ‰€æœ‰çš„ Node é‡æ–° rehash çš„è¿‡ç¨‹ã€‚</p> <div align="center"><img src="/fullstack-tutorial-site/assets/img/jdk1.7-resize.e5aa99e8.png" width="600"></div> <p>ä¸‹é¢æˆ‘ä»¬è®²è§£ä¸‹ JDK1.8 åšäº†å“ªäº›ä¼˜åŒ–ã€‚ç»è¿‡è§‚æµ‹å¯ä»¥å‘ç°ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ 2 æ¬¡å¹‚çš„æ‰©å±• (æŒ‡é•¿åº¦æ‰©ä¸ºåŸæ¥ 2 å€)ï¼Œæ‰€ä»¥ï¼Œå…ƒç´ çš„ä½ç½®è¦ä¹ˆæ˜¯åœ¨åŸä½ç½®ï¼Œè¦ä¹ˆæ˜¯åœ¨åŸä½ç½®å†ç§»åŠ¨ 2 æ¬¡å¹‚çš„ä½ç½®ã€‚çœ‹ä¸‹å›¾å¯ä»¥æ˜ç™½è¿™å¥è¯çš„æ„æ€ï¼Œn ä¸º table çš„é•¿åº¦ï¼Œå›¾ï¼ˆaï¼‰è¡¨ç¤ºæ‰©å®¹å‰çš„ key1 å’Œ key2 ä¸¤ç§ key ç¡®å®šç´¢å¼•ä½ç½®çš„ç¤ºä¾‹ï¼Œå›¾ï¼ˆbï¼‰è¡¨ç¤ºæ‰©å®¹å key1 å’Œ key2 ä¸¤ç§ key ç¡®å®šç´¢å¼•ä½ç½®çš„ç¤ºä¾‹ï¼Œå…¶ä¸­ hash1 æ˜¯ key1 å¯¹åº”çš„å“ˆå¸Œä¸é«˜ä½è¿ç®—ç»“æœã€‚</p> <div align="center"><img src="/fullstack-tutorial-site/assets/img/hashMap-1.8-hash1.a285d9b2.png" width="700"></div><br> <p>å…ƒç´ åœ¨é‡æ–°è®¡ç®— hash ä¹‹åï¼Œå› ä¸º n å˜ä¸º 2 å€ï¼Œé‚£ä¹ˆ n-1 çš„ mask èŒƒå›´åœ¨é«˜ä½å¤š 1bit (çº¢è‰²)ï¼Œå› æ­¤æ–°çš„ index å°±ä¼šå‘ç”Ÿè¿™æ ·çš„å˜åŒ–ï¼š</p> <div align="center"><img src="/fullstack-tutorial-site/assets/img/hashMap-1.8-hash2.b2cb0577.png" width="600"></div> <p>å› æ­¤ï¼Œæˆ‘ä»¬åœ¨æ‰©å…… HashMap çš„æ—¶å€™ï¼Œä¸éœ€è¦åƒ JDK1.7 çš„å®ç°é‚£æ ·é‡æ–°è®¡ç®— hashï¼Œåªéœ€è¦çœ‹çœ‹åŸæ¥çš„ hash å€¼æ–°å¢çš„é‚£ä¸ª bit æ˜¯ 1 è¿˜æ˜¯ 0 å°±å¥½äº†ï¼Œæ˜¯ 0 çš„è¯ç´¢å¼•æ²¡å˜ï¼Œæ˜¯ 1 çš„è¯ç´¢å¼•å˜æˆâ€œåŸç´¢å¼•+oldCapâ€ï¼Œå¯ä»¥çœ‹çœ‹ä¸‹å›¾ä¸º 16 æ‰©å……ä¸º 32 çš„ resize ç¤ºæ„å›¾ï¼š</p> <div align="center"><img src="/fullstack-tutorial-site/assets/img/jdk1.8-resize.544caeb8.png" width="700"></div><br> <p>è¿™ä¸ªè®¾è®¡ç¡®å®éå¸¸çš„å·§å¦™ï¼Œæ—¢çœå»äº†é‡æ–°è®¡ç®— hash å€¼çš„æ—¶é—´ï¼Œè€Œä¸”åŒæ—¶ï¼Œç”±äºæ–°å¢çš„ 1bit æ˜¯ 0 è¿˜æ˜¯ 1 å¯ä»¥è®¤ä¸ºæ˜¯éšæœºçš„ï¼Œå› æ­¤ resize çš„è¿‡ç¨‹ï¼Œå‡åŒ€çš„æŠŠä¹‹å‰çš„å†²çªçš„èŠ‚ç‚¹åˆ†æ•£åˆ°æ–°çš„ bucket äº†ã€‚è¿™ä¸€å—å°±æ˜¯ JDK1.8 æ–°å¢çš„ä¼˜åŒ–ç‚¹ã€‚æœ‰ä¸€ç‚¹æ³¨æ„åŒºåˆ«ï¼ŒJDK1.7 ä¸­ rehash çš„æ—¶å€™ï¼Œæ—§é“¾è¡¨è¿ç§»æ–°é“¾è¡¨çš„æ—¶å€™ï¼Œå¦‚æœåœ¨æ–°è¡¨çš„æ•°ç»„ç´¢å¼•ä½ç½®ç›¸åŒï¼Œåˆ™é“¾è¡¨å…ƒç´ ä¼šå€’ç½®ï¼Œä½†æ˜¯ä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼ŒJDK1.8 ä¸ä¼šå€’ç½®ã€‚æœ‰å…´è¶£çš„åŒå­¦å¯ä»¥ç ”ç©¶ä¸‹ JDK1.8 çš„ resizeæº ç ï¼Œå†™çš„å¾ˆèµï¼Œå¦‚ä¸‹:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">final</span> Node<span class="token generics function"><span class="token punctuation">&lt;</span>K<span class="token punctuation">,</span>V<span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">resize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Node<span class="token generics function"><span class="token punctuation">&lt;</span>K<span class="token punctuation">,</span>V<span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> oldTab <span class="token operator">=</span> table<span class="token punctuation">;</span>
    <span class="token keyword">int</span> oldCap <span class="token operator">=</span> <span class="token punctuation">(</span>oldTab <span class="token operator">==</span> null<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> oldTab<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
    <span class="token keyword">int</span> oldThr <span class="token operator">=</span> threshold<span class="token punctuation">;</span>
    <span class="token keyword">int</span> newCap<span class="token punctuation">,</span> newThr <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>oldCap <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// è¶…è¿‡æœ€å¤§å€¼å°±ä¸å†æ‰©å……äº†ï¼Œå°±åªå¥½éšä½ ç¢°æ’å»å§</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>oldCap <span class="token operator">&gt;=</span> MAXIMUM_CAPACITY<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            threshold <span class="token operator">=</span> Integer<span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">;</span>
            <span class="token keyword">return</span> oldTab<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// æ²¡è¶…è¿‡æœ€å¤§å€¼ï¼Œå°±æ‰©å……ä¸ºåŸæ¥çš„2å€</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>newCap <span class="token operator">=</span> oldCap <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> MAXIMUM_CAPACITY <span class="token operator">&amp;&amp;</span>
                 oldCap <span class="token operator">&gt;=</span> DEFAULT_INITIAL_CAPACITY<span class="token punctuation">)</span>
            newThr <span class="token operator">=</span> oldThr <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// double threshold</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>oldThr <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">// initial capacity was placed in threshold</span>
        newCap <span class="token operator">=</span> oldThr<span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token punctuation">{</span>               <span class="token comment">// zero initial threshold signifies using defaults</span>
        newCap <span class="token operator">=</span> DEFAULT_INITIAL_CAPACITY<span class="token punctuation">;</span>
        newThr <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>DEFAULT_LOAD_FACTOR <span class="token operator">*</span> DEFAULT_INITIAL_CAPACITY<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// è®¡ç®—æ–°çš„resizeä¸Šé™</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>newThr <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">float</span> ft <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span>newCap <span class="token operator">*</span> loadFactor<span class="token punctuation">;</span>
        newThr <span class="token operator">=</span> <span class="token punctuation">(</span>newCap <span class="token operator">&lt;</span> MAXIMUM_CAPACITY <span class="token operator">&amp;&amp;</span> ft <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span>MAXIMUM_CAPACITY <span class="token operator">?</span>
                  <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>ft <span class="token operator">:</span> Integer<span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    threshold <span class="token operator">=</span> newThr<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@SuppressWarnings</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;rawtypes&quot;</span>ï¼Œ<span class="token string">&quot;unchecked&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
        Node<span class="token generics function"><span class="token punctuation">&lt;</span>K<span class="token punctuation">,</span>V<span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> newTab <span class="token operator">=</span> <span class="token punctuation">(</span>Node<span class="token generics function"><span class="token punctuation">&lt;</span>K<span class="token punctuation">,</span>V<span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token punctuation">[</span>newCap<span class="token punctuation">]</span><span class="token punctuation">;</span>
    table <span class="token operator">=</span> newTab<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>oldTab <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// æŠŠæ¯ä¸ªbucketéƒ½ç§»åŠ¨åˆ°æ–°çš„bucketsä¸­</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> oldCap<span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            Node<span class="token generics function"><span class="token punctuation">&lt;</span>K<span class="token punctuation">,</span>V<span class="token punctuation">&gt;</span></span> e<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>e <span class="token operator">=</span> oldTab<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                oldTab<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> null<span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>next <span class="token operator">==</span> null<span class="token punctuation">)</span>
                    newTab<span class="token punctuation">[</span>e<span class="token punctuation">.</span>hash <span class="token operator">&amp;</span> <span class="token punctuation">(</span>newCap <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> e<span class="token punctuation">;</span>
                <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>e <span class="token keyword">instanceof</span> <span class="token class-name">TreeNode</span><span class="token punctuation">)</span>
                    <span class="token punctuation">(</span><span class="token punctuation">(</span>TreeNode<span class="token generics function"><span class="token punctuation">&lt;</span>K<span class="token punctuation">,</span>V<span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span>e<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> newTab<span class="token punctuation">,</span> j<span class="token punctuation">,</span> oldCap<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token comment">// é“¾è¡¨ä¼˜åŒ–é‡hashçš„ä»£ç å—</span>
                    Node<span class="token generics function"><span class="token punctuation">&lt;</span>K<span class="token punctuation">,</span>V<span class="token punctuation">&gt;</span></span> loHead <span class="token operator">=</span> null<span class="token punctuation">,</span> loTail <span class="token operator">=</span> null<span class="token punctuation">;</span>
                    Node<span class="token generics function"><span class="token punctuation">&lt;</span>K<span class="token punctuation">,</span>V<span class="token punctuation">&gt;</span></span> hiHead <span class="token operator">=</span> null<span class="token punctuation">,</span> hiTail <span class="token operator">=</span> null<span class="token punctuation">;</span>
                    Node<span class="token generics function"><span class="token punctuation">&lt;</span>K<span class="token punctuation">,</span>V<span class="token punctuation">&gt;</span></span> next<span class="token punctuation">;</span>
                    <span class="token keyword">do</span> <span class="token punctuation">{</span>
                        next <span class="token operator">=</span> e<span class="token punctuation">.</span>next<span class="token punctuation">;</span>
                        <span class="token comment">// åŸç´¢å¼•</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>hash <span class="token operator">&amp;</span> oldCap<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                            <span class="token keyword">if</span> <span class="token punctuation">(</span>loTail <span class="token operator">==</span> null<span class="token punctuation">)</span>
                                loHead <span class="token operator">=</span> e<span class="token punctuation">;</span>
                            <span class="token keyword">else</span>
                                loTail<span class="token punctuation">.</span>next <span class="token operator">=</span> e<span class="token punctuation">;</span>
                            loTail <span class="token operator">=</span> e<span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                        <span class="token comment">// åŸç´¢å¼•+oldCap</span>
                        <span class="token keyword">else</span> <span class="token punctuation">{</span>
                            <span class="token keyword">if</span> <span class="token punctuation">(</span>hiTail <span class="token operator">==</span> null<span class="token punctuation">)</span>
                                hiHead <span class="token operator">=</span> e<span class="token punctuation">;</span>
                            <span class="token keyword">else</span>
                                hiTail<span class="token punctuation">.</span>next <span class="token operator">=</span> e<span class="token punctuation">;</span>
                            hiTail <span class="token operator">=</span> e<span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>e <span class="token operator">=</span> next<span class="token punctuation">)</span> <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment">// åŸç´¢å¼•æ”¾åˆ°bucketé‡Œ</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>loTail <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        loTail<span class="token punctuation">.</span>next <span class="token operator">=</span> null<span class="token punctuation">;</span>
                        newTab<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> loHead<span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    <span class="token comment">// åŸç´¢å¼•+oldCapæ”¾åˆ°bucketé‡Œ</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>hiTail <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        hiTail<span class="token punctuation">.</span>next <span class="token operator">=</span> null<span class="token punctuation">;</span>
                        newTab<span class="token punctuation">[</span>j <span class="token operator">+</span> oldCap<span class="token punctuation">]</span> <span class="token operator">=</span> hiHead<span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> newTab<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_6-çº¿ç¨‹å®‰å…¨æ€§"><a href="#_6-çº¿ç¨‹å®‰å…¨æ€§" aria-hidden="true" class="header-anchor">#</a> 6. çº¿ç¨‹å®‰å…¨æ€§</h4> <p>åœ¨å¤šçº¿ç¨‹ä½¿ç”¨åœºæ™¯ä¸­ï¼Œåº”è¯¥å°½é‡é¿å…ä½¿ç”¨çº¿ç¨‹ä¸å®‰å…¨çš„ HashMapï¼Œè€Œä½¿ç”¨çº¿ç¨‹å®‰å…¨çš„ ConcurrentHashMapã€‚é‚£ä¹ˆä¸ºä»€ä¹ˆè¯´ HashMap æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼Œä¸‹é¢ä¸¾ä¾‹å­è¯´æ˜åœ¨å¹¶å‘çš„å¤šçº¿ç¨‹ä½¿ç”¨åœºæ™¯ä¸­ä½¿ç”¨ HashMap å¯èƒ½é€ æˆæ­»å¾ªç¯ã€‚ä»£ç ä¾‹å­å¦‚ä¸‹(ä¾¿äºç†è§£ï¼Œä»ç„¶ä½¿ç”¨ JDK1.7 çš„ç¯å¢ƒ)ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HashMapInfiniteLoop</span> <span class="token punctuation">{</span>  

    <span class="token keyword">private</span> <span class="token keyword">static</span> HashMap<span class="token generics function"><span class="token punctuation">&lt;</span>Integer<span class="token punctuation">,</span>String<span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics function"><span class="token punctuation">&lt;</span>Integer<span class="token punctuation">,</span>String<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">2</span>ï¼Œ<span class="token number">0.75f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">5</span>ï¼Œ <span class="token string">&quot;C&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  

        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token string">&quot;Thread1&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
                map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token string">&quot;B&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token punctuation">}</span><span class="token punctuation">;</span>  
        <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token string">&quot;Thread2&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
                map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> &quot;A<span class="token punctuation">)</span><span class="token punctuation">;</span>  
                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token punctuation">}</span><span class="token punctuation">;</span>  
        <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre></div><p>å…¶ä¸­ï¼Œmapåˆå§‹åŒ–ä¸ºä¸€ä¸ªé•¿åº¦ä¸º2çš„æ•°ç»„ï¼ŒloadFactor=0.75ï¼Œthreshold=2*0.75=1ï¼Œä¹Ÿå°±æ˜¯è¯´å½“putç¬¬äºŒä¸ªkeyçš„æ—¶å€™ï¼Œmapå°±éœ€è¦è¿›è¡Œresizeã€‚</p> <p>é€šè¿‡è®¾ç½®æ–­ç‚¹è®©çº¿ç¨‹1å’Œçº¿ç¨‹2åŒæ—¶debugåˆ°transferæ–¹æ³•(3.3å°èŠ‚ä»£ç å—)çš„é¦–è¡Œã€‚æ³¨æ„æ­¤æ—¶ä¸¤ä¸ªçº¿ç¨‹å·²ç»æˆåŠŸæ·»åŠ æ•°æ®ã€‚æ”¾å¼€thread1çš„æ–­ç‚¹è‡³transferæ–¹æ³•çš„â€œEntry next = e.next;â€ è¿™ä¸€è¡Œï¼›ç„¶åæ”¾å¼€çº¿ç¨‹2çš„çš„æ–­ç‚¹ï¼Œè®©çº¿ç¨‹2è¿›è¡Œresizeã€‚ç»“æœå¦‚ä¸‹å›¾ã€‚</p> <div align="center"><img src="/fullstack-tutorial-site/assets/img/jdk1.7-drop-dead-1.fa10635a.png" width="600"></div> <p>æ³¨æ„ï¼ŒThread1çš„ e æŒ‡å‘äº†key(3)ï¼Œè€ŒnextæŒ‡å‘äº†key(7)ï¼Œå…¶åœ¨çº¿ç¨‹äºŒrehashåï¼ŒæŒ‡å‘äº†çº¿ç¨‹äºŒé‡ç»„åçš„é“¾è¡¨ã€‚</p> <p>çº¿ç¨‹ä¸€è¢«è°ƒåº¦å›æ¥æ‰§è¡Œï¼Œå…ˆæ˜¯æ‰§è¡Œ newTalbe[i] = eï¼Œ ç„¶åæ˜¯e = nextï¼Œå¯¼è‡´äº†eæŒ‡å‘äº†key(7)ï¼Œè€Œä¸‹ä¸€æ¬¡å¾ªç¯çš„next = e.nextå¯¼è‡´äº†nextæŒ‡å‘äº†key(3)ã€‚</p> <div align="center"><img src="/fullstack-tutorial-site/assets/img/jdk1.7-drop-dead-2.d39d7eff.png" width="600"></div> <div align="center"><img src="/fullstack-tutorial-site/assets/img/jdk1.7-drop-dead-3.31b43af0.png" width="600"></div> <p>e.next = newTable[i] å¯¼è‡´ key(3).next æŒ‡å‘äº† key(7)ã€‚æ³¨æ„ï¼šæ­¤æ—¶çš„key(7).next å·²ç»æŒ‡å‘äº†key(3)ï¼Œ ç¯å½¢é“¾è¡¨å°±è¿™æ ·å‡ºç°äº†ã€‚</p> <div align="center"><img src="/fullstack-tutorial-site/assets/img/jdk1.7-drop-dead-5.5f3cf530.png" width="600"></div> <p>äºæ˜¯ï¼Œå½“æˆ‘ä»¬ç”¨çº¿ç¨‹ä¸€è°ƒç”¨map.get(11)æ—¶ï¼Œæ‚²å‰§å°±å‡ºç°äº†â€”â€”Infinite Loopã€‚</p> <h4 id="_7-jdk1-8ä¸jdk1-7çš„æ€§èƒ½å¯¹æ¯”"><a href="#_7-jdk1-8ä¸jdk1-7çš„æ€§èƒ½å¯¹æ¯”" aria-hidden="true" class="header-anchor">#</a> 7. JDK1.8ä¸JDK1.7çš„æ€§èƒ½å¯¹æ¯”</h4> <p>HashMapä¸­ï¼Œå¦‚æœkeyç»è¿‡hashç®—æ³•å¾—å‡ºçš„æ•°ç»„ç´¢å¼•ä½ç½®å…¨éƒ¨ä¸ç›¸åŒï¼Œå³Hashç®—æ³•éå¸¸å¥½ï¼Œé‚£æ ·çš„è¯ï¼ŒgetKeyæ–¹æ³•çš„æ—¶é—´å¤æ‚åº¦å°±æ˜¯O(1)ï¼Œå¦‚æœHashç®—æ³•æŠ€æœ¯çš„ç»“æœç¢°æ’éå¸¸å¤šï¼Œå‡å¦‚Hashç®—æå…¶å·®ï¼Œæ‰€æœ‰çš„Hashç®—æ³•ç»“æœå¾—å‡ºçš„ç´¢å¼•ä½ç½®ä¸€æ ·ï¼Œé‚£æ ·æ‰€æœ‰çš„é”®å€¼å¯¹éƒ½é›†ä¸­åˆ°ä¸€ä¸ªæ¡¶ä¸­ï¼Œæˆ–è€…åœ¨ä¸€ä¸ªé“¾è¡¨ä¸­ï¼Œæˆ–è€…åœ¨ä¸€ä¸ªçº¢é»‘æ ‘ä¸­ï¼Œæ—¶é—´å¤æ‚åº¦åˆ†åˆ«ä¸ºO(n)å’ŒO(lgn)ã€‚ é‰´äºJDK1.8åšäº†å¤šæ–¹é¢çš„ä¼˜åŒ–ï¼Œæ€»ä½“æ€§èƒ½ä¼˜äºJDK1.7ï¼Œä¸‹é¢æˆ‘ä»¬ä»ä¸¤ä¸ªæ–¹é¢ç”¨ä¾‹å­è¯æ˜è¿™ä¸€ç‚¹ã€‚</p> <h4 id="_8-hashè¾ƒå‡åŒ€çš„æƒ…å†µ"><a href="#_8-hashè¾ƒå‡åŒ€çš„æƒ…å†µ" aria-hidden="true" class="header-anchor">#</a> 8. Hashè¾ƒå‡åŒ€çš„æƒ…å†µ</h4> <p>ä¸ºäº†ä¾¿äºæµ‹è¯•ï¼Œæˆ‘ä»¬å…ˆå†™ä¸€ä¸ªç±»Keyï¼Œå¦‚ä¸‹ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">Key</span> <span class="token keyword">implements</span> <span class="token class-name">Comparable</span><span class="token generics function"><span class="token punctuation">&lt;</span>Key<span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">int</span> value<span class="token punctuation">;</span>

    <span class="token function">Key</span><span class="token punctuation">(</span><span class="token keyword">int</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">compareTo</span><span class="token punctuation">(</span>Key o<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> Integer<span class="token punctuation">.</span><span class="token function">compare</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">,</span> o<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">equals</span><span class="token punctuation">(</span>Object o<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">==</span> o<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>o <span class="token operator">==</span> null <span class="token operator">||</span> <span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> o<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        Key key <span class="token operator">=</span> <span class="token punctuation">(</span>Key<span class="token punctuation">)</span> o<span class="token punctuation">;</span>
        <span class="token keyword">return</span> value <span class="token operator">==</span> key<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>è¿™ä¸ªç±»å¤å†™äº†equalsæ–¹æ³•ï¼Œå¹¶ä¸”æä¾›äº†ç›¸å½“å¥½çš„hashCodeå‡½æ•°ï¼Œä»»ä½•ä¸€ä¸ªå€¼çš„hashCodeéƒ½ä¸ä¼šç›¸åŒï¼Œå› ä¸ºç›´æ¥ä½¿ç”¨valueå½“åšhashcodeã€‚ä¸ºäº†é¿å…é¢‘ç¹çš„GCï¼Œæˆ‘å°†ä¸å˜çš„Keyå®ä¾‹ç¼“å­˜äº†èµ·æ¥ï¼Œè€Œä¸æ˜¯ä¸€éä¸€éçš„åˆ›å»ºå®ƒä»¬ã€‚ä»£ç å¦‚ä¸‹ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Keys</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> MAX_KEY <span class="token operator">=</span> <span class="token number">10</span>_000_000<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> Key<span class="token punctuation">[</span><span class="token punctuation">]</span> KEYS_CACHE <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Key</span><span class="token punctuation">[</span>MAX_KEY<span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">static</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> MAX_KEY<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            KEYS_CACHE<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Key</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> Key <span class="token function">of</span><span class="token punctuation">(</span><span class="token keyword">int</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> KEYS_CACHE<span class="token punctuation">[</span>value<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ç°åœ¨å¼€å§‹æˆ‘ä»¬çš„è¯•éªŒï¼Œæµ‹è¯•éœ€è¦åšçš„ä»…ä»…æ˜¯ï¼Œåˆ›å»ºä¸åŒsizeçš„HashMapï¼ˆ1ã€10ã€100ã€......10000000ï¼‰ï¼Œå±è”½äº†æ‰©å®¹çš„æƒ…å†µï¼Œä»£ç å¦‚ä¸‹ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token keyword">int</span> mapSize<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    HashMap<span class="token generics function"><span class="token punctuation">&lt;</span>Key<span class="token punctuation">,</span> Integer<span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics function"><span class="token punctuation">&lt;</span>Key<span class="token punctuation">,</span>Integer<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>mapSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> mapSize<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>Keys<span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">long</span> beginTime <span class="token operator">=</span> System<span class="token punctuation">.</span><span class="token function">nanoTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//è·å–çº³ç§’</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> mapSize<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>Keys<span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">long</span> endTime <span class="token operator">=</span> System<span class="token punctuation">.</span><span class="token function">nanoTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>endTime <span class="token operator">-</span> beginTime<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span> <span class="token number">1000</span> <span class="token number">0000</span><span class="token punctuation">;</span>i<span class="token operator">*=</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">test</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>åœ¨æµ‹è¯•ä¸­ä¼šæŸ¥æ‰¾ä¸åŒçš„å€¼ï¼Œç„¶ååº¦é‡èŠ±è´¹çš„æ—¶é—´ï¼Œä¸ºäº†è®¡ç®—getKeyçš„å¹³å‡æ—¶é—´ï¼Œæˆ‘ä»¬éå†æ‰€æœ‰çš„getæ–¹æ³•ï¼Œè®¡ç®—æ€»çš„æ—¶é—´ï¼Œé™¤ä»¥keyçš„æ•°é‡ï¼Œè®¡ç®—ä¸€ä¸ªå¹³å‡å€¼ï¼Œä¸»è¦ç”¨æ¥æ¯”è¾ƒï¼Œç»å¯¹å€¼å¯èƒ½ä¼šå—å¾ˆå¤šç¯å¢ƒå› ç´ çš„å½±å“ã€‚ç»“æœå¦‚ä¸‹ï¼š</p> <div align="center"><img src="/fullstack-tutorial-site/assets/img/hashmap-compare1.2fd11382.png" width></div><br> <p>é€šè¿‡è§‚æµ‹æµ‹è¯•ç»“æœå¯çŸ¥ï¼ŒJDK1.8çš„æ€§èƒ½è¦é«˜äºJDK1.7 15%ä»¥ä¸Šï¼Œåœ¨æŸäº›sizeçš„åŒºåŸŸä¸Šï¼Œç”šè‡³é«˜äº100%ã€‚ç”±äºHashç®—æ³•è¾ƒå‡åŒ€ï¼ŒJDK1.8å¼•å…¥çš„çº¢é»‘æ ‘æ•ˆæœä¸æ˜æ˜¾ï¼Œä¸‹é¢æˆ‘ä»¬çœ‹çœ‹Hashä¸å‡åŒ€çš„çš„æƒ…å†µã€‚</p> <h4 id="_9-hashæä¸å‡åŒ€çš„æƒ…å†µ"><a href="#_9-hashæä¸å‡åŒ€çš„æƒ…å†µ" aria-hidden="true" class="header-anchor">#</a> 9. Hashæä¸å‡åŒ€çš„æƒ…å†µ</h4> <p>å‡è®¾æˆ‘ä»¬åˆä¸€ä¸ªéå¸¸å·®çš„Keyï¼Œå®ƒä»¬æ‰€æœ‰çš„å®ä¾‹éƒ½è¿”å›ç›¸åŒçš„hashCodeå€¼ã€‚è¿™æ˜¯ä½¿ç”¨HashMapæœ€åçš„æƒ…å†µã€‚ä»£ç ä¿®æ”¹å¦‚ä¸‹ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">Key</span> <span class="token keyword">implements</span> <span class="token class-name">Comparable</span><span class="token generics function"><span class="token punctuation">&lt;</span>Key<span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

    <span class="token comment">//...</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ä»ç„¶æ‰§è¡Œmainæ–¹æ³•ï¼Œå¾—å‡ºçš„ç»“æœå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p> <div align="center"><img src="/fullstack-tutorial-site/assets/img/hashmap-compare2.608ce9cf.png" width></div><br> <p>ä»è¡¨ä¸­ç»“æœä¸­å¯çŸ¥ï¼Œéšç€sizeçš„å˜å¤§ï¼ŒJDK1.7çš„èŠ±è´¹æ—¶é—´æ˜¯å¢é•¿çš„è¶‹åŠ¿ï¼Œè€ŒJDK1.8æ˜¯æ˜æ˜¾çš„é™ä½è¶‹åŠ¿ï¼Œå¹¶ä¸”å‘ˆç°å¯¹æ•°å¢é•¿ç¨³å®šã€‚å½“ä¸€ä¸ªé“¾è¡¨å¤ªé•¿çš„æ—¶å€™ï¼ŒHashMapä¼šåŠ¨æ€çš„å°†å®ƒæ›¿æ¢æˆä¸€ä¸ªçº¢é»‘æ ‘ï¼Œè¿™è¯çš„è¯ä¼šå°†æ—¶é—´å¤æ‚åº¦ä»O(n)é™ä¸ºO(logn)ã€‚hashç®—æ³•å‡åŒ€å’Œä¸å‡åŒ€æ‰€èŠ±è´¹çš„æ—¶é—´æ˜æ˜¾ä¹Ÿä¸ç›¸åŒï¼Œè¿™ä¸¤ç§æƒ…å†µçš„ç›¸å¯¹æ¯”è¾ƒï¼Œå¯ä»¥è¯´æ˜ä¸€ä¸ªå¥½çš„hashç®—æ³•çš„é‡è¦æ€§ã€‚</p> <p>æµ‹è¯•ç¯å¢ƒï¼šå¤„ç†å™¨ä¸º2.2 GHz Intel Core i7ï¼Œå†…å­˜ä¸º16 GB 1600 MHz DDR3ï¼ŒSSDç¡¬ç›˜ï¼Œä½¿ç”¨é»˜è®¤çš„JVMå‚æ•°ï¼Œè¿è¡Œåœ¨64ä½çš„OS X 10.10.1ä¸Šã€‚</p> <h4 id="_10-hashmapä¸hashtable"><a href="#_10-hashmapä¸hashtable" aria-hidden="true" class="header-anchor">#</a> 10. HashMapä¸HashTable</h4> <ol><li>HashTable ä½¿ç”¨ synchronized æ¥è¿›è¡ŒåŒæ­¥ã€‚</li> <li>HashMap å¯ä»¥æ’å…¥é”®ä¸º null çš„ Entryã€‚</li> <li>HashMap çš„è¿­ä»£å™¨æ˜¯ fail-fast è¿­ä»£å™¨ã€‚</li> <li>HashMap ä¸èƒ½ä¿è¯éšç€æ—¶é—´çš„æ¨ç§» Map ä¸­çš„å…ƒç´ æ¬¡åºæ˜¯ä¸å˜çš„ã€‚</li></ol> <h4 id="_11-å°ç»“"><a href="#_11-å°ç»“" aria-hidden="true" class="header-anchor">#</a> 11. å°ç»“</h4> <ol><li>æ‰©å®¹æ˜¯ä¸€ä¸ªç‰¹åˆ«è€—æ€§èƒ½çš„æ“ä½œï¼Œæ‰€ä»¥å½“ç¨‹åºå‘˜åœ¨ä½¿ç”¨ HashMap çš„æ—¶å€™ï¼Œä¼°ç®— map çš„å¤§å°ï¼Œåˆå§‹åŒ–çš„æ—¶å€™ç»™ä¸€ä¸ªå¤§è‡´çš„æ•°å€¼ï¼Œé¿å… map è¿›è¡Œé¢‘ç¹çš„æ‰©å®¹ã€‚</li> <li>è´Ÿè½½å› å­æ˜¯å¯ä»¥ä¿®æ”¹çš„ï¼Œä¹Ÿå¯ä»¥å¤§äº1ï¼Œä½†æ˜¯å»ºè®®ä¸è¦è½»æ˜“ä¿®æ”¹ï¼Œé™¤éæƒ…å†µéå¸¸ç‰¹æ®Šã€‚</li> <li>HashMap æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼Œä¸è¦åœ¨å¹¶å‘çš„ç¯å¢ƒä¸­åŒæ—¶æ“ä½œ HashMapï¼Œå»ºè®®ä½¿ç”¨ ConcurrentHashMapã€‚</li> <li>JDK1.8 å¼•å…¥çº¢é»‘æ ‘å¤§ç¨‹åº¦ä¼˜åŒ–äº† HashMap çš„æ€§èƒ½ã€‚</li></ol> <p>å‚è€ƒèµ„æ–™ï¼š</p> <ul><li><a href="https://tech.meituan.com/java_hashmap.html" target="_blank" rel="noopener noreferrer">Java 8ç³»åˆ—ä¹‹é‡æ–°è®¤è¯†HashMapâ€”â€”ç¾å›¢æŠ€æœ¯<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://juejin.im/post/5ac83fa35188255c5668afd0" target="_blank" rel="noopener noreferrer">ææ‡‚ Java HashMap æºç  - æ˜é‡‘<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://juejin.im/post/5ac4d8abf265da23a4050ae3" target="_blank" rel="noopener noreferrer">ææ‡‚ Java equals å’Œ hashCode æ–¹æ³• - æ˜é‡‘<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h3 id="concurrenthashmap"><a href="#concurrenthashmap" aria-hidden="true" class="header-anchor">#</a> ConcurrentHashMap</h3> <h4 id="_1-æ¦‚è¿°"><a href="#_1-æ¦‚è¿°" aria-hidden="true" class="header-anchor">#</a> 1. æ¦‚è¿°</h4> <p>ä¼—æ‰€å‘¨çŸ¥ï¼Œå“ˆå¸Œè¡¨æ˜¯ä¸­éå¸¸é«˜æ•ˆï¼Œå¤æ‚åº¦ä¸º O(1) çš„æ•°æ®ç»“æ„ï¼Œåœ¨ Java å¼€å‘ä¸­ï¼Œæˆ‘ä»¬æœ€å¸¸è§åˆ°æœ€é¢‘ç¹ä½¿ç”¨çš„å°±æ˜¯ HashMap å’Œ HashTableï¼Œä½†æ˜¯åœ¨çº¿ç¨‹ç«äº‰æ¿€çƒˆçš„å¹¶å‘åœºæ™¯ä¸­ä½¿ç”¨éƒ½ä¸å¤Ÿåˆç†ã€‚</p> <p><strong>HashMap</strong> ï¼šå…ˆè¯´ HashMapï¼ŒHashMap æ˜¯<strong>çº¿ç¨‹ä¸å®‰å…¨</strong>çš„ï¼Œåœ¨å¹¶å‘ç¯å¢ƒä¸‹ï¼Œå¯èƒ½ä¼šå½¢æˆ<strong>ç¯çŠ¶é“¾è¡¨</strong>ï¼ˆæ‰©å®¹æ—¶å¯èƒ½é€ æˆï¼‰ï¼Œå¯¼è‡´ get æ“ä½œæ—¶ï¼Œcpu ç©ºè½¬ï¼Œæ‰€ä»¥ï¼Œåœ¨å¹¶å‘ç¯å¢ƒä¸­ä½¿ ç”¨HashMap æ˜¯éå¸¸å±é™©çš„ã€‚</p> <p><strong>HashTable</strong> ï¼š HashTable å’Œ HashMapçš„å®ç°åŸç†å‡ ä¹ä¸€æ ·ï¼Œå·®åˆ«æ— éæ˜¯ï¼šï¼ˆ1ï¼‰HashTableä¸å…è®¸keyå’Œvalueä¸ºnullï¼›ï¼ˆ2ï¼‰HashTableæ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚</p> <p>ä½†æ˜¯ HashTable çº¿ç¨‹å®‰å…¨çš„ç­–ç•¥å®ç°ä»£ä»·å´å¤ªå¤§äº†ï¼Œç®€å•ç²—æš´ï¼Œget/put æ‰€æœ‰ç›¸å…³æ“ä½œéƒ½æ˜¯ synchronized çš„ï¼Œè¿™ç›¸å½“äºç»™æ•´ä¸ªå“ˆå¸Œè¡¨åŠ äº†ä¸€æŠŠå¤§é”ï¼Œå¤šçº¿ç¨‹è®¿é—®æ—¶å€™ï¼Œåªè¦æœ‰ä¸€ä¸ªçº¿ç¨‹è®¿é—®æˆ–æ“ä½œè¯¥å¯¹è±¡ï¼Œé‚£å…¶ä»–çº¿ç¨‹åªèƒ½é˜»å¡ï¼Œç›¸å½“äºå°†æ‰€æœ‰çš„æ“ä½œä¸²è¡ŒåŒ–ï¼Œåœ¨ç«äº‰æ¿€çƒˆçš„å¹¶å‘åœºæ™¯ä¸­æ€§èƒ½å°±ä¼šéå¸¸å·®ã€‚</p> <div align="center"><img src="/fullstack-tutorial-site/assets/img/hashtable-ds.99faac49.png" width="600"></div> <p>HashTable æ€§èƒ½å·®ä¸»è¦æ˜¯ç”±äºæ‰€æœ‰æ“ä½œéœ€è¦ç«äº‰åŒä¸€æŠŠé”ï¼Œè€Œå¦‚æœå®¹å™¨ä¸­æœ‰å¤šæŠŠé”ï¼Œæ¯ä¸€æŠŠé”é”ä¸€æ®µæ•°æ®ï¼Œè¿™æ ·åœ¨å¤šçº¿ç¨‹è®¿é—®æ—¶ä¸åŒæ®µçš„æ•°æ®æ—¶ï¼Œå°±ä¸ä¼šå­˜åœ¨é”ç«äº‰äº†ï¼Œè¿™æ ·ä¾¿å¯ä»¥æœ‰æ•ˆåœ°æé«˜å¹¶å‘æ•ˆç‡ã€‚è¿™å°±æ˜¯ConcurrentHashMap æ‰€é‡‡ç”¨çš„ &quot;<strong>åˆ†æ®µé”</strong>&quot; æ€æƒ³ã€‚</p> <div align="center"><img src="/fullstack-tutorial-site/assets/img/hashmap-ds.4f2df789.png" width="600"></div><br> <h4 id="_2-å­˜å‚¨ç»“æ„"><a href="#_2-å­˜å‚¨ç»“æ„" aria-hidden="true" class="header-anchor">#</a> 2. å­˜å‚¨ç»“æ„</h4> <p>ConcurrentHashMap é‡‡ç”¨äº†éå¸¸ç²¾å¦™çš„&quot;åˆ†æ®µé”&quot;ç­–ç•¥ï¼ŒConcurrentHashMap çš„ä¸»å¹²æ˜¯ä¸ª Segment æ•°ç»„ã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code> <span class="token keyword">final</span> Segment<span class="token generics function"><span class="token punctuation">&lt;</span>K<span class="token punctuation">,</span>V<span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> segments<span class="token punctuation">;</span>
</code></pre></div><p>Segment ç»§æ‰¿äº† ReentrantLockï¼Œæ‰€ä»¥å®ƒå°±æ˜¯ä¸€ç§å¯é‡å…¥é”ï¼ˆReentrantLock)ã€‚åœ¨ ConcurrentHashMapï¼Œä¸€ä¸ª Segment å°±æ˜¯ä¸€ä¸ªå­å“ˆå¸Œè¡¨ï¼ŒSegment é‡Œç»´æŠ¤äº†ä¸€ä¸ª HashEntry æ•°ç»„ï¼Œå¹¶å‘ç¯å¢ƒä¸‹ï¼Œå¯¹äºä¸åŒ Segment çš„æ•°æ®è¿›è¡Œæ“ä½œæ˜¯ä¸ç”¨è€ƒè™‘é”ç«äº‰çš„ã€‚ï¼ˆå°±æŒ‰é»˜è®¤çš„ ConcurrentLeve ä¸º16æ¥è®²ï¼Œç†è®ºä¸Šå°±å…è®¸ 16 ä¸ªçº¿ç¨‹å¹¶å‘æ‰§è¡Œï¼Œæœ‰æœ¨æœ‰å¾ˆé…·ï¼‰</p> <p><strong>æ‰€ä»¥ï¼Œå¯¹äºåŒä¸€ä¸ª Segment çš„æ“ä½œæ‰éœ€è€ƒè™‘çº¿ç¨‹åŒæ­¥ï¼Œä¸åŒçš„ Segment åˆ™æ— éœ€è€ƒè™‘ã€‚</strong></p> <p>Segment ç±»ä¼¼äº HashMapï¼Œä¸€ä¸ª Segment ç»´æŠ¤ç€ä¸€ä¸ª HashEntry æ•°ç»„</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">transient</span> <span class="token keyword">volatile</span> HashEntry<span class="token generics function"><span class="token punctuation">&lt;</span>K<span class="token punctuation">,</span>V<span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> table<span class="token punctuation">;</span>
</code></pre></div><p>HashEntry æ˜¯ç›®å‰æˆ‘ä»¬æåˆ°çš„æœ€å°çš„é€»è¾‘å¤„ç†å•å…ƒäº†ã€‚ä¸€ä¸ª ConcurrentHashMap ç»´æŠ¤ä¸€ä¸ª Segment æ•°ç»„ï¼Œä¸€ä¸ª Segment ç»´æŠ¤ä¸€ä¸ª HashEntry æ•°ç»„ã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">HashEntry</span><span class="token generics function"><span class="token punctuation">&lt;</span>K<span class="token punctuation">,</span>V<span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token keyword">final</span> <span class="token keyword">int</span> hash<span class="token punctuation">;</span>
    <span class="token keyword">final</span> K key<span class="token punctuation">;</span>
    <span class="token keyword">volatile</span> V value<span class="token punctuation">;</span>
    <span class="token keyword">volatile</span> HashEntry<span class="token generics function"><span class="token punctuation">&lt;</span>K<span class="token punctuation">,</span>V<span class="token punctuation">&gt;</span></span> next<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ConcurrentHashMap å’Œ HashMap å®ç°ä¸Šç±»ä¼¼ï¼Œæœ€ä¸»è¦çš„å·®åˆ«æ˜¯ ConcurrentHashMap é‡‡ç”¨äº†åˆ†æ®µé”ï¼ˆSegmentï¼‰ï¼Œæ¯ä¸ªåˆ†æ®µé”ç»´æŠ¤ç€å‡ ä¸ªæ¡¶ï¼ˆHashEntryï¼‰ï¼Œå¤šä¸ªçº¿ç¨‹å¯ä»¥åŒæ—¶è®¿é—®ä¸åŒåˆ†æ®µé”ä¸Šçš„æ¡¶ï¼Œä»è€Œä½¿å…¶å¹¶å‘åº¦æ›´é«˜ï¼ˆå¹¶å‘åº¦å°±æ˜¯ Segment çš„ä¸ªæ•°ï¼‰ã€‚</p> <p>Segment ç»§æ‰¿è‡ª <strong>ReentrantLock</strong>ã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">Segment</span><span class="token generics function"><span class="token punctuation">&lt;</span>K<span class="token punctuation">,</span>V<span class="token punctuation">&gt;</span></span> <span class="token keyword">extends</span> <span class="token class-name">ReentrantLock</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> <span class="token number">2249069246763182397</span>L<span class="token punctuation">;</span>

    <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> MAX_SCAN_RETRIES <span class="token operator">=</span>
        Runtime<span class="token punctuation">.</span><span class="token function">getRuntime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">availableProcessors</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token operator">?</span> <span class="token number">64</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>

    <span class="token keyword">transient</span> <span class="token keyword">volatile</span> HashEntry<span class="token generics function"><span class="token punctuation">&lt;</span>K<span class="token punctuation">,</span>V<span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> table<span class="token punctuation">;</span>

    <span class="token keyword">transient</span> <span class="token keyword">int</span> count<span class="token punctuation">;</span>

    <span class="token keyword">transient</span> <span class="token keyword">int</span> modCount<span class="token punctuation">;</span>

    <span class="token keyword">transient</span> <span class="token keyword">int</span> threshold<span class="token punctuation">;</span>

    <span class="token keyword">final</span> <span class="token keyword">float</span> loadFactor<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">final</span> Segment<span class="token generics function"><span class="token punctuation">&lt;</span>K<span class="token punctuation">,</span>V<span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> segments<span class="token punctuation">;</span>
</code></pre></div><p>é»˜è®¤çš„å¹¶å‘çº§åˆ«ä¸º 16ï¼Œä¹Ÿå°±æ˜¯è¯´é»˜è®¤åˆ›å»º 16 ä¸ª Segmentã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> DEFAULT_CONCURRENCY_LEVEL <span class="token operator">=</span> <span class="token number">16</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="_2-size-æ“ä½œ"><a href="#_2-size-æ“ä½œ" aria-hidden="true" class="header-anchor">#</a> 2. size æ“ä½œ</h4> <p>æ¯ä¸ª Segment ç»´æŠ¤äº†ä¸€ä¸ª count å˜é‡æ¥ç»Ÿè®¡è¯¥ Segment ä¸­çš„é”®å€¼å¯¹ä¸ªæ•°ã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * The number of elements. Accessed only either within locks
 * or among other volatile reads that maintain visibility.
 */</span>
<span class="token keyword">transient</span> <span class="token keyword">int</span> count<span class="token punctuation">;</span>
</code></pre></div><p>åœ¨æ‰§è¡Œ size æ“ä½œæ—¶ï¼Œéœ€è¦éå†æ‰€æœ‰ Segment ç„¶åæŠŠ count ç´¯è®¡èµ·æ¥ã€‚</p> <p>ConcurrentHashMap åœ¨æ‰§è¡Œ size æ“ä½œæ—¶å…ˆå°è¯•ä¸åŠ é”ï¼Œå¦‚æœè¿ç»­ä¸¤æ¬¡ä¸åŠ é”æ“ä½œå¾—åˆ°çš„ç»“æœä¸€è‡´ï¼Œé‚£ä¹ˆå¯ä»¥è®¤ä¸ºè¿™ä¸ªç»“æœæ˜¯æ­£ç¡®çš„ã€‚</p> <p>å°è¯•æ¬¡æ•°ä½¿ç”¨ RETRIES_BEFORE_LOCK å®šä¹‰ï¼Œè¯¥å€¼ä¸º 2ï¼Œretries åˆå§‹å€¼ä¸º -1ï¼Œå› æ­¤å°è¯•æ¬¡æ•°ä¸º 3ã€‚</p> <p>å¦‚æœå°è¯•çš„æ¬¡æ•°è¶…è¿‡ 3 æ¬¡ï¼Œå°±éœ€è¦å¯¹æ¯ä¸ª Segment åŠ é”ã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * Number of unsynchronized retries in size and containsValue
 * methods before resorting to locking. This is used to avoid
 * unbounded retries if tables undergo continuous modification
 * which would make it impossible to obtain an accurate result.
 */</span>
<span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> RETRIES_BEFORE_LOCK <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Try a few times to get accurate count. On failure due to</span>
    <span class="token comment">// continuous async changes in table, resort to locking.</span>
    <span class="token keyword">final</span> Segment<span class="token generics function"><span class="token punctuation">&lt;</span>K<span class="token punctuation">,</span>V<span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> segments <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>segments<span class="token punctuation">;</span>
    <span class="token keyword">int</span> size<span class="token punctuation">;</span>
    <span class="token keyword">boolean</span> overflow<span class="token punctuation">;</span> <span class="token comment">// true if size overflows 32 bits</span>
    <span class="token keyword">long</span> sum<span class="token punctuation">;</span>         <span class="token comment">// sum of modCounts</span>
    <span class="token keyword">long</span> last <span class="token operator">=</span> <span class="token number">0</span>L<span class="token punctuation">;</span>   <span class="token comment">// previous sum</span>
    <span class="token keyword">int</span> retries <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// first iteration isn't retry</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// è¶…è¿‡å°è¯•æ¬¡æ•°ï¼Œåˆ™å¯¹æ¯ä¸ª Segment åŠ é”</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>retries<span class="token operator">++</span> <span class="token operator">==</span> RETRIES_BEFORE_LOCK<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> segments<span class="token punctuation">.</span>length<span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span>
                    <span class="token function">ensureSegment</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// force creation</span>
            <span class="token punctuation">}</span>
            sum <span class="token operator">=</span> <span class="token number">0</span>L<span class="token punctuation">;</span>
            size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            overflow <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> segments<span class="token punctuation">.</span>length<span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                Segment<span class="token generics function"><span class="token punctuation">&lt;</span>K<span class="token punctuation">,</span>V<span class="token punctuation">&gt;</span></span> seg <span class="token operator">=</span> <span class="token function">segmentAt</span><span class="token punctuation">(</span>segments<span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>seg <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    sum <span class="token operator">+=</span> seg<span class="token punctuation">.</span>modCount<span class="token punctuation">;</span>
                    <span class="token keyword">int</span> c <span class="token operator">=</span> seg<span class="token punctuation">.</span>count<span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>c <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span> <span class="token punctuation">(</span>size <span class="token operator">+=</span> c<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
                        overflow <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token comment">// è¿ç»­ä¸¤æ¬¡å¾—åˆ°çš„ç»“æœä¸€è‡´ï¼Œåˆ™è®¤ä¸ºè¿™ä¸ªç»“æœæ˜¯æ­£ç¡®çš„</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>sum <span class="token operator">==</span> last<span class="token punctuation">)</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            last <span class="token operator">=</span> sum<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>retries <span class="token operator">&gt;</span> RETRIES_BEFORE_LOCK<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> segments<span class="token punctuation">.</span>length<span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span>
                <span class="token function">segmentAt</span><span class="token punctuation">(</span>segments<span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> overflow <span class="token operator">?</span> Integer<span class="token punctuation">.</span>MAX_VALUE <span class="token operator">:</span> size<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_3-åŒæ­¥æ–¹å¼"><a href="#_3-åŒæ­¥æ–¹å¼" aria-hidden="true" class="header-anchor">#</a> 3. åŒæ­¥æ–¹å¼</h4> <p>Segment ç»§æ‰¿è‡ª ReentrantLockï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¾ˆæ–¹ä¾¿çš„å¯¹æ¯ä¸€ä¸ª Segment ä¸Šé”ã€‚</p> <p>å¯¹äºè¯»æ“ä½œï¼Œè·å– Key æ‰€åœ¨çš„ Segment æ—¶ï¼Œéœ€è¦ä¿è¯å¯è§æ€§ã€‚å…·ä½“å®ç°ä¸Šå¯ä»¥ä½¿ç”¨ volatile å…³é”®å­—ï¼Œä¹Ÿå¯ä½¿ç”¨é”ã€‚ä½†ä½¿ç”¨é”å¼€é”€å¤ªå¤§ï¼Œè€Œä½¿ç”¨ volatile æ—¶æ¯æ¬¡å†™æ“ä½œéƒ½ä¼šè®©æ‰€æœ‰ CPU å†…ç¼“å­˜æ— æ•ˆï¼Œä¹Ÿæœ‰ä¸€å®šå¼€é”€ã€‚ConcurrentHashMap ä½¿ç”¨å¦‚ä¸‹æ–¹æ³•ä¿è¯å¯è§æ€§ï¼Œå–å¾—æœ€æ–°çš„ Segmentã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code>Segment<span class="token generics function"><span class="token punctuation">&lt;</span>K<span class="token punctuation">,</span>V<span class="token punctuation">&gt;</span></span> s <span class="token operator">=</span> <span class="token punctuation">(</span>Segment<span class="token generics function"><span class="token punctuation">&lt;</span>K<span class="token punctuation">,</span>V<span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span>UNSAFE<span class="token punctuation">.</span><span class="token function">getObjectVolatile</span><span class="token punctuation">(</span>segments<span class="token punctuation">,</span> u<span class="token punctuation">)</span>
</code></pre></div><p>è·å– Segment ä¸­çš„ HashEntry æ—¶ä¹Ÿä½¿ç”¨äº†ç±»ä¼¼æ–¹æ³•</p> <div class="language-java extra-class"><pre class="language-java"><code>HashEntry<span class="token generics function"><span class="token punctuation">&lt;</span>K<span class="token punctuation">,</span>V<span class="token punctuation">&gt;</span></span> e <span class="token operator">=</span> <span class="token punctuation">(</span>HashEntry<span class="token generics function"><span class="token punctuation">&lt;</span>K<span class="token punctuation">,</span>V<span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span> UNSAFE<span class="token punctuation">.</span>getObjectVolatile
  <span class="token punctuation">(</span>tab<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>tab<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> h<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> TSHIFT<span class="token punctuation">)</span> <span class="token operator">+</span> TBASE<span class="token punctuation">)</span>
</code></pre></div><p>å¯¹äºå†™æ“ä½œï¼Œå¹¶ä¸è¦æ±‚åŒæ—¶è·å–æ‰€æœ‰ Segment çš„é”ï¼Œå› ä¸ºé‚£æ ·ç›¸å½“äºé”ä½äº†æ•´ä¸ª Mapã€‚å®ƒä¼šå…ˆè·å–è¯¥ Key-Value å¯¹æ‰€åœ¨çš„ Segment çš„é”ï¼Œè·å–æˆåŠŸåå°±å¯ä»¥åƒæ“ä½œä¸€ä¸ªæ™®é€šçš„ HashMap ä¸€æ ·æ“ä½œè¯¥ Segmentï¼Œå¹¶ä¿è¯è¯¥Segment çš„å®‰å…¨æ€§ã€‚
åŒæ—¶ç”±äºå…¶å®ƒ Segment çš„é”å¹¶æœªè¢«è·å–ï¼Œå› æ­¤ç†è®ºä¸Šå¯æ”¯æŒ concurrencyLevelï¼ˆç­‰äº Segment çš„ä¸ªæ•°ï¼‰ä¸ªçº¿ç¨‹å®‰å…¨çš„å¹¶å‘è¯»å†™ã€‚</p> <p>è·å–é”æ—¶ï¼Œå¹¶ä¸ç›´æ¥ä½¿ç”¨ lock æ¥è·å–ï¼Œå› ä¸ºè¯¥æ–¹æ³•è·å–é”å¤±è´¥æ—¶ä¼šæŒ‚èµ·ã€‚äº‹å®ä¸Šï¼Œå®ƒä½¿ç”¨äº†è‡ªæ—‹é”ï¼Œå¦‚æœ tryLock è·å–é”å¤±è´¥ï¼Œè¯´æ˜é”è¢«å…¶å®ƒçº¿ç¨‹å ç”¨ï¼Œæ­¤æ—¶é€šè¿‡å¾ªç¯å†æ¬¡ä»¥ tryLock çš„æ–¹å¼ç”³è¯·é”ã€‚å¦‚æœåœ¨å¾ªç¯è¿‡ç¨‹ä¸­è¯¥ Key æ‰€å¯¹åº”çš„é“¾è¡¨å¤´è¢«ä¿®æ”¹ï¼Œåˆ™é‡ç½® retry æ¬¡æ•°ã€‚å¦‚æœ retry æ¬¡æ•°è¶…è¿‡ä¸€å®šå€¼ï¼Œåˆ™ä½¿ç”¨ lock æ–¹æ³•ç”³è¯·é”ã€‚</p> <p>è¿™é‡Œä½¿ç”¨è‡ªæ—‹é”æ˜¯å› ä¸ºè‡ªæ—‹é”çš„æ•ˆç‡æ¯”è¾ƒé«˜ï¼Œä½†æ˜¯å®ƒæ¶ˆè€— CPU èµ„æºæ¯”è¾ƒå¤šï¼Œå› æ­¤åœ¨è‡ªæ—‹æ¬¡æ•°è¶…è¿‡é˜ˆå€¼æ—¶åˆ‡æ¢ä¸ºäº’æ–¥é”ã€‚</p> <h4 id="_4-jdk-1-8-çš„æ”¹åŠ¨"><a href="#_4-jdk-1-8-çš„æ”¹åŠ¨" aria-hidden="true" class="header-anchor">#</a> 4. JDK 1.8 çš„æ”¹åŠ¨</h4> <ul><li><p>JDK 1.7 ä½¿ç”¨åˆ†æ®µé”æœºåˆ¶æ¥å®ç°å¹¶å‘æ›´æ–°æ“ä½œï¼Œæ ¸å¿ƒç±»ä¸º Segmentï¼Œå®ƒç»§æ‰¿è‡ªé‡å…¥é” ReentrantLockï¼Œå¹¶å‘ç¨‹åº¦ä¸ Segment æ•°é‡ç›¸ç­‰ã€‚</p></li> <li><p>JDK 1.8 ä½¿ç”¨äº† CAS æ“ä½œæ¥æ”¯æŒæ›´é«˜çš„å¹¶å‘åº¦ï¼Œåœ¨ CAS æ“ä½œå¤±è´¥æ—¶ä½¿ç”¨å†…ç½®é” synchronizedã€‚</p></li> <li><p>å¹¶ä¸” JDK 1.8 çš„å®ç°ä¹Ÿåœ¨é“¾è¡¨è¿‡é•¿æ—¶ä¼šè½¬æ¢ä¸ºçº¢é»‘æ ‘ã€‚</p></li></ul> <p>å‚è€ƒèµ„æ–™ï¼š</p> <ul><li><p><a href="http://www.jasongj.com/java/concurrenthashmap/" target="_blank" rel="noopener noreferrer">ConcurrentHashMapæ¼”è¿›ä»Java7åˆ°Java8<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li> <li><p><a href="https://www.cnblogs.com/chengxiao/p/6842045.html" target="_blank" rel="noopener noreferrer">ConcurrentHashMapå®ç°åŸç†åŠæºç åˆ†æ - dreamcatcher-cx - åšå®¢å›­<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li></ul> <h3 id="hashset"><a href="#hashset" aria-hidden="true" class="header-anchor">#</a> HashSet</h3> <p>å‰é¢å·²ç»è¯´è¿‡ HashSet æ˜¯å¯¹ HashMap çš„ç®€å•åŒ…è£…ï¼Œå¯¹ HashSet çš„å‡½æ•°è°ƒç”¨éƒ½ä¼šè½¬æ¢æˆåˆé€‚çš„ HashMap æ–¹æ³•ï¼Œå› æ­¤ HashSet çš„å®ç°éå¸¸ç®€å•ï¼Œåªæœ‰ä¸åˆ° 300 è¡Œä»£ç ï¼ˆé€‚é…å™¨æ¨¡å¼ï¼‰ã€‚è¿™é‡Œä¸å†èµ˜è¿°ã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">//HashSetæ˜¯å¯¹HashMapçš„ç®€å•åŒ…è£…</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HashSet</span><span class="token generics function"><span class="token punctuation">&lt;</span>E<span class="token punctuation">&gt;</span></span>
<span class="token punctuation">{</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
	<span class="token keyword">private</span> <span class="token keyword">transient</span> HashMap<span class="token generics function"><span class="token punctuation">&lt;</span>E<span class="token punctuation">,</span>Object<span class="token punctuation">&gt;</span></span> map<span class="token punctuation">;</span><span class="token comment">//HashSeté‡Œé¢æœ‰ä¸€ä¸ªHashMap</span>
    <span class="token comment">// Dummy value to associate with an Object in the backing Map</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> Object PRESENT <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token function">HashSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token operator">&lt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">add</span><span class="token punctuation">(</span>E e<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//ç®€å•çš„æ–¹æ³•è½¬æ¢</span>
        <span class="token keyword">return</span> map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> PRESENT<span class="token punctuation">)</span><span class="token operator">==</span>null<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_1-æˆå‘˜å˜é‡"><a href="#_1-æˆå‘˜å˜é‡" aria-hidden="true" class="header-anchor">#</a> 1. æˆå‘˜å˜é‡</h4> <p>é¦–å…ˆäº†è§£ä¸‹ <code>HashSet</code> çš„æˆå‘˜å˜é‡:</p> <div class="language-java extra-class"><pre class="language-java"><code>    <span class="token keyword">private</span> <span class="token keyword">transient</span> HashMap<span class="token generics function"><span class="token punctuation">&lt;</span>E<span class="token punctuation">,</span>Object<span class="token punctuation">&gt;</span></span> map<span class="token punctuation">;</span>

    <span class="token comment">// Dummy value to associate with an Object in the backing Map</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> Object PRESENT <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>å‘ç°ä¸»è¦å°±ä¸¤ä¸ªå˜é‡:</p> <ul><li><code>map</code> ï¼šç”¨äºå­˜æ”¾æœ€ç»ˆæ•°æ®çš„ã€‚</li> <li><code>PRESENT</code> ï¼šæ˜¯æ‰€æœ‰å†™å…¥ map çš„ <code>value</code> å€¼ã€‚</li></ul> <h4 id="_2-æ„é€ å‡½æ•°"><a href="#_2-æ„é€ å‡½æ•°" aria-hidden="true" class="header-anchor">#</a> 2. æ„é€ å‡½æ•°</h4> <div class="language-java extra-class"><pre class="language-java"><code>    <span class="token keyword">public</span> <span class="token function">HashSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token operator">&lt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">public</span> <span class="token function">HashSet</span><span class="token punctuation">(</span><span class="token keyword">int</span> initialCapacity<span class="token punctuation">,</span> <span class="token keyword">float</span> loadFactor<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token operator">&lt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>initialCapacity<span class="token punctuation">,</span> loadFactor<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>    
</code></pre></div><p>æ„é€ å‡½æ•°å¾ˆç®€å•ï¼Œåˆ©ç”¨äº† <code>HashMap</code> åˆå§‹åŒ–äº† <code>map</code> ã€‚</p> <h4 id="_3-add"><a href="#_3-add" aria-hidden="true" class="header-anchor">#</a> 3. add()</h4> <div class="language-java extra-class"><pre class="language-java"><code>    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">add</span><span class="token punctuation">(</span>E e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> PRESENT<span class="token punctuation">)</span><span class="token operator">==</span>null<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><p>æ¯”è¾ƒå…³é”®çš„å°±æ˜¯è¿™ä¸ª <code>add()</code> æ–¹æ³•ã€‚ å¯ä»¥çœ‹å‡ºå®ƒæ˜¯å°†å­˜æ”¾çš„å¯¹è±¡å½“åšäº† <code>HashMap</code> çš„å¥ï¼Œ<code>value</code> éƒ½æ˜¯ç›¸åŒçš„ <code>PRESENT</code> ã€‚ç”±äº <code>HashMap</code> çš„ <code>key</code> æ˜¯ä¸èƒ½é‡å¤çš„ï¼Œæ‰€ä»¥æ¯å½“æœ‰é‡å¤çš„å€¼å†™å…¥åˆ° <code>HashSet</code> æ—¶ï¼Œ<code>value</code> ä¼šè¢«è¦†ç›–ï¼Œä½† <code>key</code> ä¸ä¼šæ”¶åˆ°å½±å“ï¼Œè¿™æ ·å°±ä¿è¯äº† <code>HashSet</code> ä¸­åªèƒ½å­˜æ”¾ä¸é‡å¤çš„å…ƒç´ ã€‚</p> <h4 id="_4-æ€»ç»“"><a href="#_4-æ€»ç»“" aria-hidden="true" class="header-anchor">#</a> 4. æ€»ç»“</h4> <p><code>HashSet</code> çš„åŸç†æ¯”è¾ƒç®€å•ï¼Œå‡ ä¹å…¨éƒ¨å€ŸåŠ©äº <code>HashMap</code> æ¥å®ç°çš„ã€‚</p> <p>æ‰€ä»¥ <code>HashMap</code> ä¼šå‡ºç°çš„é—®é¢˜ <code>HashSet</code> ä¾ç„¶ä¸èƒ½é¿å…ã€‚</p> <h3 id="linkedhashset-and-linkedhashmap"><a href="#linkedhashset-and-linkedhashmap" aria-hidden="true" class="header-anchor">#</a> LinkedHashSet and LinkedHashMap</h3> <h4 id="_1-æ¦‚è§ˆ-3"><a href="#_1-æ¦‚è§ˆ-3" aria-hidden="true" class="header-anchor">#</a> 1. æ¦‚è§ˆ</h4> <p>å¦‚æœä½ å·²çœ‹è¿‡å‰é¢å…³äº HashSet å’Œ HashMapï¼Œçš„è®²è§£ï¼Œä¸€å®šèƒ½å¤Ÿæƒ³åˆ°æœ¬æ–‡å°†è¦è®²è§£çš„ LinkedHashSet å’Œ LinkedHashMap å…¶å®ä¹Ÿæ˜¯ä¸€å›äº‹ã€‚ LinkedHashSet å’Œ LinkedHashMap åœ¨ Java é‡Œä¹Ÿæœ‰ç€ç›¸åŒçš„å®ç°ï¼Œå‰è€…ä»…ä»…æ˜¯å¯¹åè€…åšäº†ä¸€å±‚åŒ…è£…ï¼Œä¹Ÿå°±æ˜¯è¯´ LinkedHashSet é‡Œé¢æœ‰ä¸€ä¸ª LinkedHashMapï¼ˆ<strong>é€‚é…å™¨æ¨¡å¼</strong>ï¼‰ã€‚å› æ­¤æœ¬æ–‡å°†é‡ç‚¹åˆ†æ LinkedHashMapã€‚</p> <p>LinkedHashMap å®ç°äº† Map æ¥å£ï¼Œå³å…è®¸æ”¾å…¥ key ä¸º null çš„å…ƒç´ ï¼Œä¹Ÿå…è®¸æ’å…¥ value ä¸º null çš„å…ƒç´ ã€‚ä»åå­—ä¸Šå¯ä»¥çœ‹å‡ºè¯¥å®¹å™¨æ˜¯ LinkedList å’Œ HashMap çš„æ··åˆä½“ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒåŒæ—¶æ»¡è¶³ HashMap å’Œ LinkedList çš„æŸäº›ç‰¹æ€§ã€‚<strong>å¯å°† LinkedHashMap çœ‹ä½œé‡‡ç”¨ LinkedList å¢å¼ºçš„ HashMapã€‚</strong></p> <div align="center"><img src="/fullstack-tutorial-site/assets/img/LinkedHashMap_base.fb5595a8.png" width="650"></div><br> <p>äº‹å®ä¸Š LinkedHashMap æ˜¯ HashMap çš„ç›´æ¥å­ç±»ï¼Œ<strong>äºŒè€…å”¯ä¸€çš„åŒºåˆ«æ˜¯ LinkedHashMap åœ¨ HashMap çš„åŸºç¡€ä¸Šï¼Œé‡‡ç”¨åŒå‘é“¾è¡¨ï¼ˆdoubly-linked listï¼‰çš„å½¢å¼å°†æ‰€æœ‰ entry è¿æ¥èµ·æ¥ï¼Œè¿™æ ·æ˜¯ä¸ºä¿è¯å…ƒç´ çš„è¿­ä»£é¡ºåºè·Ÿæ’å…¥é¡ºåºç›¸åŒ</strong>ã€‚ä¸Šå›¾ç»™å‡ºäº† LinkedHashMap çš„ç»“æ„å›¾ï¼Œä¸»ä½“éƒ¨åˆ†è·Ÿ HashMap å®Œå…¨ä¸€æ ·ï¼Œå¤šäº† <code>header</code> æŒ‡å‘åŒå‘é“¾è¡¨çš„å¤´éƒ¨ï¼ˆæ˜¯ä¸€ä¸ªå“‘å…ƒï¼‰ï¼Œ<strong>è¯¥åŒå‘é“¾è¡¨çš„è¿­ä»£é¡ºåºå°±æ˜¯ entry çš„æ’å…¥é¡ºåº</strong>ã€‚</p> <p>é™¤äº†å¯ä»¥ä¿è¿­ä»£å†é¡ºåºï¼Œè¿™ç§ç»“æ„è¿˜æœ‰ä¸€ä¸ªå¥½å¤„ï¼š<strong>è¿­ä»£ LinkedHashMap æ—¶ä¸éœ€è¦åƒ HashMap é‚£æ ·éå†æ•´ä¸ªtableï¼Œè€Œåªéœ€è¦ç›´æ¥éå† header æŒ‡å‘çš„åŒå‘é“¾è¡¨å³å¯</strong>ï¼Œä¹Ÿå°±æ˜¯è¯´ LinkedHashMap çš„è¿­ä»£æ—¶é—´å°±åªè·Ÿ<code>entry</code>çš„ä¸ªæ•°ç›¸å…³ï¼Œè€Œè·Ÿ<code>table</code>çš„å¤§å°æ— å…³ã€‚</p> <p>æœ‰ä¸¤ä¸ªå‚æ•°å¯ä»¥å½±å“ LinkedHashMap çš„æ€§èƒ½ï¼š<strong>åˆå§‹å®¹é‡</strong>ï¼ˆinital capacityï¼‰å’Œ<strong>è´Ÿè½½ç³»æ•°</strong>ï¼ˆload factorï¼‰ã€‚åˆå§‹å®¹é‡æŒ‡å®šäº†åˆå§‹<code>table</code>çš„å¤§å°ï¼Œè´Ÿè½½ç³»æ•°ç”¨æ¥æŒ‡å®šè‡ªåŠ¨æ‰©å®¹çš„ä¸´ç•Œå€¼ã€‚å½“<code>entry</code>çš„æ•°é‡è¶…è¿‡<code>capacity*load_factor</code>æ—¶ï¼Œå®¹å™¨å°†è‡ªåŠ¨æ‰©å®¹å¹¶é‡æ–°å“ˆå¸Œã€‚å¯¹äºæ’å…¥å…ƒç´ è¾ƒå¤šçš„åœºæ™¯ï¼Œå°†åˆå§‹å®¹é‡è®¾å¤§å¯ä»¥å‡å°‘é‡æ–°å“ˆå¸Œçš„æ¬¡æ•°ã€‚</p> <p>å°†å¯¹è±¡æ”¾å…¥åˆ° LinkedHashMap æˆ– LinkedHashSet ä¸­æ—¶ï¼Œæœ‰ä¸¤ä¸ªæ–¹æ³•éœ€è¦ç‰¹åˆ«å…³å¿ƒï¼š<code>hashCode()</code> å’Œ <code>equals()</code>ã€‚<strong>hashCode() æ–¹æ³•å†³å®šäº†å¯¹è±¡ä¼šè¢«æ”¾åˆ°å“ªä¸ª bucket é‡Œï¼Œå½“å¤šä¸ªå¯¹è±¡çš„å“ˆå¸Œå€¼å†²çªæ—¶ï¼Œequals() æ–¹æ³•å†³å®šäº†è¿™äº›å¯¹è±¡æ˜¯å¦æ˜¯â€œåŒä¸€ä¸ªå¯¹è±¡â€</strong>ã€‚æ‰€ä»¥ï¼Œå¦‚æœè¦å°†è‡ªå®šä¹‰çš„å¯¹è±¡æ”¾å…¥åˆ° <code>LinkedHashMap</code> æˆ– <code>LinkedHashSet</code> ä¸­ï¼Œéœ€è¦ <em>@Override</em><code>hashCode()</code> å’Œ <code>equals()</code> æ–¹æ³•ã€‚</p> <p>é€šè¿‡å¦‚ä¸‹æ–¹å¼å¯ä»¥å¾—åˆ°ä¸€ä¸ªè·Ÿæº Map è¿­ä»£é¡ºåº ä¸€æ ·çš„ LinkedHashMapï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">void</span> <span class="token function">foo</span><span class="token punctuation">(</span>Map m<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Map copy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedHashMap</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre></div><p>å‡ºäºæ€§èƒ½åŸå› ï¼ŒLinkedHashMap æ˜¯éåŒæ­¥çš„ï¼ˆnot synchronizedï¼‰ï¼Œå¦‚æœéœ€è¦åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä½¿ç”¨ï¼Œéœ€è¦ç¨‹åºå‘˜æ‰‹åŠ¨åŒæ­¥ï¼›æˆ–è€…é€šè¿‡å¦‚ä¸‹æ–¹å¼å°† LinkedHashMap åŒ…è£…æˆï¼ˆwrappedï¼‰åŒæ­¥çš„ï¼š</p> <p><code>Map m = Collections.synchronizedMap(new LinkedHashMap(...));</code></p> <h4 id="_2-get"><a href="#_2-get" aria-hidden="true" class="header-anchor">#</a> 2. get()</h4> <p><code>get(Object key)</code> æ–¹æ³•æ ¹æ®æŒ‡å®šçš„ <code>key</code> å€¼è¿”å›å¯¹åº”çš„ <code>value</code>ã€‚è¯¥æ–¹æ³•è·Ÿ<code>HashMap.get()</code>æ–¹æ³•çš„æµç¨‹å‡ ä¹å®Œå…¨ä¸€æ ·ï¼Œè¯»è€…å¯è‡ªè¡Œ<a href="https://github.com/CarpenterLee/JCFInternals/blob/master/markdown/6-HashSet%20and%20HashMap.md#get" target="_blank" rel="noopener noreferrer">å‚è€ƒå‰æ–‡<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚</p> <h4 id="_3-put"><a href="#_3-put" aria-hidden="true" class="header-anchor">#</a> 3. put()</h4> <p><code>put(K key, V value)</code> æ–¹æ³•æ˜¯å°†æŒ‡å®šçš„ <code>key, value</code> å¯¹æ·»åŠ åˆ° <code>map</code> é‡Œã€‚è¯¥æ–¹æ³•é¦–å…ˆä¼šå¯¹ <code>map</code> åšä¸€æ¬¡æŸ¥æ‰¾ï¼Œçœ‹æ˜¯å¦åŒ…å«è¯¥å…ƒç»„ï¼Œå¦‚æœå·²ç»åŒ…å«åˆ™ç›´æ¥è¿”å›ï¼ŒæŸ¥æ‰¾è¿‡ç¨‹ç±»ä¼¼äº<code>get()</code>æ–¹æ³•ï¼›å¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œåˆ™ä¼šé€šè¿‡ <code>addEntry(int hash, K key, V value, int bucketIndex)</code> æ–¹æ³•æ’å…¥æ–°çš„ <code>entry</code>ã€‚</p> <p>æ³¨æ„ï¼Œè¿™é‡Œçš„<strong>æ’å…¥æœ‰ä¸¤é‡å«ä¹‰</strong>ï¼š</p> <blockquote><ol><li>ä» table çš„è§’åº¦çœ‹ï¼Œæ–°çš„ entry éœ€è¦æ’å…¥åˆ°å¯¹åº”çš„ bucket é‡Œï¼Œå½“æœ‰å“ˆå¸Œå†²çªæ—¶ï¼Œé‡‡ç”¨å¤´æ’æ³•å°†æ–°çš„ entry æ’å…¥åˆ°å†²çªé“¾è¡¨çš„å¤´éƒ¨ã€‚</li> <li>ä» header çš„è§’åº¦çœ‹ï¼Œæ–°çš„ entry éœ€è¦æ’å…¥åˆ°åŒå‘é“¾è¡¨çš„å°¾éƒ¨ã€‚</li></ol></blockquote> <div align="center"><img src="/fullstack-tutorial-site/assets/img/LinkedHashMap_addEntry.a4294b3a.png" width="650"></div> <p><code>addEntry()</code>ä»£ç å¦‚ä¸‹ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// LinkedHashMap.addEntry()</span>
<span class="token keyword">void</span> <span class="token function">addEntry</span><span class="token punctuation">(</span><span class="token keyword">int</span> hash<span class="token punctuation">,</span> K key<span class="token punctuation">,</span> V value<span class="token punctuation">,</span> <span class="token keyword">int</span> bucketIndex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>size <span class="token operator">&gt;=</span> threshold<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>null <span class="token operator">!=</span> table<span class="token punctuation">[</span>bucketIndex<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">resize</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> table<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// è‡ªåŠ¨æ‰©å®¹ï¼Œå¹¶é‡æ–°å“ˆå¸Œ</span>
        hash <span class="token operator">=</span> <span class="token punctuation">(</span>null <span class="token operator">!=</span> key<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token function">hash</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
        bucketIndex <span class="token operator">=</span> hash <span class="token operator">&amp;</span> <span class="token punctuation">(</span>table<span class="token punctuation">.</span>length<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// hash%table.length</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 1.åœ¨å†²çªé“¾è¡¨å¤´éƒ¨æ’å…¥æ–°çš„entry</span>
    HashMap<span class="token punctuation">.</span>Entry<span class="token generics function"><span class="token punctuation">&lt;</span>K<span class="token punctuation">,</span>V<span class="token punctuation">&gt;</span></span> old <span class="token operator">=</span> table<span class="token punctuation">[</span>bucketIndex<span class="token punctuation">]</span><span class="token punctuation">;</span>
    Entry<span class="token generics function"><span class="token punctuation">&lt;</span>K<span class="token punctuation">,</span>V<span class="token punctuation">&gt;</span></span> e <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Entry</span><span class="token operator">&lt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>hash<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> old<span class="token punctuation">)</span><span class="token punctuation">;</span>
    table<span class="token punctuation">[</span>bucketIndex<span class="token punctuation">]</span> <span class="token operator">=</span> e<span class="token punctuation">;</span>
    <span class="token comment">// 2.åœ¨åŒå‘é“¾è¡¨çš„å°¾éƒ¨æ’å…¥æ–°çš„entry</span>
    e<span class="token punctuation">.</span><span class="token function">addBefore</span><span class="token punctuation">(</span>header<span class="token punctuation">)</span><span class="token punctuation">;</span>
    size<span class="token operator">++</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ä¸Šè¿°ä»£ç ä¸­ç”¨åˆ°äº† <code>addBefore()</code>æ–¹ æ³•å°†æ–° <code>entry e</code> æ’å…¥åˆ°åŒå‘é“¾è¡¨å¤´å¼•ç”¨ <code>header</code> çš„å‰é¢ï¼Œè¿™æ · <code>e</code> å°±æˆä¸ºåŒå‘é“¾è¡¨ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ ã€‚<code>addBefore()</code> çš„ä»£ç å¦‚ä¸‹ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// LinkedHashMap.Entry.addBefor()ï¼Œå°†thisæ’å…¥åˆ°existingEntryçš„å‰é¢</span>
<span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">addBefore</span><span class="token punctuation">(</span>Entry<span class="token generics function"><span class="token punctuation">&lt;</span>K<span class="token punctuation">,</span>V<span class="token punctuation">&gt;</span></span> existingEntry<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    after  <span class="token operator">=</span> existingEntry<span class="token punctuation">;</span>
    before <span class="token operator">=</span> existingEntry<span class="token punctuation">.</span>before<span class="token punctuation">;</span>
    before<span class="token punctuation">.</span>after <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    after<span class="token punctuation">.</span>before <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ä¸Šè¿°ä»£ç åªæ˜¯ç®€å•ä¿®æ”¹ç›¸å…³ <code>entry</code> çš„å¼•ç”¨è€Œå·²ã€‚</p> <h4 id="_4-remove"><a href="#_4-remove" aria-hidden="true" class="header-anchor">#</a> 4. remove()</h4> <p><code>remove(Object key)</code>çš„ä½œç”¨æ˜¯åˆ é™¤<code>key</code>å€¼å¯¹åº”çš„<code>entry</code>ï¼Œè¯¥æ–¹æ³•çš„å…·ä½“é€»è¾‘æ˜¯åœ¨<code>removeEntryForKey(Object key)</code>é‡Œå®ç°çš„ã€‚<code>removeEntryForKey()</code>æ–¹æ³•ä¼šé¦–å…ˆæ‰¾åˆ°<code>key</code>å€¼å¯¹åº”çš„<code>entry</code>ï¼Œç„¶ååˆ é™¤è¯¥<code>entry</code>ï¼ˆä¿®æ”¹é“¾è¡¨çš„ç›¸åº”å¼•ç”¨ï¼‰ã€‚æŸ¥æ‰¾è¿‡ç¨‹è·Ÿ<code>get()</code>æ–¹æ³•ç±»ä¼¼ã€‚</p> <p>æ³¨æ„ï¼Œè¿™é‡Œçš„<strong>åˆ é™¤ä¹Ÿæœ‰ä¸¤é‡å«ä¹‰</strong>ï¼š</p> <blockquote><ol><li>ä»<code>table</code>çš„è§’åº¦çœ‹ï¼Œéœ€è¦å°†è¯¥<code>entry</code>ä»å¯¹åº”çš„<code>bucket</code>é‡Œåˆ é™¤ï¼Œå¦‚æœå¯¹åº”çš„å†²çªé“¾è¡¨ä¸ç©ºï¼Œéœ€è¦ä¿®æ”¹å†²çªé“¾è¡¨çš„ç›¸åº”å¼•ç”¨ã€‚</li> <li>ä»<code>header</code>çš„è§’åº¦æ¥çœ‹ï¼Œéœ€è¦å°†è¯¥<code>entry</code>ä»åŒå‘é“¾è¡¨ä¸­åˆ é™¤ï¼ŒåŒæ—¶ä¿®æ”¹é“¾è¡¨ä¸­å‰é¢ä»¥åŠåé¢å…ƒç´ çš„ç›¸åº”å¼•ç”¨ã€‚</li></ol></blockquote> <div align="center"><img src="/fullstack-tutorial-site/assets/img/LinkedList_remove.fa1fb1de.png" width="700"></div><br> <p><code>removeEntryForKey()</code> å¯¹åº”çš„ä»£ç å¦‚ä¸‹ï¼š</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// LinkedHashMap.removeEntryForKey()ï¼Œåˆ é™¤keyå€¼å¯¹åº”çš„entry</span>
final Entry<span class="token operator">&lt;</span><span class="token constant">K</span><span class="token punctuation">,</span><span class="token constant">V</span><span class="token operator">&gt;</span> <span class="token function">removeEntryForKey</span><span class="token punctuation">(</span>Object key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token operator">...</span><span class="token operator">...</span>
	int hash <span class="token operator">=</span> <span class="token punctuation">(</span>key <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token punctuation">:</span> <span class="token function">hash</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    int i <span class="token operator">=</span> <span class="token function">indexFor</span><span class="token punctuation">(</span>hash<span class="token punctuation">,</span> table<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// hash&amp;(table.length-1)</span>
    Entry<span class="token operator">&lt;</span><span class="token constant">K</span><span class="token punctuation">,</span><span class="token constant">V</span><span class="token operator">&gt;</span> prev <span class="token operator">=</span> table<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">// å¾—åˆ°å†²çªé“¾è¡¨</span>
    Entry<span class="token operator">&lt;</span><span class="token constant">K</span><span class="token punctuation">,</span><span class="token constant">V</span><span class="token operator">&gt;</span> e <span class="token operator">=</span> prev<span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>e <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">// éå†å†²çªé“¾è¡¨</span>
        Entry<span class="token operator">&lt;</span><span class="token constant">K</span><span class="token punctuation">,</span><span class="token constant">V</span><span class="token operator">&gt;</span> next <span class="token operator">=</span> e<span class="token punctuation">.</span>next<span class="token punctuation">;</span>
        Object k<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>hash <span class="token operator">==</span> hash <span class="token operator">&amp;&amp;</span>
            <span class="token punctuation">(</span><span class="token punctuation">(</span>k <span class="token operator">=</span> e<span class="token punctuation">.</span>key<span class="token punctuation">)</span> <span class="token operator">==</span> key <span class="token operator">||</span> <span class="token punctuation">(</span>key <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> key<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">// æ‰¾åˆ°è¦åˆ é™¤çš„entry</span>
            modCount<span class="token operator">++</span><span class="token punctuation">;</span> size<span class="token operator">--</span><span class="token punctuation">;</span>
            <span class="token comment">// 1. å°†eä»å¯¹åº”bucketçš„å†²çªé“¾è¡¨ä¸­åˆ é™¤</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>prev <span class="token operator">==</span> e<span class="token punctuation">)</span> table<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> next<span class="token punctuation">;</span>
            <span class="token keyword">else</span> prev<span class="token punctuation">.</span>next <span class="token operator">=</span> next<span class="token punctuation">;</span>
            <span class="token comment">// 2. å°†eä»åŒå‘é“¾è¡¨ä¸­åˆ é™¤</span>
            e<span class="token punctuation">.</span>before<span class="token punctuation">.</span>after <span class="token operator">=</span> e<span class="token punctuation">.</span>after<span class="token punctuation">;</span>
            e<span class="token punctuation">.</span>after<span class="token punctuation">.</span>before <span class="token operator">=</span> e<span class="token punctuation">.</span>before<span class="token punctuation">;</span>
            <span class="token keyword">return</span> e<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        prev <span class="token operator">=</span> e<span class="token punctuation">;</span> e <span class="token operator">=</span> next<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> e<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_5-linkedhashset"><a href="#_5-linkedhashset" aria-hidden="true" class="header-anchor">#</a> 5. LinkedHashSet</h4> <p>å‰é¢å·²ç»è¯´è¿‡<em>LinkedHashSet</em>æ˜¯å¯¹<em>LinkedHashMap</em>çš„ç®€å•åŒ…è£…ï¼Œå¯¹<em>LinkedHashSet</em>çš„å‡½æ•°è°ƒç”¨éƒ½ä¼šè½¬æ¢æˆåˆé€‚çš„<em>LinkedHashMap</em>æ–¹æ³•ï¼Œå› æ­¤<em>LinkedHashSet</em>çš„å®ç°éå¸¸ç®€å•ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LinkedHashSet</span><span class="token generics function"><span class="token punctuation">&lt;</span>E<span class="token punctuation">&gt;</span></span>
    <span class="token keyword">extends</span> <span class="token class-name">HashSet</span><span class="token generics function"><span class="token punctuation">&lt;</span>E<span class="token punctuation">&gt;</span></span>
    <span class="token keyword">implements</span> <span class="token class-name">Set</span><span class="token generics function"><span class="token punctuation">&lt;</span>E<span class="token punctuation">&gt;</span></span><span class="token punctuation">,</span> Cloneable<span class="token punctuation">,</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>Serializable <span class="token punctuation">{</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token comment">// LinkedHashSeté‡Œé¢æœ‰ä¸€ä¸ªLinkedHashMap</span>
    <span class="token keyword">public</span> <span class="token function">LinkedHashSet</span><span class="token punctuation">(</span><span class="token keyword">int</span> initialCapacity<span class="token punctuation">,</span> <span class="token keyword">float</span> loadFactor<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedHashMap</span><span class="token operator">&lt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>initialCapacity<span class="token punctuation">,</span> loadFactor<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">add</span><span class="token punctuation">(</span>E e<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//ç®€å•çš„æ–¹æ³•è½¬æ¢</span>
        <span class="token keyword">return</span> map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> PRESENT<span class="token punctuation">)</span><span class="token operator">==</span>null<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_6-linkedhashmapç»å…¸ç”¨æ³•"><a href="#_6-linkedhashmapç»å…¸ç”¨æ³•" aria-hidden="true" class="header-anchor">#</a> 6. LinkedHashMapç»å…¸ç”¨æ³•</h4> <p>LinkedHashMap é™¤äº†å¯ä»¥ä¿è¯è¿­ä»£é¡ºåºå¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„ç”¨æ³•ï¼šå¯ä»¥è½»æ¾å®ç°ä¸€ä¸ªé‡‡ç”¨äº†FIFOæ›¿æ¢ç­–ç•¥çš„ç¼“å­˜ã€‚å…·ä½“è¯´æ¥ï¼ŒLinkedHashMap æœ‰ä¸€ä¸ªå­ç±»æ–¹æ³• <code>protected boolean removeEldestEntry(Map.Entry&lt;K,V&gt; eldest)</code>ï¼Œè¯¥æ–¹æ³•çš„ä½œç”¨æ˜¯å‘Šè¯‰ Map æ˜¯å¦è¦åˆ é™¤â€œæœ€è€â€çš„ Entryï¼Œæ‰€è°“æœ€è€å°±æ˜¯å½“å‰ Map ä¸­æœ€æ—©æ’å…¥çš„ Entryï¼Œå¦‚æœè¯¥æ–¹æ³•è¿”å› trueï¼Œæœ€è€çš„é‚£ä¸ªå…ƒç´ å°±ä¼šè¢«åˆ é™¤ã€‚åœ¨æ¯æ¬¡æ’å…¥æ–°å…ƒç´ çš„ä¹‹å LinkedHashMap ä¼šè‡ªåŠ¨è¯¢é—® removeEldestEntry() æ˜¯å¦è¦åˆ é™¤æœ€è€çš„å…ƒç´ ã€‚è¿™æ ·åªéœ€è¦åœ¨å­ç±»ä¸­é‡è½½è¯¥æ–¹æ³•ï¼Œå½“å…ƒç´ ä¸ªæ•°è¶…è¿‡ä¸€å®šæ•°é‡æ—¶è®© removeEldestEntry() è¿”å› trueï¼Œå°±èƒ½å¤Ÿå®ç°ä¸€ä¸ªå›ºå®šå¤§å°çš„ FIFO ç­–ç•¥çš„ç¼“å­˜ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/** ä¸€ä¸ªå›ºå®šå¤§å°çš„FIFOæ›¿æ¢ç­–ç•¥çš„ç¼“å­˜ */</span>
<span class="token keyword">class</span> <span class="token class-name">FIFOCache</span><span class="token generics function"><span class="token punctuation">&lt;</span>K<span class="token punctuation">,</span> V<span class="token punctuation">&gt;</span></span> <span class="token keyword">extends</span> <span class="token class-name">LinkedHashMap</span><span class="token generics function"><span class="token punctuation">&lt;</span>K<span class="token punctuation">,</span> V<span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">int</span> cacheSize<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token function">FIFOCache</span><span class="token punctuation">(</span><span class="token keyword">int</span> cacheSize<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>cacheSize <span class="token operator">=</span> cacheSize<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// å½“Entryä¸ªæ•°è¶…è¿‡cacheSizeæ—¶ï¼Œåˆ é™¤æœ€è€çš„Entry</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">boolean</span> <span class="token function">removeEldestEntry</span><span class="token punctuation">(</span>Map<span class="token punctuation">.</span>Entry<span class="token generics function"><span class="token punctuation">&lt;</span>K<span class="token punctuation">,</span>V<span class="token punctuation">&gt;</span></span> eldest<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">return</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> cacheSize<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="ä¸‰ã€å®¹å™¨ä¸­çš„è®¾è®¡æ¨¡å¼"><a href="#ä¸‰ã€å®¹å™¨ä¸­çš„è®¾è®¡æ¨¡å¼" aria-hidden="true" class="header-anchor">#</a> ä¸‰ã€å®¹å™¨ä¸­çš„è®¾è®¡æ¨¡å¼</h2> <h3 id="è¿­ä»£å™¨æ¨¡å¼"><a href="#è¿­ä»£å™¨æ¨¡å¼" aria-hidden="true" class="header-anchor">#</a> è¿­ä»£å™¨æ¨¡å¼</h3> <div align="center"><img src="/fullstack-tutorial-site/assets/img/Iterator-1.44e391cb.jpg" width></div><br> <p>Collection å®ç°äº† Iterable æ¥å£ï¼Œå…¶ä¸­çš„ iterator() æ–¹æ³•èƒ½å¤Ÿäº§ç”Ÿä¸€ä¸ª Iterator å¯¹è±¡ï¼Œé€šè¿‡è¿™ä¸ªå¯¹è±¡å°±å¯ä»¥è¿­ä»£éå† Collection ä¸­çš„å…ƒç´ ã€‚</p> <p>ä» JDK 1.5 ä¹‹åå¯ä»¥ä½¿ç”¨ foreach æ–¹æ³•æ¥éå†å®ç°äº† Iterable æ¥å£çš„èšåˆå¯¹è±¡ã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code>List<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;b&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span>String item <span class="token operator">:</span> list<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="é€‚é…å™¨æ¨¡å¼"><a href="#é€‚é…å™¨æ¨¡å¼" aria-hidden="true" class="header-anchor">#</a> é€‚é…å™¨æ¨¡å¼</h3> <p>java.util.Arrays.asList() å¯ä»¥æŠŠæ•°ç»„ç±»å‹è½¬æ¢ä¸º List ç±»å‹ã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@SafeVarargs</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics function"><span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span></span> List<span class="token generics function"><span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span></span> <span class="token function">asList</span><span class="token punctuation">(</span>T<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> a<span class="token punctuation">)</span>
</code></pre></div><p>å¦‚æœè¦å°†æ•°ç»„ç±»å‹è½¬æ¢ä¸º List ç±»å‹ï¼Œåº”è¯¥æ³¨æ„çš„æ˜¯ asList() çš„å‚æ•°ä¸ºæ³›å‹çš„å˜é•¿å‚æ•°ï¼Œå› æ­¤ä¸èƒ½ä½¿ç”¨åŸºæœ¬ç±»å‹æ•°ç»„ä½œä¸ºå‚æ•°ï¼Œåªèƒ½ä½¿ç”¨ç›¸åº”çš„åŒ…è£…ç±»å‹æ•°ç»„ã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code>Integer<span class="token punctuation">[</span><span class="token punctuation">]</span> arr <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
List list <span class="token operator">=</span> Arrays<span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>ä¹Ÿå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹å¼ç”Ÿæˆ Listã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code>List list <span class="token operator">=</span> Arrays<span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="å››ã€é¢è¯•æŒ‡å—"><a href="#å››ã€é¢è¯•æŒ‡å—" aria-hidden="true" class="header-anchor">#</a> å››ã€é¢è¯•æŒ‡å—</h2> <h3 id="_1-arraylistå’ŒlinkedliståŒºåˆ«"><a href="#_1-arraylistå’ŒlinkedliståŒºåˆ«" aria-hidden="true" class="header-anchor">#</a> 1. ArrayListå’ŒLinkedListåŒºåˆ«</h3> <ul><li><p>ArrayList å’Œ LinkedList å¯æƒ³ä»åå­—åˆ†æï¼Œå®ƒä»¬ä¸€ä¸ªæ˜¯ Array (åŠ¨æ€æ•°ç»„) çš„æ•°æ®ç»“æ„ï¼Œä¸€ä¸ªæ˜¯ Link (é“¾è¡¨) çš„æ•°æ®ç»“æ„ï¼Œæ­¤å¤–ï¼Œå®ƒä»¬ä¸¤ä¸ªéƒ½æ˜¯å¯¹ List æ¥å£çš„å®ç°ã€‚å‰è€…æ˜¯æ•°ç»„é˜Ÿåˆ—ï¼Œç›¸å½“äºåŠ¨æ€æ•°ç»„ï¼›åè€…ä¸ºåŒå‘é“¾è¡¨ç»“æ„ï¼Œä¹Ÿå¯å½“ä½œå †æ ˆã€é˜Ÿåˆ—ã€åŒç«¯é˜Ÿåˆ—ï¼›</p></li> <li><p><strong>å½“éšæœºè®¿é—® List æ—¶</strong>ï¼ˆgetå’Œsetæ“ä½œï¼‰ï¼ŒArrayList æ¯” LinkedListçš„æ•ˆç‡æ›´é«˜ï¼Œå› ä¸º LinkedList æ˜¯çº¿æ€§çš„æ•°æ®å­˜å‚¨æ–¹å¼ï¼Œæ‰€ä»¥éœ€è¦ç§»åŠ¨æŒ‡é’ˆä»å‰å¾€åä¾æ¬¡æŸ¥æ‰¾ï¼›</p></li> <li><p><strong>å½“å¯¹æ•°æ®è¿›è¡Œå¢åŠ å’Œåˆ é™¤çš„æ“ä½œæ—¶</strong>ï¼ˆadd å’Œ remove æ“ä½œï¼‰ï¼ŒLinkedList æ¯” ArrayList çš„æ•ˆç‡æ›´é«˜ï¼Œå› ä¸º ArrayList æ˜¯æ•°ç»„ï¼Œæ‰€ä»¥åœ¨å…¶ä¸­è¿›è¡Œå¢åˆ æ“ä½œæ—¶ï¼Œä¼šå¯¹æ“ä½œç‚¹ä¹‹åæ‰€æœ‰æ•°æ®çš„ä¸‹æ ‡ç´¢å¼•é€ æˆå½±å“ï¼Œéœ€è¦è¿›è¡Œæ•°æ®çš„ç§»åŠ¨ï¼›</p></li> <li><p><strong>ä»åˆ©ç”¨æ•ˆç‡æ¥çœ‹</strong>ï¼ŒArrayList è‡ªç”±æ€§è¾ƒä½ï¼Œå› ä¸ºå®ƒéœ€è¦æ‰‹åŠ¨çš„è®¾ç½®å›ºå®šå¤§å°çš„å®¹é‡ï¼Œä½†æ˜¯å®ƒçš„ä½¿ç”¨æ¯”è¾ƒæ–¹ä¾¿ï¼Œåªéœ€è¦åˆ›å»ºï¼Œç„¶åæ·»åŠ æ•°æ®ï¼Œé€šè¿‡è°ƒç”¨ä¸‹æ ‡è¿›è¡Œä½¿ç”¨ï¼›è€Œ LinkedList è‡ªç”±æ€§è¾ƒé«˜ï¼Œèƒ½å¤ŸåŠ¨æ€çš„éšæ•°æ®é‡çš„å˜åŒ–è€Œå˜åŒ–ï¼Œä½†æ˜¯å®ƒä¸ä¾¿äºä½¿ç”¨ï¼›</p></li> <li><p>ArrayList ä¸»è¦ç©ºé—´å¼€é”€åœ¨äºéœ€è¦åœ¨ List åˆ—è¡¨é¢„ç•™ä¸€å®šç©ºé—´ï¼›è€Œ LinkList ä¸»è¦æ§ä»¶å¼€é”€åœ¨äºéœ€è¦å­˜å‚¨ç»“ç‚¹ä¿¡æ¯ä»¥åŠç»“ç‚¹æŒ‡é’ˆä¿¡æ¯ã€‚</p></li> <li><p><strong>ArrayListã€LinkedList å’Œ Vectorå¦‚ä½•é€‰æ‹©ï¼Ÿ</strong></p> <ul><li>å½“å¯¹æ•°æ®çš„ä¸»è¦æ“ä½œä¸ºç´¢å¼•æˆ–åªåœ¨é›†åˆçš„æœ«ç«¯å¢åŠ ã€åˆ é™¤å…ƒç´ æ—¶ï¼Œä½¿ç”¨ ArrayList æˆ– Vector æ•ˆç‡æ¯”è¾ƒé«˜ï¼›</li> <li>å½“å¯¹æ•°æ®çš„æ“ä½œä¸»è¦ä¸ºåˆ¶å®šä½ç½®çš„æ’å…¥æˆ–åˆ é™¤æ“ä½œæ—¶ï¼Œä½¿ç”¨ LinkedList æ•ˆç‡æ¯”è¾ƒé«˜ï¼›</li> <li>å½“åœ¨å¤šçº¿ç¨‹ä¸­ä½¿ç”¨å®¹å™¨æ—¶ï¼ˆå³å¤šä¸ªçº¿ç¨‹ä¼šåŒæ—¶è®¿é—®è¯¥å®¹å™¨ï¼‰ï¼Œé€‰ç”¨ Vector è¾ƒä¸ºå®‰å…¨ï¼›</li></ul></li></ul> <h3 id="_2-hashmapå’ŒhashtableåŒºåˆ«ï¼Œhashmapçš„keyç±»å‹"><a href="#_2-hashmapå’ŒhashtableåŒºåˆ«ï¼Œhashmapçš„keyç±»å‹" aria-hidden="true" class="header-anchor">#</a> 2. HashMapå’ŒHashTableåŒºåˆ«ï¼ŒHashMapçš„keyç±»å‹</h3> <ul><li><p><strong>Hash Mapå’ŒHashTableçš„åŒºåˆ«</strong></p> <ul><li><p>Hashtable çš„æ–¹æ³•æ˜¯åŒæ­¥çš„ï¼ŒHashMap éåŒæ­¥ï¼Œæ‰€ä»¥åœ¨å¤šçº¿ç¨‹åœºåˆè¦æ‰‹åŠ¨åŒæ­¥</p></li> <li><p>Hashtable ä¸å…è®¸ null å€¼ (key å’Œ value éƒ½ä¸å¯ä»¥)ï¼ŒHashMap å…è®¸ null å€¼( key å’Œ value éƒ½å¯ä»¥)ã€‚</p></li> <li><p>ä¸¤è€…çš„éå†æ–¹å¼å¤§åŒå°å¼‚ï¼ŒHashtable ä»…ä»…æ¯” HashMap å¤šä¸€ä¸ª elements æ–¹æ³•ã€‚</p></li> <li><p>Hashtableâ€¯å’Œâ€¯HashMapâ€¯éƒ½èƒ½é€šè¿‡ values() æ–¹æ³•è¿”å›ä¸€ä¸ª Collection ï¼Œç„¶åè¿›è¡Œéå†å¤„ç†ã€‚</p></li> <li><p>ä¸¤è€…ä¹Ÿéƒ½å¯ä»¥é€šè¿‡ entrySet() æ–¹æ³•è¿”å›ä¸€ä¸ª Set ï¼Œ ç„¶åè¿›è¡Œéå†å¤„ç†ã€‚</p></li> <li><p>HashTable ä½¿ç”¨ Enumerationï¼ŒHashMap ä½¿ç”¨ Iteratorã€‚</p></li> <li><p>å“ˆå¸Œå€¼çš„ä½¿ç”¨ä¸åŒï¼ŒHashtable ç›´æ¥ä½¿ç”¨å¯¹è±¡çš„ hashCodeã€‚è€Œ HashMap é‡æ–°è®¡ç®—hashå€¼ï¼Œè€Œä¸”ç”¨äºä»£æ›¿æ±‚æ¨¡ã€‚</p></li> <li><p>Hashtable ä¸­ hash æ•°ç»„é»˜è®¤å¤§å°æ˜¯11ï¼Œå¢åŠ çš„æ–¹å¼æ˜¯ old*2+1ã€‚HashMap ä¸­ hash æ•°ç»„çš„é»˜è®¤å¤§å°æ˜¯16ï¼Œè€Œä¸”ä¸€å®šæ˜¯ 2 çš„æŒ‡æ•°ã€‚</p></li> <li><p>HashTable åŸºäº Dictionary ç±»ï¼Œè€Œ HashMap åŸºäº AbstractMap ç±»</p></li></ul></li> <li><p><strong>HashMapä¸­çš„keyå¯ä»¥æ˜¯ä»»ä½•å¯¹è±¡æˆ–æ•°æ®ç±»å‹å—</strong></p> <ul><li>å¯ä»¥ä¸ºnullï¼Œä½†ä¸èƒ½æ˜¯å¯å˜å¯¹è±¡ï¼Œå¦‚æœæ˜¯å¯å˜å¯¹è±¡çš„è¯ï¼Œå¯¹è±¡ä¸­çš„å±æ€§æ”¹å˜ï¼Œåˆ™å¯¹è±¡ HashCode ä¹Ÿè¿›è¡Œç›¸åº”çš„æ”¹å˜ï¼Œå¯¼è‡´ä¸‹æ¬¡æ— æ³•æŸ¥æ‰¾åˆ°å·²å­˜åœ¨Mapä¸­çš„æ•°æ®ã€‚</li> <li>å¦‚æœå¯å˜å¯¹è±¡åœ¨ HashMap ä¸­è¢«ç”¨ä½œé”®ï¼Œé‚£å°±è¦å°å¿ƒåœ¨æ”¹å˜å¯¹è±¡çŠ¶æ€çš„æ—¶å€™ï¼Œä¸è¦æ”¹å˜å®ƒçš„å“ˆå¸Œå€¼äº†ã€‚æˆ‘ä»¬åªéœ€è¦ä¿è¯æˆå‘˜å˜é‡çš„æ”¹å˜èƒ½ä¿è¯è¯¥å¯¹è±¡çš„å“ˆå¸Œå€¼ä¸å˜å³å¯ã€‚</li></ul></li> <li><p><strong>HashTableæ˜¯çº¿ç¨‹å®‰å…¨çš„ä¹ˆ</strong></p> <ul><li>HashTable æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå…¶å®ç°æ˜¯åœ¨å¯¹åº”çš„æ–¹æ³•ä¸Šæ·»åŠ äº† synchronized å…³é”®å­—è¿›è¡Œä¿®é¥°ï¼Œç”±äºåœ¨æ‰§è¡Œæ­¤æ–¹æ³•çš„æ—¶å€™éœ€è¦è·å¾—å¯¹è±¡é”ï¼Œåˆ™æ‰§è¡Œèµ·æ¥æ¯”è¾ƒæ…¢ã€‚æ‰€ä»¥ç°åœ¨å¦‚æœä¸ºäº†ä¿è¯çº¿ç¨‹å®‰å…¨çš„è¯ï¼Œä½¿ç”¨ CurrentHashMapã€‚</li></ul></li></ul> <h3 id="_3-hashmapå’Œconcurrenthashmap"><a href="#_3-hashmapå’Œconcurrenthashmap" aria-hidden="true" class="header-anchor">#</a> 3. HashMapå’ŒConcurrentHashMap</h3> <ul><li><strong>HashMapå’ŒConcurrentâ€¯HashMapåŒºåˆ«ï¼Ÿ</strong> <ul><li>HashMa pæ˜¯éçº¿ç¨‹å®‰å…¨çš„ï¼ŒCurrentHashMap æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚</li> <li>ConcurrentHashMap å°†æ•´ä¸ª Hash æ¡¶è¿›è¡Œäº†åˆ†æ®µ segmentï¼Œä¹Ÿå°±æ˜¯å°†è¿™ä¸ªå¤§çš„æ•°ç»„åˆ†æˆäº†å‡ ä¸ªå°çš„ç‰‡æ®µsegmentï¼Œè€Œä¸”æ¯ä¸ªå°çš„ç‰‡æ®µ segment ä¸Šé¢éƒ½æœ‰é”å­˜åœ¨ï¼Œé‚£ä¹ˆåœ¨æ’å…¥å…ƒç´ çš„æ—¶å€™å°±éœ€è¦å…ˆæ‰¾åˆ°åº”è¯¥æ’å…¥åˆ°å“ªä¸€ä¸ªç‰‡æ®µ segmentï¼Œç„¶åå†åœ¨è¿™ä¸ªç‰‡æ®µä¸Šé¢è¿›è¡Œæ’å…¥ï¼Œè€Œä¸”è¿™é‡Œè¿˜éœ€è¦è·å– segment é”ã€‚</li> <li>ConcurrentHashMap è®©é”çš„ç²’åº¦æ›´ç²¾ç»†ä¸€äº›ï¼Œå¹¶å‘æ€§èƒ½æ›´å¥½ã€‚</li></ul></li> <li><strong>ConcurrentHashMapâ€¯çº¿ç¨‹å®‰å…¨å—ï¼Œâ€¯ConcurrentHashMapå¦‚ä½•ä¿è¯â€¯çº¿ç¨‹å®‰å…¨ï¼Ÿ</strong> <ul><li>HashTable å®¹å™¨åœ¨ç«äº‰æ¿€çƒˆçš„å¹¶å‘ç¯å¢ƒä¸‹è¡¨ç°å‡ºæ•ˆç‡ä½ä¸‹çš„åŸå› æ˜¯æ‰€æœ‰è®¿é—® HashTable çš„çº¿ç¨‹éƒ½å¿…é¡»ç«äº‰åŒä¸€æŠŠé”ï¼Œé‚£å‡å¦‚å®¹å™¨é‡Œæœ‰å¤šæŠŠé”ï¼Œæ¯ä¸€æŠŠé”ç”¨äºé”å®¹å™¨å…¶ä¸­ä¸€éƒ¨åˆ†æ•°æ®ï¼Œé‚£ä¹ˆå½“å¤šçº¿ç¨‹è®¿é—®å®¹å™¨é‡Œä¸åŒæ•°æ®æ®µçš„æ•°æ®æ—¶ï¼Œçº¿ç¨‹é—´å°±ä¸ä¼šå­˜åœ¨é”ç«äº‰ï¼Œä»è€Œå¯ä»¥æœ‰æ•ˆçš„æé«˜å¹¶å‘è®¿é—®æ•ˆç‡ï¼Œè¿™å°±æ˜¯ ConcurrentHashMap æ‰€ä½¿ç”¨çš„<strong>åˆ†æ®µé”</strong>ï¼Œé¦–å…ˆå°†æ•°æ®åˆ†æˆä¸€æ®µä¸€æ®µçš„å­˜å‚¨ï¼Œç„¶åç»™æ¯ä¸€æ®µæ•°æ®é…ä¸€æŠŠé”ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹å ç”¨é”è®¿é—®å…¶ä¸­ä¸€ä¸ªæ®µæ•°æ®çš„æ—¶å€™ï¼Œå…¶ä»–æ®µçš„æ•°æ®ä¹Ÿèƒ½è¢«å…¶ä»–çº¿ç¨‹è®¿é—®ã€‚</li> <li>get æ“ä½œçš„é«˜æ•ˆä¹‹å¤„åœ¨äºæ•´ä¸ª get è¿‡ç¨‹ä¸éœ€è¦åŠ é”ï¼Œé™¤éè¯»åˆ°çš„å€¼æ˜¯ç©ºçš„æ‰ä¼šåŠ é”é‡è¯»ã€‚<strong>get æ–¹æ³•é‡Œå°†è¦ä½¿ç”¨çš„å…±äº«å˜é‡éƒ½å®šä¹‰æˆ volatile</strong>ï¼Œå¦‚ç”¨äºç»Ÿè®¡å½“å‰ Segement å¤§å°çš„ count å­—æ®µå’Œç”¨äºå­˜å‚¨å€¼çš„ HashEntry çš„ valueã€‚å®šä¹‰æˆ volatile çš„å˜é‡ï¼Œèƒ½å¤Ÿåœ¨çº¿ç¨‹ä¹‹é—´ä¿æŒå¯è§æ€§ï¼Œèƒ½å¤Ÿè¢«å¤šçº¿ç¨‹åŒæ—¶è¯»ï¼Œå¹¶ä¸”ä¿è¯ä¸ä¼šè¯»åˆ°è¿‡æœŸçš„å€¼ï¼Œä½†æ˜¯åªèƒ½è¢«å•çº¿ç¨‹å†™ï¼ˆæœ‰ä¸€ç§æƒ…å†µå¯ä»¥è¢«å¤šçº¿ç¨‹å†™ï¼Œå°±æ˜¯å†™å…¥çš„å€¼ä¸ä¾èµ–äºåŸå€¼ï¼‰ï¼Œåœ¨ get æ“ä½œé‡Œåªéœ€è¦è¯»ä¸éœ€è¦å†™å…±äº«å˜é‡ count å’Œ valueï¼Œæ‰€ä»¥å¯ä»¥ä¸ç”¨åŠ é”ã€‚</li> <li>put æ–¹æ³•é¦–å…ˆå®šä½åˆ° Segmentï¼Œç„¶ååœ¨ Segment é‡Œè¿›è¡Œæ’å…¥æ“ä½œã€‚
<ul><li>æ’å…¥æ“ä½œéœ€è¦ç»å†ä¸¤ä¸ªæ­¥éª¤ï¼šï¼ˆ1ï¼‰åˆ¤æ–­æ˜¯å¦éœ€è¦å¯¹ Segment é‡Œçš„ HashEntry æ•°ç»„è¿›è¡Œæ‰©å®¹ï¼›ï¼ˆ2ï¼‰å®šä½æ·»åŠ å…ƒç´ çš„ä½ç½®ç„¶åæ”¾åœ¨HashEntryæ•°ç»„é‡Œã€‚</li></ul></li></ul></li></ul> <h3 id="_4-hashtableçš„åŸç†"><a href="#_4-hashtableçš„åŸç†" aria-hidden="true" class="header-anchor">#</a> 4. Hashtableçš„åŸç†</h3> <p><strong>Hashtable ä½¿ç”¨é“¾åœ°å€æ³•è¿›è¡Œå…ƒç´ å­˜å‚¨ï¼Œé€šè¿‡ä¸€ä¸ªå®é™…çš„ä¾‹å­æ¥æ¼”ç¤ºä¸€ä¸‹æ’å…¥å…ƒç´ çš„è¿‡ç¨‹ï¼š</strong></p> <p>å‡è®¾æˆ‘ä»¬ç°åœ¨ Hashtable çš„å®¹é‡ä¸º 5ï¼Œå·²ç»å­˜åœ¨äº† (5,5)ï¼Œ(13,13)ï¼Œ(16,16)ï¼Œ(17,17)ï¼Œ(21,21) è¿™ 5 ä¸ªé”®å€¼å¯¹ï¼Œç›®å‰ä»–ä»¬åœ¨ Hashtable ä¸­çš„ä½ç½®å¦‚ä¸‹ï¼š</p> <div align="center"><img src="data:image/png;base64,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" width></div><br> <p>ç°åœ¨ï¼Œæˆ‘ä»¬æ’å…¥ä¸€ä¸ªæ–°çš„é”®å€¼å¯¹ï¼Œput(16,22)ï¼Œå‡è®¾ key=16 çš„ç´¢å¼•ä¸º 1.ä½†ç°åœ¨ç´¢å¼• 1 çš„ä½ç½®æœ‰ä¸¤ä¸ª Entry äº†ï¼Œæ‰€ä»¥ç¨‹åºä¼šå¯¹é“¾è¡¨è¿›è¡Œè¿­ä»£ã€‚è¿­ä»£çš„è¿‡ç¨‹ä¸­ï¼Œå‘ç°å…¶ä¸­æœ‰ä¸€ä¸ª Entry çš„ key å’Œæˆ‘ä»¬è¦æ’å…¥çš„é”®å€¼å¯¹çš„ key ç›¸åŒï¼Œæ‰€ä»¥ç°åœ¨ä¼šåšçš„å·¥ä½œå°±æ˜¯å°† newValue=22 æ›¿æ¢ oldValue=16ï¼Œç„¶åè¿”å› oldValue = 16.</p> <div align="center"><img src="data:image/png;base64,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" width></div><br> <p>ç„¶åæˆ‘ä»¬ç°åœ¨å†æ’å…¥ä¸€ä¸ªï¼Œput(33,33)ï¼Œkey=33 çš„ç´¢å¼•ä¸º 3ï¼Œå¹¶ä¸”åœ¨é“¾è¡¨ä¸­ä¹Ÿä¸å­˜åœ¨ key=33 çš„ Entryï¼Œæ‰€ä»¥å°†è¯¥èŠ‚ç‚¹æ’å…¥é“¾è¡¨çš„ç¬¬ä¸€ä¸ªä½ç½®ã€‚</p> <div align="center"><img src="data:image/png;base64,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" width></div><br> <p><strong>Hashtable ä¸ HashMap çš„ç®€å•æ¯”è¾ƒ</strong></p> <ol><li>HashTable åŸºäº Dictionary ç±»ï¼Œè€Œ HashMap æ˜¯åŸºäº AbstractMapã€‚Dictionary æ˜¯ä»»ä½•å¯å°†é”®æ˜ å°„åˆ°ç›¸åº”å€¼çš„ç±»çš„æŠ½è±¡çˆ¶ç±»ï¼Œè€Œ AbstractMap æ˜¯åŸºäº Map æ¥å£çš„å®ç°ï¼Œå®ƒä»¥æœ€å¤§é™åº¦åœ°å‡å°‘å®ç°æ­¤æ¥å£æ‰€éœ€çš„å·¥ä½œã€‚</li> <li>HashMap çš„ key å’Œ value éƒ½å…è®¸ä¸º nullï¼Œè€Œ Hashtable çš„ key å’Œ value éƒ½ä¸å…è®¸ä¸º nullã€‚HashMap é‡åˆ° key ä¸º null çš„æ—¶å€™ï¼Œè°ƒç”¨ putForNullKey æ–¹æ³•è¿›è¡Œå¤„ç†ï¼Œè€Œå¯¹ value æ²¡æœ‰å¤„ç†ï¼›Hashtableé‡åˆ° nullï¼Œç›´æ¥è¿”å› NullPointerExceptionã€‚</li> <li><strong>Hashtable æ–¹æ³•æ˜¯åŒæ­¥ï¼Œè€ŒHashMapåˆ™ä¸æ˜¯</strong>ã€‚æˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹æºç ï¼ŒHashtable ä¸­çš„å‡ ä¹æ‰€æœ‰çš„ public çš„æ–¹æ³•éƒ½æ˜¯ synchronized çš„ï¼Œè€Œæœ‰äº›æ–¹æ³•ä¹Ÿæ˜¯åœ¨å†…éƒ¨é€šè¿‡ synchronized ä»£ç å—æ¥å®ç°ã€‚æ‰€ä»¥æœ‰äººä¸€èˆ¬éƒ½å»ºè®®å¦‚æœæ˜¯æ¶‰åŠåˆ°å¤šçº¿ç¨‹åŒæ­¥æ—¶é‡‡ç”¨ HashTableï¼Œæ²¡æœ‰æ¶‰åŠå°±é‡‡ç”¨ HashMapï¼Œä½†æ˜¯åœ¨ Collections ç±»ä¸­å­˜åœ¨ä¸€ä¸ªé™æ€æ–¹æ³•ï¼š<strong>synchronizedMap()</strong>ï¼Œè¯¥æ–¹æ³•åˆ›å»ºäº†ä¸€ä¸ªçº¿ç¨‹å®‰å…¨çš„ Map å¯¹è±¡ï¼Œå¹¶æŠŠå®ƒä½œä¸ºä¸€ä¸ªå°è£…çš„å¯¹è±¡æ¥è¿”å›ã€‚</li></ol> <p><strong>å‚è€ƒèµ„æ–™ï¼š</strong></p> <ul><li><a href="http://wiki.jikexueyuan.com/project/java-collection/hashtable.html" target="_blank" rel="noopener noreferrer">Hashtable çš„å®ç°åŸç† - Java é›†åˆå­¦ä¹ æŒ‡å— - æå®¢å­¦é™¢Wiki<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h3 id="_5-hashå†²çªçš„è§£å†³åŠæ³•"><a href="#_5-hashå†²çªçš„è§£å†³åŠæ³•" aria-hidden="true" class="header-anchor">#</a> 5. Hashå†²çªçš„è§£å†³åŠæ³•</h3> <ul><li>é“¾åœ°å€æ³•</li> <li>å¼€æ”¾åœ°å€æ³•ï¼ˆå‘åä¸€ä½ï¼‰
<ul><li>çº¿æ€§æ¢æµ‹</li> <li>å¹³æ–¹æ¢æµ‹</li> <li>äºŒæ¬¡å“ˆå¸Œ</li></ul></li> <li>å†å“ˆå¸Œæ³•</li></ul> <h3 id="_6-ä»€ä¹ˆæ˜¯è¿­ä»£å™¨"><a href="#_6-ä»€ä¹ˆæ˜¯è¿­ä»£å™¨" aria-hidden="true" class="header-anchor">#</a> 6. ä»€ä¹ˆæ˜¯è¿­ä»£å™¨</h3> <p>Java é›†åˆæ¡†æ¶çš„é›†åˆç±»ï¼Œæˆ‘ä»¬æœ‰æ—¶å€™ç§°ä¹‹ä¸ºå®¹å™¨ã€‚å®¹å™¨çš„ç§ç±»æœ‰å¾ˆå¤šç§ï¼Œæ¯”å¦‚ ArrayListã€LinkedListã€HashSet...ï¼Œæ¯ç§å®¹å™¨éƒ½æœ‰è‡ªå·±çš„ç‰¹ç‚¹ï¼ŒArrayList åº•å±‚ç»´æŠ¤çš„æ˜¯ä¸€ä¸ªæ•°ç»„ï¼›LinkedList æ˜¯é“¾è¡¨ç»“æ„çš„ï¼›HashSet ä¾èµ–çš„æ˜¯å“ˆå¸Œè¡¨ï¼Œæ¯ç§å®¹å™¨éƒ½æœ‰è‡ªå·±ç‰¹æœ‰çš„æ•°æ®ç»“æ„ã€‚</p> <p>å› ä¸ºå®¹å™¨çš„å†…éƒ¨ç»“æ„ä¸åŒï¼Œå¾ˆå¤šæ—¶å€™å¯èƒ½ä¸çŸ¥é“è¯¥æ€æ ·å»éå†ä¸€ä¸ªå®¹å™¨ä¸­çš„å…ƒç´ ã€‚æ‰€ä»¥ä¸ºäº†ä½¿å¯¹å®¹å™¨å†…å…ƒç´ çš„æ“ä½œæ›´ä¸ºç®€å•ï¼ŒJava å¼•å…¥äº†è¿­ä»£å™¨æ¨¡å¼ï¼</p> <p>æŠŠè®¿é—®é€»è¾‘ä»ä¸åŒç±»å‹çš„é›†åˆç±»ä¸­æŠ½å–å‡ºæ¥ï¼Œä»è€Œé¿å…å‘å¤–éƒ¨æš´éœ²é›†åˆçš„å†…éƒ¨ç»“æ„ã€‚</p> <p><strong>è¿­ä»£å™¨æ¨¡å¼</strong>ï¼šå°±æ˜¯æä¾›ä¸€ç§æ–¹æ³•å¯¹ä¸€ä¸ªå®¹å™¨å¯¹è±¡ä¸­çš„å„ä¸ªå…ƒç´ è¿›è¡Œè®¿é—®ï¼Œè€Œåˆä¸æš´éœ²è¯¥å¯¹è±¡å®¹å™¨çš„å†…éƒ¨ç»†ã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ä½¿ç”¨è¿­ä»£å™¨éå†ArrayListé›†åˆ</span>
    Iterator<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">&gt;</span></span> listIt <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>listIt<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>listIt<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// ä½¿ç”¨è¿­ä»£å™¨éå†Seté›†åˆ</span>
    Iterator<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">&gt;</span></span> setIt <span class="token operator">=</span> set<span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>setIt<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>listIt<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// ä½¿ç”¨è¿­ä»£å™¨éå†LinkedListé›†åˆ</span>
    Iterator<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">&gt;</span></span> linkIt <span class="token operator">=</span> linkList<span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>linkIt<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>listIt<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>å‚è€ƒèµ„æ–™ï¼š</p> <ul><li><a href="https://www.cnblogs.com/zyuze/p/7726582.html" target="_blank" rel="noopener noreferrer">æ·±å…¥ç†è§£Javaä¸­çš„è¿­ä»£å™¨ - MrÂ·Dragon - åšå®¢å›­<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h3 id="_7-æ„é€ ç›¸åŒhashçš„å­—ç¬¦ä¸²è¿›è¡Œæ”»å‡»ï¼Œè¿™ç§æƒ…å†µåº”è¯¥æ€ä¹ˆå¤„ç†ï¼Ÿjdk7å¦‚ä½•å¤„ç†"><a href="#_7-æ„é€ ç›¸åŒhashçš„å­—ç¬¦ä¸²è¿›è¡Œæ”»å‡»ï¼Œè¿™ç§æƒ…å†µåº”è¯¥æ€ä¹ˆå¤„ç†ï¼Ÿjdk7å¦‚ä½•å¤„ç†" aria-hidden="true" class="header-anchor">#</a> 7. æ„é€ ç›¸åŒhashçš„å­—ç¬¦ä¸²è¿›è¡Œæ”»å‡»ï¼Œè¿™ç§æƒ…å†µåº”è¯¥æ€ä¹ˆå¤„ç†ï¼ŸJDK7å¦‚ä½•å¤„ç†</h3> <p><strong>æ”»å‡»åŸç†ï¼š</strong></p> <p>å½“å®¢æˆ·ç«¯å‘é€ä¸€ä¸ªè¯·æ±‚åˆ°æœåŠ¡å™¨ï¼Œå¦‚æœè¯¥è¯·æ±‚ä¸­å¸¦æœ‰å‚æ•°ï¼ŒæœåŠ¡å™¨ç«¯ä¼šå°† å‚æ•°å-å‚æ•°å€¼ ä½œä¸º key-value ä¿å­˜åœ¨ HashMap ä¸­ã€‚å¦‚æœæœ‰äººæ¶æ„æ„é€ è¯·æ±‚ï¼Œåœ¨è¯·æ±‚ä¸­åŠ å…¥å¤§é‡ç›¸åŒ hash å€¼çš„ String å‚æ•°åï¼ˆkeyï¼‰ï¼Œé‚£ä¹ˆåœ¨æœåŠ¡å™¨ç«¯ç”¨äºå­˜å‚¨è¿™äº› key-value å¯¹çš„ HashMap ä¼šè¢«å¼ºè¡Œé€€åŒ–æˆé“¾è¡¨ï¼Œå¦‚å›¾ï¼š</p> <div align="center"><img src="/fullstack-tutorial-site/assets/img/hash-to-badlink.b7959710.png" width></div> <p>å¦‚æœæ•°æ®é‡è¶³å¤Ÿå¤§ï¼Œé‚£ä¹ˆåœ¨æŸ¥æ‰¾ï¼Œæ’å…¥æ—¶ä¼šå ç”¨å¤§é‡ CPUï¼Œè¾¾åˆ°æ‹’ç»æœåŠ¡æ”»å‡»çš„ç›®çš„ã€‚</p> <p><strong>æ€ä¹ˆå¤„ç†</strong></p> <ol><li>é™åˆ¶ POST å’Œ GET è¯·æ±‚çš„å‚æ•°ä¸ªæ•°</li> <li>é™åˆ¶ POST è¯·æ±‚çš„è¯·æ±‚ä½“å¤§å°</li> <li>Web Application FireWallï¼ˆWAFï¼‰</li></ol> <p><strong>JDK7å¦‚ä½•å¤„ç†</strong></p> <p>HashMap ä¼šåŠ¨æ€çš„ä½¿ç”¨ä¸€ä¸ªä¸“é—¨ TreeMap å®ç°æ¥æ›¿æ¢æ‰å®ƒã€‚</p> <h3 id="_8-hashmapä¸ºä»€ä¹ˆå¤§å°æ˜¯2çš„å¹‚æ¬¡"><a href="#_8-hashmapä¸ºä»€ä¹ˆå¤§å°æ˜¯2çš„å¹‚æ¬¡" aria-hidden="true" class="header-anchor">#</a> 8. Hashmapä¸ºä»€ä¹ˆå¤§å°æ˜¯2çš„å¹‚æ¬¡</h3> <p>é¦–å…ˆæ¥çœ‹ä¸€ä¸‹ hashmap çš„ put æ–¹æ³•çš„æºç </p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> V <span class="token function">put</span><span class="token punctuation">(</span>K key<span class="token punctuation">,</span> V value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">==</span> null<span class="token punctuation">)</span>                
        <span class="token keyword">return</span> <span class="token function">putForNullKey</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//å°†ç©ºkeyçš„EntryåŠ å…¥åˆ°table[0]ä¸­</span>
    <span class="token keyword">int</span> hash <span class="token operator">=</span> <span class="token function">hash</span><span class="token punctuation">(</span>key<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//è®¡ç®—key.hashcode()çš„hashå€¼ï¼Œhashå‡½æ•°ç”±hashmapè‡ªå·±å®ç°</span>
    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token function">indexFor</span><span class="token punctuation">(</span>hash<span class="token punctuation">,</span> table<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//è·å–å°†è¦å­˜æ”¾çš„æ•°ç»„ä¸‹æ ‡</span>
    <span class="token comment">/*
     * forä¸­çš„ä»£ç ç”¨äºï¼šå½“hashå€¼ç›¸åŒä¸”keyç›¸åŒçš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨æ–°å€¼è¦†ç›–æ—§å€¼ï¼ˆå…¶å®å°±æ˜¯ä¿®æ”¹åŠŸèƒ½ï¼‰
     */</span>
    <span class="token comment">//æ³¨æ„ï¼šforå¾ªç¯åœ¨ç¬¬ä¸€æ¬¡æ‰§è¡Œæ—¶å°±ä¼šå…ˆåˆ¤æ–­æ¡ä»¶</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>Entry<span class="token generics function"><span class="token punctuation">&lt;</span>K<span class="token punctuation">,</span> V<span class="token punctuation">&gt;</span></span> e <span class="token operator">=</span> table<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span> e <span class="token operator">!=</span> null<span class="token punctuation">;</span> e <span class="token operator">=</span> e<span class="token punctuation">.</span>next<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        Object k<span class="token punctuation">;</span>
        <span class="token comment">//hashå€¼ç›¸åŒä¸”keyç›¸åŒçš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨æ–°å€¼è¦†ç›–æ—§å€¼</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>hash <span class="token operator">==</span> hash <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>k <span class="token operator">=</span> e<span class="token punctuation">.</span>key<span class="token punctuation">)</span> <span class="token operator">==</span> key <span class="token operator">||</span> key<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            V oldValue <span class="token operator">=</span> e<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
            e<span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">;</span>
            <span class="token comment">//e.recordAccess(this);</span>
            <span class="token keyword">return</span> oldValue<span class="token punctuation">;</span><span class="token comment">//è¿”å›æ—§å€¼</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    modCount<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token function">addEntry</span><span class="token punctuation">(</span>hash<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å¢åŠ ä¸€ä¸ªæ–°çš„Entryåˆ°table[i]</span>
    <span class="token keyword">return</span> null<span class="token punctuation">;</span><span class="token comment">//å¦‚æœæ²¡æœ‰ä¸ä¼ å…¥çš„keyç›¸ç­‰çš„Entryï¼Œå°±è¿”å›null</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * &quot;æŒ‰ä½ä¸&quot;æ¥è·å–æ•°ç»„ä¸‹æ ‡
 */</span>
<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">indexFor</span><span class="token punctuation">(</span><span class="token keyword">int</span> h<span class="token punctuation">,</span> <span class="token keyword">int</span> length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> h <span class="token operator">&amp;</span> <span class="token punctuation">(</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><p><strong>hashmap å§‹ç»ˆå°†è‡ªå·±çš„æ¡¶ä¿æŒåœ¨2<sup>n</sup>ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆï¼ŸindexForè¿™ä¸ªæ–¹æ³•è§£é‡Šäº†è¿™ä¸ªé—®é¢˜</strong></p> <p>å¤§å®¶éƒ½çŸ¥é“è®¡ç®—æœºé‡Œé¢ä½è¿ç®—æ˜¯åŸºæœ¬è¿ç®—ï¼Œä½è¿ç®—çš„æ•ˆç‡æ˜¯è¿œè¿œé«˜äºå–ä½™ % è¿ç®—çš„</p> <p>ä¸¾ä¸ªä¾‹å­ï¼š2<sup>n</sup> è½¬æ¢æˆäºŒè¿›åˆ¶å°±æ˜¯ 1+n ä¸ª 0ï¼Œå‡ 1 ä¹‹åå°±æ˜¯ 0+nä¸ª1ï¼Œå¦‚16 -&gt; 10000ï¼Œ15 -&gt; 01111</p> <p>é‚£ä¹ˆæ ¹æ® &amp; ä½è¿ç®—çš„è§„åˆ™ï¼Œéƒ½ä¸º 1 (çœŸ)æ—¶ï¼Œæ‰ä¸º 1ï¼Œé‚£ 0â‰¤è¿ç®—åçš„ç»“æœâ‰¤15ï¼Œå‡è®¾ h &lt;= 15ï¼Œé‚£ä¹ˆè¿ç®—åçš„ç»“æœå°±æ˜¯ h æœ¬èº«ï¼Œh &gt;15ï¼Œè¿ç®—åçš„ç»“æœå°±æ˜¯æœ€åå››ä½äºŒè¿›åˆ¶åš &amp; è¿ç®—åçš„å€¼ï¼Œæœ€ç»ˆï¼Œå°±æ˜¯ % è¿ç®—åçš„ä½™æ•°ã€‚</p> <p>å½“å®¹é‡ä¸€å®šæ˜¯ 2<sup>n</sup> æ—¶ï¼Œh &amp; (length - 1) == h % length</p> <h2 id="æ›´æ–°æ—¥å¿—"><a href="#æ›´æ–°æ—¥å¿—" aria-hidden="true" class="header-anchor">#</a> æ›´æ–°æ—¥å¿—</h2> <ul><li>2018/8/3 v2.5 åŸºç¡€ç‰ˆ</li> <li>2018/9/1 v3.0 åˆç¨¿ç‰ˆ</li></ul></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/frank-lam/fullstack-tutorial/edit/master/docs/notes/JavaArchitecture/02 Java é›†åˆæ¡†æ¶.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">12/21/2018, 2:15:56 AM</span></div></div> <!----> </div> <!----></div></div>
    <script src="/fullstack-tutorial-site/assets/js/app.e23029aa.js" defer></script><script src="/fullstack-tutorial-site/assets/js/1.82e55b14.js" defer></script>
  </body>
</html>
